{"version":3,"sources":["../node_modules/@toruslabs/solana-embed/node_modules/readable-stream/errors-browser.js","../node_modules/@toruslabs/solana-embed/node_modules/readable-stream/lib/_stream_duplex.js","../node_modules/fast-deep-equal/index.js","../node_modules/is-stream/index.js","../node_modules/@toruslabs/solana-embed/node_modules/readable-stream/lib/internal/streams/end-of-stream.js","../../src/baseSolanaAdapter.ts","../node_modules/@web3auth/base-solana-adapter/node_modules/bs58/index.js","../node_modules/@web3auth/base-solana-adapter/node_modules/base-x/src/index.js","../node_modules/@toruslabs/solana-embed/node_modules/readable-stream/lib/_stream_readable.js","../node_modules/@toruslabs/solana-embed/node_modules/readable-stream/lib/internal/streams/stream-browser.js","../node_modules/@toruslabs/solana-embed/node_modules/readable-stream/lib/internal/streams/destroy.js","../node_modules/@toruslabs/solana-embed/node_modules/readable-stream/lib/internal/streams/state.js","../node_modules/@toruslabs/solana-embed/node_modules/readable-stream/lib/_stream_writable.js","../node_modules/@toruslabs/solana-embed/node_modules/readable-stream/lib/_stream_transform.js","../../../src/messages.ts","../../../src/interfaces.ts","../../../src/config.ts","../../../src/loglevel.ts","../../../src/utils.ts","../../../src/baseProvider.ts","../../../src/embedUtils.ts","../../../src/PopupHandler.ts","../../../src/communicationProvider.ts","../../../src/inPageProvider.ts","../../../src/siteMetadata.ts","../../../src/embed.ts","../../src/basePostMessageStream.ts","../../src/safeEventEmitter.ts","../../src/serializableError.ts","../../src/jrpc.ts","../../src/jrpcEngine.ts","../../src/substream.ts","../../src/mux.ts","../node_modules/@toruslabs/solana-embed/node_modules/readable-stream/readable-browser.js","../node_modules/@toruslabs/solana-embed/node_modules/readable-stream/lib/internal/streams/buffer_list.js","../node_modules/@toruslabs/solana-embed/node_modules/readable-stream/lib/internal/streams/async_iterator.js","../node_modules/@toruslabs/solana-embed/node_modules/readable-stream/lib/internal/streams/from-browser.js","../node_modules/@toruslabs/solana-embed/node_modules/readable-stream/lib/_stream_passthrough.js","../node_modules/@toruslabs/solana-embed/node_modules/readable-stream/lib/internal/streams/pipeline.js","../../src/randomId.ts","../../src/url.ts","../../src/utils.ts","../../src/solanaWalletAdapter.ts"],"names":["codes","createErrorType","code","message","Base","Error","NodeError","_Base","subClass","superClass","arg1","arg2","arg3","call","this","getMessage","prototype","Object","create","constructor","__proto__","name","oneOf","expected","thing","Array","isArray","len","length","map","i","String","concat","slice","join","value","TypeError","actual","determiner","search","pos","msg","substr","replace","str","this_len","undefined","substring","endsWith","type","start","indexOf","includes","arg","module","exports","objectKeys","keys","obj","key","push","Duplex","Readable","require","Writable","v","method","options","allowHalfOpen","readable","writable","once","onend","_writableState","ended","process","nextTick","onEndNT","self","end","defineProperty","enumerable","get","highWaterMark","getBuffer","_readableState","destroyed","set","equal","a","b","RegExp","source","flags","valueOf","toString","hasOwnProperty","isStream","stream","pipe","_write","_read","duplex","transform","_transform","ERR_STREAM_PREMATURE_CLOSE","noop","eos","opts","callback","called","_len","arguments","args","_key","apply","onlegacyfinish","onfinish","writableEnded","finished","readableEnded","endEmitted","onerror","err","onclose","onrequest","req","on","setHeader","abort","isRequest","error","removeListener","BaseSolanaAdapter","params","clientId","provider","chainConfig","chainId","WalletLoginError","notConnectedError","chainNamespace","status","ADAPTER_STATUS","CONNECTED","request","accounts","existingToken","getSavedToken","checkIfTokenIsExpired","idToken","payload","domain","window","location","origin","uri","href","address","parseInt","version","nonce","Math","random","issuedAt","Date","toISOString","signChallenge","challenge","encodedMessage","TextEncoder","encode","display","signedMessage","verifySignedChallenge","bs58","sessionTime","saveToken","disconnectionError","clearToken","BaseAdapter","basex","ALPHABET","BASE_MAP","Uint8Array","j","x","charAt","xc","charCodeAt","BASE","LEADER","FACTOR","log","iFACTOR","decodeUnsafe","psz","zeroes","size","b256","carry","it3","it4","vch","ArrayBuffer","isView","buffer","byteOffset","byteLength","from","pbegin","pend","b58","it1","it2","repeat","decode","string","ReadableState","EventEmitter","EElistenerCount","emitter","listeners","Stream","Buffer","OurUint8Array","global","debug","debugUtil","debuglog","StringDecoder","createReadableStreamAsyncIterator","BufferList","destroyImpl","getHighWaterMark","_require$codes","ERR_INVALID_ARG_TYPE","ERR_STREAM_PUSH_AFTER_EOF","ERR_METHOD_NOT_IMPLEMENTED","ERR_STREAM_UNSHIFT_AFTER_END_EVENT","errorOrDestroy","kProxyEvents","isDuplex","objectMode","readableObjectMode","pipes","pipesCount","flowing","reading","sync","needReadable","emittedReadable","readableListening","resumeScheduled","paused","emitClose","autoDestroy","defaultEncoding","awaitDrain","readingMore","decoder","encoding","read","destroy","_destroy","readableAddChunk","chunk","addToFront","skipChunkCheck","er","state","emitReadable","emitReadable_","onEofChunk","isBuffer","chunkInvalid","getPrototypeOf","_uint8ArrayToBuffer","addChunk","write","maybeReadMore","emit","unshift","_undestroy","undestroy","cb","isPaused","setEncoding","enc","p","head","content","data","next","clear","MAX_HWM","howMuchToRead","n","computeNewHighWaterMark","flow","maybeReadMore_","updateReadableListening","listenerCount","resume","nReadingNextTick","resume_","fromList","ret","shift","first","consume","endReadable","endReadableNT","wState","xs","l","nOrig","doRead","dest","pipeOpts","src","endFn","stdout","stderr","unpipe","onunpipe","unpipeInfo","hasUnpiped","ondrain","ondata","cleanedUp","needDrain","pipeOnDrain","pause","event","fn","prependListener","_events","dests","index","splice","ev","res","addListener","removeAllListeners","wrap","_this","bind","Symbol","asyncIterator","_fromList","iterable","emitErrorAndCloseNT","emitErrorNT","emitCloseNT","readableDestroyed","writableDestroyed","errorEmitted","ending","finalCalled","prefinished","rState","ERR_INVALID_OPT_VALUE","duplexKey","hwm","highWaterMarkFrom","isFinite","floor","CorkedRequest","entry","finish","corkReq","pendingcb","corkedRequestsFree","onCorkedFinish","WritableState","internalUtil","deprecate","realHasInstance","ERR_MULTIPLE_CALLBACK","ERR_STREAM_CANNOT_PIPE","ERR_STREAM_DESTROYED","ERR_STREAM_NULL_VALUES","ERR_STREAM_WRITE_AFTER_END","ERR_UNKNOWN_ENCODING","nop","writableObjectMode","noDecode","decodeStrings","writing","corked","bufferProcessing","onwrite","writecb","writelen","onwriteStateUpdate","finishMaybe","onwriteError","needFinish","bufferedRequest","clearBuffer","afterWrite","lastBufferedRequest","bufferedRequestCount","writev","_writev","final","_final","doWrite","onwriteDrain","holder","count","allBuffers","isBuf","callFinal","need","prefinish","current","out","_","hasInstance","Function","object","writeAfterEnd","validChunk","newChunk","decodeChunk","last","writeOrBuffer","cork","uncork","setDefaultEncoding","toLowerCase","endWritable","Transform","ERR_TRANSFORM_ALREADY_TRANSFORMING","ERR_TRANSFORM_WITH_LENGTH_0","afterTransform","ts","_transformState","transforming","writechunk","rs","needTransform","writeencoding","flush","_flush","done","err2","disconnected","permanentlyDisconnected","unsupportedSync","invalidDuplexStream","invalidOptions","maxEventListeners","invalidRequestArgs","invalidRequestMethod","invalidRequestParams","invalidLoggerObject","invalidLoggerMethod","connected","TORUS_BUILD_ENV","BUTTON_POSITION","supportedVerifierList","api","translations","en","embed","continue","actionRequired","pendingAction","cookiesRequired","enableCookies","clickHere","de","ja","ko","zh","prodTorusUrl","localStorageKeyPrefix","loglevel","getLogger","getWindowId","getTorusUrl","buildEnv","torusUrl","logLevel","FEATURES_PROVIDER_CHANGE_WINDOW","height","width","FEATURES_DEFAULT_WALLET_WINDOW","FEATURES_DEFAULT_POPUP_WINDOW","FEATURES_CONFIRM_WINDOW","getPopupFeatures","w","h","dualScreenLeft","screenLeft","screenX","dualScreenTop","screenTop","screenY","innerWidth","document","documentElement","clientWidth","screen","innerHeight","clientHeight","left","abs","top","BaseProvider","jsonRpcStreamName","_defineProperty","isDuplexStream","connectionStream","messages","isTorus","setMaxListeners","_handleConnect","_handleDisconnect","_handleStreamDisconnect","_rpcRequest","_initializeState","sendAsync","mux","ObjectMultiplex","pump","ignoreStream","jsonRpcConnection","createStreamMiddleware","createStream","rpcEngine","JRPCEngine","createIdRemapMiddleware","ethErrors","rpc","invalidRequest","createLoggerMiddleware","middleware","_rpcEngine","jsonRpcConnectionEvents","events","Promise","resolve","reject","getRpcPromiseCallback","send","streamName","remoteLabel","warningMsg","stack","warn","logStreamDisconnectWarning","SafeEventEmitter","handleEvent","handle","eventName","handler","handlerArgs","addEventListener","handlerWrapper","removeEventListener","documentReady","readyState","htmlToElement","html","template","createElement","trimmedHtml","trim","innerHTML","firstChild","isLegacyTransactionInstance","transaction","PopupHandler","url","target","features","windowTimer","iClosedWindow","_setupTimer","Number","setInterval","closed","clearInterval","open","focus","close","redirect","locationReplaceOnRedirect","TorusCommunicationProvider","_state","_defaultState","dappStorageKey","languageTranslations","configuration","getUserLanguage","userLanguage","navigator","language","userLanguages","split","config","embedTranslations","windowRefs","isConnected","COMMUNICATION_NOTIFICATIONS","IFRAME_STATUS","isFullScreen","rid","_displayIframe","isFull","CREATE_WINDOW","windowId","_createPopupBlockAlert","CLOSE_WINDOW","_handleCloseWindow","USER_LOGGED_IN","currentLoginProvider","isLoggedIn","USER_LOGGED_OUT","isIFrameFullScreen","torusAlertContainer","torusIframe","COMMUNICATION_JRPC_METHODS","GET_PROVIDER_STATE","info","initialized","_handleWindow","finalUrl","URL","hash","handledWindow","OPENED_WINDOW","CLOSED_WINDOW","style","right","bottom","torusWidgetVisibility","buttonPosition","assign","hideTorusButton","showTorusButton","_payload","jsonrpc","tryWindowHandle","isRecoverable","errorMessage","isPermanentlyDisconnected","EthereumRpcError","logoUrl","getLogoUrl","torusAlert","successAlert","btnContainer","appendChild","bindOnLoad","remove","children","attachOnLoad","hasEmittedConnection","TorusInPageProvider","selectedAddress","_handleAccountsChanged","_handleChainChanged","_handleUnlockStateChanged","PROVIDER_NOTIFICATIONS","ACCOUNTS_CHANGED","UNLOCK_STATE_CHANGED","CHAIN_CHANGED","PROVIDER_JRPC_METHODS","isUnlocked","isInternal","result","isEthAccounts","finalAccounts","dequal","imgExists","img","onload","e","getSiteName","siteName","querySelector","metaTitle","title","hostname","getSiteIcon","icon","querySelectorAll","find","_icon","Boolean","getSiteMetadata","PROVIDER_UNSAFE_METHODS","COMMUNICATION_UNSAFE_METHODS","SET_PROVIDER","isLocalStorageAvailable","storage","setItem","removeItem","storageAvailable","torusIframeHtml","crossOrigin","rel","relList","supports","preLoadIframe","Torus","modalZIndex","isInitialized","requestedLoginProvider","alertZIndex","communicationProvider","whiteLabel","enableLogging","network","useLocalStorage","apiKey","extraParams","setAPIKey","enableAll","setDefaultLevel","disableAll","handleDappStorageKey","torusIframeUrl","pathname","hashParams","URLSearchParams","append","styleLink","handleSetup","body","dappMetadata","contentWindow","postMessage","_setupWeb3","topupHide","isTopupHidden","torus","loginProvider","login_hint","loginParams","userInfo","privateKey","success","LOGOUT","logout","clearInit","isElement","element","Element","Document","contains","path","WALLET_INSTANCE_ID","instanceId","finalPath","searchParams","forEach","USER_INFO","userInfoResponse","TOPUP","topupResponse","response","isLegacyTransaction","serialize","requireAllSignatures","signature","serializeMessage","messageOnly","parsed","JSON","parse","publicKey","PublicKey","addSignature","transactions","tx","responses","signatures","item","idx","localStorageKey","storedKey","localStorage","getItem","generatedKey","providerParams","providerStream","BasePostMessageStream","targetWindow","communicationStream","inPageProvider","detectAccountRequestPrototypeModifier","m","originalMethod","login","then","catch","proxiedInPageProvider","Proxy","deleteProperty","proxiedCommunicationProvider","all","ACK","targetOrigin","_init","_haveSyn","_name","_target","_targetWindow","_targetOrigin","_onMessage","onMessage","_synIntervalId","_handShake","_break","_onData","_postMessage","originConstraint","safeApply","context","Reflect","setTimeout","doError","arr","copy","arrayClone","isInteger","stringify","unwrapResult","idMap","_encoding","id","processNotification","processResponse","_err","_end","originalId","newId","randomId","_middleware","_handleBatch","_handle","_promiseHandle","asMiddleware","_runAllMiddleware","middlewareError","isComplete","returnHandlers","_runReturnHandlers","handlerCallback","reqs","callerReq","SerializableError","_processRequest","serializeError","_checkForCompletion","middlewareStack","_runMiddleware","reverse","returnHandler","handlers","parent","_parent","IGNORE_SUBSTREAM","_substreams","substream","Substream","_cb","anyStreamEnd","_error","console","PassThrough","pipeline","ownKeys","enumerableOnly","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","_objectSpread","getOwnPropertyDescriptors","defineProperties","_toPropertyKey","configurable","_defineProperties","props","descriptor","input","hint","prim","toPrimitive","_toPrimitive","inspect","custom","instance","Constructor","_classCallCheck","tail","protoProps","staticProps","s","alloc","offset","allocUnsafe","hasStrings","_getString","_getBuffer","c","nb","buf","depth","customInspect","_Object$setPrototypeO","kLastResolve","kLastReject","kError","kEnded","kLastPromise","kHandlePromise","kStream","createIterResult","readAndResolve","iter","onReadable","AsyncIteratorPrototype","ReadableStreamAsyncIteratorPrototype","setPrototypeOf","promise","lastPromise","wrapForNext","_this2","_Object$create","iterator","ERR_MISSING_ARGS","to","streams","pop","popCallback","destroys","destroyer","reduce","randombytes","base64urlLib","keccakLib","SolanaWalletAdapter","WALLET_ADAPTERS","TORUS_SOLANA","ADAPTER_NAMESPACES","SOLANA","CHAIN_NAMESPACES","ADAPTER_CATEGORY","EXTERNAL","NOT_READY","torusWalletOptions","adapterSettings","initParams","loginSettings","solanaProvider","blockExplorer","displayName","rpcTarget","ticker","tickerName","blockExplorerUrl","logo","getChainConfig","torusInstance","init","TorusInjectedProvider","READY","ADAPTER_EVENTS","autoConnect","rehydrated","connect","ERRORED","WalletInitializationError","notReady","CONNECTING","adapter","torusInpageProvider","sendTransaction","signAllTransactions","signMessage","signTransaction","setupProvider","Web3AuthError","setProvider","reconnected","connectionError","cleanup","DISCONNECTED","getUserInfo"],"mappings":"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","file":"static/js/8.bc72ac54.chunk.js","sourcesContent":["'use strict';\n\nfunction _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }\n\nvar codes = {};\n\nfunction createErrorType(code, message, Base) {\n  if (!Base) {\n    Base = Error;\n  }\n\n  function getMessage(arg1, arg2, arg3) {\n    if (typeof message === 'string') {\n      return message;\n    } else {\n      return message(arg1, arg2, arg3);\n    }\n  }\n\n  var NodeError =\n  /*#__PURE__*/\n  function (_Base) {\n    _inheritsLoose(NodeError, _Base);\n\n    function NodeError(arg1, arg2, arg3) {\n      return _Base.call(this, getMessage(arg1, arg2, arg3)) || this;\n    }\n\n    return NodeError;\n  }(Base);\n\n  NodeError.prototype.name = Base.name;\n  NodeError.prototype.code = code;\n  codes[code] = NodeError;\n} // https://github.com/nodejs/node/blob/v10.8.0/lib/internal/errors.js\n\n\nfunction oneOf(expected, thing) {\n  if (Array.isArray(expected)) {\n    var len = expected.length;\n    expected = expected.map(function (i) {\n      return String(i);\n    });\n\n    if (len > 2) {\n      return \"one of \".concat(thing, \" \").concat(expected.slice(0, len - 1).join(', '), \", or \") + expected[len - 1];\n    } else if (len === 2) {\n      return \"one of \".concat(thing, \" \").concat(expected[0], \" or \").concat(expected[1]);\n    } else {\n      return \"of \".concat(thing, \" \").concat(expected[0]);\n    }\n  } else {\n    return \"of \".concat(thing, \" \").concat(String(expected));\n  }\n} // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/startsWith\n\n\nfunction startsWith(str, search, pos) {\n  return str.substr(!pos || pos < 0 ? 0 : +pos, search.length) === search;\n} // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/endsWith\n\n\nfunction endsWith(str, search, this_len) {\n  if (this_len === undefined || this_len > str.length) {\n    this_len = str.length;\n  }\n\n  return str.substring(this_len - search.length, this_len) === search;\n} // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/includes\n\n\nfunction includes(str, search, start) {\n  if (typeof start !== 'number') {\n    start = 0;\n  }\n\n  if (start + search.length > str.length) {\n    return false;\n  } else {\n    return str.indexOf(search, start) !== -1;\n  }\n}\n\ncreateErrorType('ERR_INVALID_OPT_VALUE', function (name, value) {\n  return 'The value \"' + value + '\" is invalid for option \"' + name + '\"';\n}, TypeError);\ncreateErrorType('ERR_INVALID_ARG_TYPE', function (name, expected, actual) {\n  // determiner: 'must be' or 'must not be'\n  var determiner;\n\n  if (typeof expected === 'string' && startsWith(expected, 'not ')) {\n    determiner = 'must not be';\n    expected = expected.replace(/^not /, '');\n  } else {\n    determiner = 'must be';\n  }\n\n  var msg;\n\n  if (endsWith(name, ' argument')) {\n    // For cases like 'first argument'\n    msg = \"The \".concat(name, \" \").concat(determiner, \" \").concat(oneOf(expected, 'type'));\n  } else {\n    var type = includes(name, '.') ? 'property' : 'argument';\n    msg = \"The \\\"\".concat(name, \"\\\" \").concat(type, \" \").concat(determiner, \" \").concat(oneOf(expected, 'type'));\n  }\n\n  msg += \". Received type \".concat(typeof actual);\n  return msg;\n}, TypeError);\ncreateErrorType('ERR_STREAM_PUSH_AFTER_EOF', 'stream.push() after EOF');\ncreateErrorType('ERR_METHOD_NOT_IMPLEMENTED', function (name) {\n  return 'The ' + name + ' method is not implemented';\n});\ncreateErrorType('ERR_STREAM_PREMATURE_CLOSE', 'Premature close');\ncreateErrorType('ERR_STREAM_DESTROYED', function (name) {\n  return 'Cannot call ' + name + ' after a stream was destroyed';\n});\ncreateErrorType('ERR_MULTIPLE_CALLBACK', 'Callback called multiple times');\ncreateErrorType('ERR_STREAM_CANNOT_PIPE', 'Cannot pipe, not readable');\ncreateErrorType('ERR_STREAM_WRITE_AFTER_END', 'write after end');\ncreateErrorType('ERR_STREAM_NULL_VALUES', 'May not write null values to stream', TypeError);\ncreateErrorType('ERR_UNKNOWN_ENCODING', function (arg) {\n  return 'Unknown encoding: ' + arg;\n}, TypeError);\ncreateErrorType('ERR_STREAM_UNSHIFT_AFTER_END_EVENT', 'stream.unshift() after end event');\nmodule.exports.codes = codes;\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n// a duplex stream is just a stream that is both readable and writable.\n// Since JS doesn't have multiple prototypal inheritance, this class\n// prototypally inherits from Readable, and then parasitically from\n// Writable.\n\n'use strict';\n\n/*<replacement>*/\nvar objectKeys = Object.keys || function (obj) {\n  var keys = [];\n  for (var key in obj) keys.push(key);\n  return keys;\n};\n/*</replacement>*/\n\nmodule.exports = Duplex;\nvar Readable = require('./_stream_readable');\nvar Writable = require('./_stream_writable');\nrequire('inherits')(Duplex, Readable);\n{\n  // Allow the keys array to be GC'ed.\n  var keys = objectKeys(Writable.prototype);\n  for (var v = 0; v < keys.length; v++) {\n    var method = keys[v];\n    if (!Duplex.prototype[method]) Duplex.prototype[method] = Writable.prototype[method];\n  }\n}\nfunction Duplex(options) {\n  if (!(this instanceof Duplex)) return new Duplex(options);\n  Readable.call(this, options);\n  Writable.call(this, options);\n  this.allowHalfOpen = true;\n  if (options) {\n    if (options.readable === false) this.readable = false;\n    if (options.writable === false) this.writable = false;\n    if (options.allowHalfOpen === false) {\n      this.allowHalfOpen = false;\n      this.once('end', onend);\n    }\n  }\n}\nObject.defineProperty(Duplex.prototype, 'writableHighWaterMark', {\n  // making it explicit this property is not enumerable\n  // because otherwise some prototype manipulation in\n  // userland will fail\n  enumerable: false,\n  get: function get() {\n    return this._writableState.highWaterMark;\n  }\n});\nObject.defineProperty(Duplex.prototype, 'writableBuffer', {\n  // making it explicit this property is not enumerable\n  // because otherwise some prototype manipulation in\n  // userland will fail\n  enumerable: false,\n  get: function get() {\n    return this._writableState && this._writableState.getBuffer();\n  }\n});\nObject.defineProperty(Duplex.prototype, 'writableLength', {\n  // making it explicit this property is not enumerable\n  // because otherwise some prototype manipulation in\n  // userland will fail\n  enumerable: false,\n  get: function get() {\n    return this._writableState.length;\n  }\n});\n\n// the no-half-open enforcer\nfunction onend() {\n  // If the writable side ended, then we're ok.\n  if (this._writableState.ended) return;\n\n  // no more data can be written.\n  // But allow more writes to happen in this tick.\n  process.nextTick(onEndNT, this);\n}\nfunction onEndNT(self) {\n  self.end();\n}\nObject.defineProperty(Duplex.prototype, 'destroyed', {\n  // making it explicit this property is not enumerable\n  // because otherwise some prototype manipulation in\n  // userland will fail\n  enumerable: false,\n  get: function get() {\n    if (this._readableState === undefined || this._writableState === undefined) {\n      return false;\n    }\n    return this._readableState.destroyed && this._writableState.destroyed;\n  },\n  set: function set(value) {\n    // we ignore the value if the stream\n    // has not been initialized yet\n    if (this._readableState === undefined || this._writableState === undefined) {\n      return;\n    }\n\n    // backward compatibility, the user is explicitly\n    // managing destroyed\n    this._readableState.destroyed = value;\n    this._writableState.destroyed = value;\n  }\n});","'use strict';\n\n// do not edit .js files directly - edit src/index.jst\n\n\n\nmodule.exports = function equal(a, b) {\n  if (a === b) return true;\n\n  if (a && b && typeof a == 'object' && typeof b == 'object') {\n    if (a.constructor !== b.constructor) return false;\n\n    var length, i, keys;\n    if (Array.isArray(a)) {\n      length = a.length;\n      if (length != b.length) return false;\n      for (i = length; i-- !== 0;)\n        if (!equal(a[i], b[i])) return false;\n      return true;\n    }\n\n\n\n    if (a.constructor === RegExp) return a.source === b.source && a.flags === b.flags;\n    if (a.valueOf !== Object.prototype.valueOf) return a.valueOf() === b.valueOf();\n    if (a.toString !== Object.prototype.toString) return a.toString() === b.toString();\n\n    keys = Object.keys(a);\n    length = keys.length;\n    if (length !== Object.keys(b).length) return false;\n\n    for (i = length; i-- !== 0;)\n      if (!Object.prototype.hasOwnProperty.call(b, keys[i])) return false;\n\n    for (i = length; i-- !== 0;) {\n      var key = keys[i];\n\n      if (!equal(a[key], b[key])) return false;\n    }\n\n    return true;\n  }\n\n  // true if both NaN, false otherwise\n  return a!==a && b!==b;\n};\n","'use strict';\n\nconst isStream = stream =>\n\tstream !== null &&\n\ttypeof stream === 'object' &&\n\ttypeof stream.pipe === 'function';\n\nisStream.writable = stream =>\n\tisStream(stream) &&\n\tstream.writable !== false &&\n\ttypeof stream._write === 'function' &&\n\ttypeof stream._writableState === 'object';\n\nisStream.readable = stream =>\n\tisStream(stream) &&\n\tstream.readable !== false &&\n\ttypeof stream._read === 'function' &&\n\ttypeof stream._readableState === 'object';\n\nisStream.duplex = stream =>\n\tisStream.writable(stream) &&\n\tisStream.readable(stream);\n\nisStream.transform = stream =>\n\tisStream.duplex(stream) &&\n\ttypeof stream._transform === 'function';\n\nmodule.exports = isStream;\n","// Ported from https://github.com/mafintosh/end-of-stream with\n// permission from the author, Mathias Buus (@mafintosh).\n\n'use strict';\n\nvar ERR_STREAM_PREMATURE_CLOSE = require('../../../errors').codes.ERR_STREAM_PREMATURE_CLOSE;\nfunction once(callback) {\n  var called = false;\n  return function () {\n    if (called) return;\n    called = true;\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n    callback.apply(this, args);\n  };\n}\nfunction noop() {}\nfunction isRequest(stream) {\n  return stream.setHeader && typeof stream.abort === 'function';\n}\nfunction eos(stream, opts, callback) {\n  if (typeof opts === 'function') return eos(stream, null, opts);\n  if (!opts) opts = {};\n  callback = once(callback || noop);\n  var readable = opts.readable || opts.readable !== false && stream.readable;\n  var writable = opts.writable || opts.writable !== false && stream.writable;\n  var onlegacyfinish = function onlegacyfinish() {\n    if (!stream.writable) onfinish();\n  };\n  var writableEnded = stream._writableState && stream._writableState.finished;\n  var onfinish = function onfinish() {\n    writable = false;\n    writableEnded = true;\n    if (!readable) callback.call(stream);\n  };\n  var readableEnded = stream._readableState && stream._readableState.endEmitted;\n  var onend = function onend() {\n    readable = false;\n    readableEnded = true;\n    if (!writable) callback.call(stream);\n  };\n  var onerror = function onerror(err) {\n    callback.call(stream, err);\n  };\n  var onclose = function onclose() {\n    var err;\n    if (readable && !readableEnded) {\n      if (!stream._readableState || !stream._readableState.ended) err = new ERR_STREAM_PREMATURE_CLOSE();\n      return callback.call(stream, err);\n    }\n    if (writable && !writableEnded) {\n      if (!stream._writableState || !stream._writableState.ended) err = new ERR_STREAM_PREMATURE_CLOSE();\n      return callback.call(stream, err);\n    }\n  };\n  var onrequest = function onrequest() {\n    stream.req.on('finish', onfinish);\n  };\n  if (isRequest(stream)) {\n    stream.on('complete', onfinish);\n    stream.on('abort', onclose);\n    if (stream.req) onrequest();else stream.on('request', onrequest);\n  } else if (writable && !stream._writableState) {\n    // legacy streams\n    stream.on('end', onlegacyfinish);\n    stream.on('close', onlegacyfinish);\n  }\n  stream.on('end', onend);\n  stream.on('finish', onfinish);\n  if (opts.error !== false) stream.on('error', onerror);\n  stream.on('close', onclose);\n  return function () {\n    stream.removeListener('complete', onfinish);\n    stream.removeListener('abort', onclose);\n    stream.removeListener('request', onrequest);\n    if (stream.req) stream.req.removeListener('finish', onfinish);\n    stream.removeListener('end', onlegacyfinish);\n    stream.removeListener('close', onlegacyfinish);\n    stream.removeListener('finish', onfinish);\n    stream.removeListener('end', onend);\n    stream.removeListener('error', onerror);\n    stream.removeListener('close', onclose);\n  };\n}\nmodule.exports = eos;","import _asyncToGenerator from '@babel/runtime/helpers/asyncToGenerator';\nimport _classCallCheck from '@babel/runtime/helpers/classCallCheck';\nimport _createClass from '@babel/runtime/helpers/createClass';\nimport _assertThisInitialized from '@babel/runtime/helpers/assertThisInitialized';\nimport _inherits from '@babel/runtime/helpers/inherits';\nimport _possibleConstructorReturn from '@babel/runtime/helpers/possibleConstructorReturn';\nimport _getPrototypeOf from '@babel/runtime/helpers/getPrototypeOf';\nimport _defineProperty from '@babel/runtime/helpers/defineProperty';\nimport _regeneratorRuntime from '@babel/runtime/regenerator';\nimport { WalletLoginError, saveToken, verifySignedChallenge, signChallenge, getSavedToken, checkIfTokenIsExpired, ADAPTER_STATUS, clearToken, BaseAdapter } from '@web3auth/base';\nimport bs58 from 'bs58';\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\nvar BaseSolanaAdapter = /*#__PURE__*/function (_BaseAdapter) {\n  _inherits(BaseSolanaAdapter, _BaseAdapter);\n\n  var _super = _createSuper(BaseSolanaAdapter);\n\n  function BaseSolanaAdapter() {\n    var _this;\n\n    var params = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n    _classCallCheck(this, BaseSolanaAdapter);\n\n    _this = _super.call(this);\n\n    _defineProperty(_assertThisInitialized(_this), \"clientId\", void 0);\n\n    _this.clientId = params.clientId;\n    return _this;\n  }\n\n  _createClass(BaseSolanaAdapter, [{\n    key: \"authenticateUser\",\n    value: function () {\n      var _authenticateUser = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        var _this$chainConfig;\n\n        var _this$chainConfig2, chainNamespace, chainId, accounts, existingToken, isExpired, payload, challenge, encodedMessage, signedMessage, idToken;\n\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                if (!(!this.provider || !((_this$chainConfig = this.chainConfig) !== null && _this$chainConfig !== void 0 && _this$chainConfig.chainId))) {\n                  _context.next = 2;\n                  break;\n                }\n\n                throw WalletLoginError.notConnectedError();\n\n              case 2:\n                _this$chainConfig2 = this.chainConfig, chainNamespace = _this$chainConfig2.chainNamespace, chainId = _this$chainConfig2.chainId;\n\n                if (!(this.status !== ADAPTER_STATUS.CONNECTED)) {\n                  _context.next = 5;\n                  break;\n                }\n\n                throw WalletLoginError.notConnectedError(\"Not connected with wallet, Please login/connect first\");\n\n              case 5:\n                _context.next = 7;\n                return this.provider.request({\n                  method: \"getAccounts\"\n                });\n\n              case 7:\n                accounts = _context.sent;\n\n                if (!(accounts && accounts.length > 0)) {\n                  _context.next = 27;\n                  break;\n                }\n\n                existingToken = getSavedToken(accounts[0], this.name);\n\n                if (!existingToken) {\n                  _context.next = 14;\n                  break;\n                }\n\n                isExpired = checkIfTokenIsExpired(existingToken);\n\n                if (isExpired) {\n                  _context.next = 14;\n                  break;\n                }\n\n                return _context.abrupt(\"return\", {\n                  idToken: existingToken\n                });\n\n              case 14:\n                payload = {\n                  domain: window.location.origin,\n                  uri: window.location.href,\n                  address: accounts[0],\n                  chainId: parseInt(chainId, 16),\n                  version: \"1\",\n                  nonce: Math.random().toString(36).slice(2),\n                  issuedAt: new Date().toISOString()\n                };\n                _context.next = 17;\n                return signChallenge(payload, chainNamespace);\n\n              case 17:\n                challenge = _context.sent;\n                encodedMessage = new TextEncoder().encode(challenge);\n                _context.next = 21;\n                return this.provider.request({\n                  method: \"signMessage\",\n                  params: {\n                    message: encodedMessage,\n                    display: \"utf8\"\n                  }\n                });\n\n              case 21:\n                signedMessage = _context.sent;\n                _context.next = 24;\n                return verifySignedChallenge(chainNamespace, bs58.encode(signedMessage), challenge, this.name, this.sessionTime, this.clientId);\n\n              case 24:\n                idToken = _context.sent;\n                saveToken(accounts[0], this.name, idToken);\n                return _context.abrupt(\"return\", {\n                  idToken: idToken\n                });\n\n              case 27:\n                throw WalletLoginError.notConnectedError(\"Not connected with wallet, Please login/connect first\");\n\n              case 28:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function authenticateUser() {\n        return _authenticateUser.apply(this, arguments);\n      }\n\n      return authenticateUser;\n    }()\n  }, {\n    key: \"disconnect\",\n    value: function () {\n      var _disconnect = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n        var accounts;\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                if (!(this.status !== ADAPTER_STATUS.CONNECTED)) {\n                  _context2.next = 2;\n                  break;\n                }\n\n                throw WalletLoginError.disconnectionError(\"Not connected with wallet\");\n\n              case 2:\n                _context2.next = 4;\n                return this.provider.request({\n                  method: \"getAccounts\"\n                });\n\n              case 4:\n                accounts = _context2.sent;\n\n                if (accounts && accounts.length > 0) {\n                  clearToken(accounts[0], this.name);\n                }\n\n              case 6:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function disconnect() {\n        return _disconnect.apply(this, arguments);\n      }\n\n      return disconnect;\n    }()\n  }]);\n\n  return BaseSolanaAdapter;\n}(BaseAdapter);\n\nexport { BaseSolanaAdapter };\n//# sourceMappingURL=baseSolanaAdapter.esm.js.map\n","const basex = require('base-x')\nconst ALPHABET = '123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz'\n\nmodule.exports = basex(ALPHABET)\n","'use strict'\n// base-x encoding / decoding\n// Copyright (c) 2018 base-x contributors\n// Copyright (c) 2014-2018 The Bitcoin Core developers (base58.cpp)\n// Distributed under the MIT software license, see the accompanying\n// file LICENSE or http://www.opensource.org/licenses/mit-license.php.\nfunction base (ALPHABET) {\n  if (ALPHABET.length >= 255) { throw new TypeError('Alphabet too long') }\n  var BASE_MAP = new Uint8Array(256)\n  for (var j = 0; j < BASE_MAP.length; j++) {\n    BASE_MAP[j] = 255\n  }\n  for (var i = 0; i < ALPHABET.length; i++) {\n    var x = ALPHABET.charAt(i)\n    var xc = x.charCodeAt(0)\n    if (BASE_MAP[xc] !== 255) { throw new TypeError(x + ' is ambiguous') }\n    BASE_MAP[xc] = i\n  }\n  var BASE = ALPHABET.length\n  var LEADER = ALPHABET.charAt(0)\n  var FACTOR = Math.log(BASE) / Math.log(256) // log(BASE) / log(256), rounded up\n  var iFACTOR = Math.log(256) / Math.log(BASE) // log(256) / log(BASE), rounded up\n  function encode (source) {\n    if (source instanceof Uint8Array) {\n    } else if (ArrayBuffer.isView(source)) {\n      source = new Uint8Array(source.buffer, source.byteOffset, source.byteLength)\n    } else if (Array.isArray(source)) {\n      source = Uint8Array.from(source)\n    }\n    if (!(source instanceof Uint8Array)) { throw new TypeError('Expected Uint8Array') }\n    if (source.length === 0) { return '' }\n        // Skip & count leading zeroes.\n    var zeroes = 0\n    var length = 0\n    var pbegin = 0\n    var pend = source.length\n    while (pbegin !== pend && source[pbegin] === 0) {\n      pbegin++\n      zeroes++\n    }\n        // Allocate enough space in big-endian base58 representation.\n    var size = ((pend - pbegin) * iFACTOR + 1) >>> 0\n    var b58 = new Uint8Array(size)\n        // Process the bytes.\n    while (pbegin !== pend) {\n      var carry = source[pbegin]\n            // Apply \"b58 = b58 * 256 + ch\".\n      var i = 0\n      for (var it1 = size - 1; (carry !== 0 || i < length) && (it1 !== -1); it1--, i++) {\n        carry += (256 * b58[it1]) >>> 0\n        b58[it1] = (carry % BASE) >>> 0\n        carry = (carry / BASE) >>> 0\n      }\n      if (carry !== 0) { throw new Error('Non-zero carry') }\n      length = i\n      pbegin++\n    }\n        // Skip leading zeroes in base58 result.\n    var it2 = size - length\n    while (it2 !== size && b58[it2] === 0) {\n      it2++\n    }\n        // Translate the result into a string.\n    var str = LEADER.repeat(zeroes)\n    for (; it2 < size; ++it2) { str += ALPHABET.charAt(b58[it2]) }\n    return str\n  }\n  function decodeUnsafe (source) {\n    if (typeof source !== 'string') { throw new TypeError('Expected String') }\n    if (source.length === 0) { return new Uint8Array() }\n    var psz = 0\n        // Skip and count leading '1's.\n    var zeroes = 0\n    var length = 0\n    while (source[psz] === LEADER) {\n      zeroes++\n      psz++\n    }\n        // Allocate enough space in big-endian base256 representation.\n    var size = (((source.length - psz) * FACTOR) + 1) >>> 0 // log(58) / log(256), rounded up.\n    var b256 = new Uint8Array(size)\n        // Process the characters.\n    while (source[psz]) {\n            // Decode character\n      var carry = BASE_MAP[source.charCodeAt(psz)]\n            // Invalid character\n      if (carry === 255) { return }\n      var i = 0\n      for (var it3 = size - 1; (carry !== 0 || i < length) && (it3 !== -1); it3--, i++) {\n        carry += (BASE * b256[it3]) >>> 0\n        b256[it3] = (carry % 256) >>> 0\n        carry = (carry / 256) >>> 0\n      }\n      if (carry !== 0) { throw new Error('Non-zero carry') }\n      length = i\n      psz++\n    }\n        // Skip leading zeroes in b256.\n    var it4 = size - length\n    while (it4 !== size && b256[it4] === 0) {\n      it4++\n    }\n    var vch = new Uint8Array(zeroes + (size - it4))\n    var j = zeroes\n    while (it4 !== size) {\n      vch[j++] = b256[it4++]\n    }\n    return vch\n  }\n  function decode (string) {\n    var buffer = decodeUnsafe(string)\n    if (buffer) { return buffer }\n    throw new Error('Non-base' + BASE + ' character')\n  }\n  return {\n    encode: encode,\n    decodeUnsafe: decodeUnsafe,\n    decode: decode\n  }\n}\nmodule.exports = base\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n'use strict';\n\nmodule.exports = Readable;\n\n/*<replacement>*/\nvar Duplex;\n/*</replacement>*/\n\nReadable.ReadableState = ReadableState;\n\n/*<replacement>*/\nvar EE = require('events').EventEmitter;\nvar EElistenerCount = function EElistenerCount(emitter, type) {\n  return emitter.listeners(type).length;\n};\n/*</replacement>*/\n\n/*<replacement>*/\nvar Stream = require('./internal/streams/stream');\n/*</replacement>*/\n\nvar Buffer = require('buffer').Buffer;\nvar OurUint8Array = (typeof global !== 'undefined' ? global : typeof window !== 'undefined' ? window : typeof self !== 'undefined' ? self : {}).Uint8Array || function () {};\nfunction _uint8ArrayToBuffer(chunk) {\n  return Buffer.from(chunk);\n}\nfunction _isUint8Array(obj) {\n  return Buffer.isBuffer(obj) || obj instanceof OurUint8Array;\n}\n\n/*<replacement>*/\nvar debugUtil = require('util');\nvar debug;\nif (debugUtil && debugUtil.debuglog) {\n  debug = debugUtil.debuglog('stream');\n} else {\n  debug = function debug() {};\n}\n/*</replacement>*/\n\nvar BufferList = require('./internal/streams/buffer_list');\nvar destroyImpl = require('./internal/streams/destroy');\nvar _require = require('./internal/streams/state'),\n  getHighWaterMark = _require.getHighWaterMark;\nvar _require$codes = require('../errors').codes,\n  ERR_INVALID_ARG_TYPE = _require$codes.ERR_INVALID_ARG_TYPE,\n  ERR_STREAM_PUSH_AFTER_EOF = _require$codes.ERR_STREAM_PUSH_AFTER_EOF,\n  ERR_METHOD_NOT_IMPLEMENTED = _require$codes.ERR_METHOD_NOT_IMPLEMENTED,\n  ERR_STREAM_UNSHIFT_AFTER_END_EVENT = _require$codes.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;\n\n// Lazy loaded to improve the startup performance.\nvar StringDecoder;\nvar createReadableStreamAsyncIterator;\nvar from;\nrequire('inherits')(Readable, Stream);\nvar errorOrDestroy = destroyImpl.errorOrDestroy;\nvar kProxyEvents = ['error', 'close', 'destroy', 'pause', 'resume'];\nfunction prependListener(emitter, event, fn) {\n  // Sadly this is not cacheable as some libraries bundle their own\n  // event emitter implementation with them.\n  if (typeof emitter.prependListener === 'function') return emitter.prependListener(event, fn);\n\n  // This is a hack to make sure that our error handler is attached before any\n  // userland ones.  NEVER DO THIS. This is here only because this code needs\n  // to continue to work with older versions of Node.js that do not include\n  // the prependListener() method. The goal is to eventually remove this hack.\n  if (!emitter._events || !emitter._events[event]) emitter.on(event, fn);else if (Array.isArray(emitter._events[event])) emitter._events[event].unshift(fn);else emitter._events[event] = [fn, emitter._events[event]];\n}\nfunction ReadableState(options, stream, isDuplex) {\n  Duplex = Duplex || require('./_stream_duplex');\n  options = options || {};\n\n  // Duplex streams are both readable and writable, but share\n  // the same options object.\n  // However, some cases require setting options to different\n  // values for the readable and the writable sides of the duplex stream.\n  // These options can be provided separately as readableXXX and writableXXX.\n  if (typeof isDuplex !== 'boolean') isDuplex = stream instanceof Duplex;\n\n  // object stream flag. Used to make read(n) ignore n and to\n  // make all the buffer merging and length checks go away\n  this.objectMode = !!options.objectMode;\n  if (isDuplex) this.objectMode = this.objectMode || !!options.readableObjectMode;\n\n  // the point at which it stops calling _read() to fill the buffer\n  // Note: 0 is a valid value, means \"don't call _read preemptively ever\"\n  this.highWaterMark = getHighWaterMark(this, options, 'readableHighWaterMark', isDuplex);\n\n  // A linked list is used to store data chunks instead of an array because the\n  // linked list can remove elements from the beginning faster than\n  // array.shift()\n  this.buffer = new BufferList();\n  this.length = 0;\n  this.pipes = null;\n  this.pipesCount = 0;\n  this.flowing = null;\n  this.ended = false;\n  this.endEmitted = false;\n  this.reading = false;\n\n  // a flag to be able to tell if the event 'readable'/'data' is emitted\n  // immediately, or on a later tick.  We set this to true at first, because\n  // any actions that shouldn't happen until \"later\" should generally also\n  // not happen before the first read call.\n  this.sync = true;\n\n  // whenever we return null, then we set a flag to say\n  // that we're awaiting a 'readable' event emission.\n  this.needReadable = false;\n  this.emittedReadable = false;\n  this.readableListening = false;\n  this.resumeScheduled = false;\n  this.paused = true;\n\n  // Should close be emitted on destroy. Defaults to true.\n  this.emitClose = options.emitClose !== false;\n\n  // Should .destroy() be called after 'end' (and potentially 'finish')\n  this.autoDestroy = !!options.autoDestroy;\n\n  // has it been destroyed\n  this.destroyed = false;\n\n  // Crypto is kind of old and crusty.  Historically, its default string\n  // encoding is 'binary' so we have to make this configurable.\n  // Everything else in the universe uses 'utf8', though.\n  this.defaultEncoding = options.defaultEncoding || 'utf8';\n\n  // the number of writers that are awaiting a drain event in .pipe()s\n  this.awaitDrain = 0;\n\n  // if true, a maybeReadMore has been scheduled\n  this.readingMore = false;\n  this.decoder = null;\n  this.encoding = null;\n  if (options.encoding) {\n    if (!StringDecoder) StringDecoder = require('string_decoder/').StringDecoder;\n    this.decoder = new StringDecoder(options.encoding);\n    this.encoding = options.encoding;\n  }\n}\nfunction Readable(options) {\n  Duplex = Duplex || require('./_stream_duplex');\n  if (!(this instanceof Readable)) return new Readable(options);\n\n  // Checking for a Stream.Duplex instance is faster here instead of inside\n  // the ReadableState constructor, at least with V8 6.5\n  var isDuplex = this instanceof Duplex;\n  this._readableState = new ReadableState(options, this, isDuplex);\n\n  // legacy\n  this.readable = true;\n  if (options) {\n    if (typeof options.read === 'function') this._read = options.read;\n    if (typeof options.destroy === 'function') this._destroy = options.destroy;\n  }\n  Stream.call(this);\n}\nObject.defineProperty(Readable.prototype, 'destroyed', {\n  // making it explicit this property is not enumerable\n  // because otherwise some prototype manipulation in\n  // userland will fail\n  enumerable: false,\n  get: function get() {\n    if (this._readableState === undefined) {\n      return false;\n    }\n    return this._readableState.destroyed;\n  },\n  set: function set(value) {\n    // we ignore the value if the stream\n    // has not been initialized yet\n    if (!this._readableState) {\n      return;\n    }\n\n    // backward compatibility, the user is explicitly\n    // managing destroyed\n    this._readableState.destroyed = value;\n  }\n});\nReadable.prototype.destroy = destroyImpl.destroy;\nReadable.prototype._undestroy = destroyImpl.undestroy;\nReadable.prototype._destroy = function (err, cb) {\n  cb(err);\n};\n\n// Manually shove something into the read() buffer.\n// This returns true if the highWaterMark has not been hit yet,\n// similar to how Writable.write() returns true if you should\n// write() some more.\nReadable.prototype.push = function (chunk, encoding) {\n  var state = this._readableState;\n  var skipChunkCheck;\n  if (!state.objectMode) {\n    if (typeof chunk === 'string') {\n      encoding = encoding || state.defaultEncoding;\n      if (encoding !== state.encoding) {\n        chunk = Buffer.from(chunk, encoding);\n        encoding = '';\n      }\n      skipChunkCheck = true;\n    }\n  } else {\n    skipChunkCheck = true;\n  }\n  return readableAddChunk(this, chunk, encoding, false, skipChunkCheck);\n};\n\n// Unshift should *always* be something directly out of read()\nReadable.prototype.unshift = function (chunk) {\n  return readableAddChunk(this, chunk, null, true, false);\n};\nfunction readableAddChunk(stream, chunk, encoding, addToFront, skipChunkCheck) {\n  debug('readableAddChunk', chunk);\n  var state = stream._readableState;\n  if (chunk === null) {\n    state.reading = false;\n    onEofChunk(stream, state);\n  } else {\n    var er;\n    if (!skipChunkCheck) er = chunkInvalid(state, chunk);\n    if (er) {\n      errorOrDestroy(stream, er);\n    } else if (state.objectMode || chunk && chunk.length > 0) {\n      if (typeof chunk !== 'string' && !state.objectMode && Object.getPrototypeOf(chunk) !== Buffer.prototype) {\n        chunk = _uint8ArrayToBuffer(chunk);\n      }\n      if (addToFront) {\n        if (state.endEmitted) errorOrDestroy(stream, new ERR_STREAM_UNSHIFT_AFTER_END_EVENT());else addChunk(stream, state, chunk, true);\n      } else if (state.ended) {\n        errorOrDestroy(stream, new ERR_STREAM_PUSH_AFTER_EOF());\n      } else if (state.destroyed) {\n        return false;\n      } else {\n        state.reading = false;\n        if (state.decoder && !encoding) {\n          chunk = state.decoder.write(chunk);\n          if (state.objectMode || chunk.length !== 0) addChunk(stream, state, chunk, false);else maybeReadMore(stream, state);\n        } else {\n          addChunk(stream, state, chunk, false);\n        }\n      }\n    } else if (!addToFront) {\n      state.reading = false;\n      maybeReadMore(stream, state);\n    }\n  }\n\n  // We can push more data if we are below the highWaterMark.\n  // Also, if we have no data yet, we can stand some more bytes.\n  // This is to work around cases where hwm=0, such as the repl.\n  return !state.ended && (state.length < state.highWaterMark || state.length === 0);\n}\nfunction addChunk(stream, state, chunk, addToFront) {\n  if (state.flowing && state.length === 0 && !state.sync) {\n    state.awaitDrain = 0;\n    stream.emit('data', chunk);\n  } else {\n    // update the buffer info.\n    state.length += state.objectMode ? 1 : chunk.length;\n    if (addToFront) state.buffer.unshift(chunk);else state.buffer.push(chunk);\n    if (state.needReadable) emitReadable(stream);\n  }\n  maybeReadMore(stream, state);\n}\nfunction chunkInvalid(state, chunk) {\n  var er;\n  if (!_isUint8Array(chunk) && typeof chunk !== 'string' && chunk !== undefined && !state.objectMode) {\n    er = new ERR_INVALID_ARG_TYPE('chunk', ['string', 'Buffer', 'Uint8Array'], chunk);\n  }\n  return er;\n}\nReadable.prototype.isPaused = function () {\n  return this._readableState.flowing === false;\n};\n\n// backwards compatibility.\nReadable.prototype.setEncoding = function (enc) {\n  if (!StringDecoder) StringDecoder = require('string_decoder/').StringDecoder;\n  var decoder = new StringDecoder(enc);\n  this._readableState.decoder = decoder;\n  // If setEncoding(null), decoder.encoding equals utf8\n  this._readableState.encoding = this._readableState.decoder.encoding;\n\n  // Iterate over current buffer to convert already stored Buffers:\n  var p = this._readableState.buffer.head;\n  var content = '';\n  while (p !== null) {\n    content += decoder.write(p.data);\n    p = p.next;\n  }\n  this._readableState.buffer.clear();\n  if (content !== '') this._readableState.buffer.push(content);\n  this._readableState.length = content.length;\n  return this;\n};\n\n// Don't raise the hwm > 1GB\nvar MAX_HWM = 0x40000000;\nfunction computeNewHighWaterMark(n) {\n  if (n >= MAX_HWM) {\n    // TODO(ronag): Throw ERR_VALUE_OUT_OF_RANGE.\n    n = MAX_HWM;\n  } else {\n    // Get the next highest power of 2 to prevent increasing hwm excessively in\n    // tiny amounts\n    n--;\n    n |= n >>> 1;\n    n |= n >>> 2;\n    n |= n >>> 4;\n    n |= n >>> 8;\n    n |= n >>> 16;\n    n++;\n  }\n  return n;\n}\n\n// This function is designed to be inlinable, so please take care when making\n// changes to the function body.\nfunction howMuchToRead(n, state) {\n  if (n <= 0 || state.length === 0 && state.ended) return 0;\n  if (state.objectMode) return 1;\n  if (n !== n) {\n    // Only flow one buffer at a time\n    if (state.flowing && state.length) return state.buffer.head.data.length;else return state.length;\n  }\n  // If we're asking for more than the current hwm, then raise the hwm.\n  if (n > state.highWaterMark) state.highWaterMark = computeNewHighWaterMark(n);\n  if (n <= state.length) return n;\n  // Don't have enough\n  if (!state.ended) {\n    state.needReadable = true;\n    return 0;\n  }\n  return state.length;\n}\n\n// you can override either this method, or the async _read(n) below.\nReadable.prototype.read = function (n) {\n  debug('read', n);\n  n = parseInt(n, 10);\n  var state = this._readableState;\n  var nOrig = n;\n  if (n !== 0) state.emittedReadable = false;\n\n  // if we're doing read(0) to trigger a readable event, but we\n  // already have a bunch of data in the buffer, then just trigger\n  // the 'readable' event and move on.\n  if (n === 0 && state.needReadable && ((state.highWaterMark !== 0 ? state.length >= state.highWaterMark : state.length > 0) || state.ended)) {\n    debug('read: emitReadable', state.length, state.ended);\n    if (state.length === 0 && state.ended) endReadable(this);else emitReadable(this);\n    return null;\n  }\n  n = howMuchToRead(n, state);\n\n  // if we've ended, and we're now clear, then finish it up.\n  if (n === 0 && state.ended) {\n    if (state.length === 0) endReadable(this);\n    return null;\n  }\n\n  // All the actual chunk generation logic needs to be\n  // *below* the call to _read.  The reason is that in certain\n  // synthetic stream cases, such as passthrough streams, _read\n  // may be a completely synchronous operation which may change\n  // the state of the read buffer, providing enough data when\n  // before there was *not* enough.\n  //\n  // So, the steps are:\n  // 1. Figure out what the state of things will be after we do\n  // a read from the buffer.\n  //\n  // 2. If that resulting state will trigger a _read, then call _read.\n  // Note that this may be asynchronous, or synchronous.  Yes, it is\n  // deeply ugly to write APIs this way, but that still doesn't mean\n  // that the Readable class should behave improperly, as streams are\n  // designed to be sync/async agnostic.\n  // Take note if the _read call is sync or async (ie, if the read call\n  // has returned yet), so that we know whether or not it's safe to emit\n  // 'readable' etc.\n  //\n  // 3. Actually pull the requested chunks out of the buffer and return.\n\n  // if we need a readable event, then we need to do some reading.\n  var doRead = state.needReadable;\n  debug('need readable', doRead);\n\n  // if we currently have less than the highWaterMark, then also read some\n  if (state.length === 0 || state.length - n < state.highWaterMark) {\n    doRead = true;\n    debug('length less than watermark', doRead);\n  }\n\n  // however, if we've ended, then there's no point, and if we're already\n  // reading, then it's unnecessary.\n  if (state.ended || state.reading) {\n    doRead = false;\n    debug('reading or ended', doRead);\n  } else if (doRead) {\n    debug('do read');\n    state.reading = true;\n    state.sync = true;\n    // if the length is currently zero, then we *need* a readable event.\n    if (state.length === 0) state.needReadable = true;\n    // call internal read method\n    this._read(state.highWaterMark);\n    state.sync = false;\n    // If _read pushed data synchronously, then `reading` will be false,\n    // and we need to re-evaluate how much data we can return to the user.\n    if (!state.reading) n = howMuchToRead(nOrig, state);\n  }\n  var ret;\n  if (n > 0) ret = fromList(n, state);else ret = null;\n  if (ret === null) {\n    state.needReadable = state.length <= state.highWaterMark;\n    n = 0;\n  } else {\n    state.length -= n;\n    state.awaitDrain = 0;\n  }\n  if (state.length === 0) {\n    // If we have nothing in the buffer, then we want to know\n    // as soon as we *do* get something into the buffer.\n    if (!state.ended) state.needReadable = true;\n\n    // If we tried to read() past the EOF, then emit end on the next tick.\n    if (nOrig !== n && state.ended) endReadable(this);\n  }\n  if (ret !== null) this.emit('data', ret);\n  return ret;\n};\nfunction onEofChunk(stream, state) {\n  debug('onEofChunk');\n  if (state.ended) return;\n  if (state.decoder) {\n    var chunk = state.decoder.end();\n    if (chunk && chunk.length) {\n      state.buffer.push(chunk);\n      state.length += state.objectMode ? 1 : chunk.length;\n    }\n  }\n  state.ended = true;\n  if (state.sync) {\n    // if we are sync, wait until next tick to emit the data.\n    // Otherwise we risk emitting data in the flow()\n    // the readable code triggers during a read() call\n    emitReadable(stream);\n  } else {\n    // emit 'readable' now to make sure it gets picked up.\n    state.needReadable = false;\n    if (!state.emittedReadable) {\n      state.emittedReadable = true;\n      emitReadable_(stream);\n    }\n  }\n}\n\n// Don't emit readable right away in sync mode, because this can trigger\n// another read() call => stack overflow.  This way, it might trigger\n// a nextTick recursion warning, but that's not so bad.\nfunction emitReadable(stream) {\n  var state = stream._readableState;\n  debug('emitReadable', state.needReadable, state.emittedReadable);\n  state.needReadable = false;\n  if (!state.emittedReadable) {\n    debug('emitReadable', state.flowing);\n    state.emittedReadable = true;\n    process.nextTick(emitReadable_, stream);\n  }\n}\nfunction emitReadable_(stream) {\n  var state = stream._readableState;\n  debug('emitReadable_', state.destroyed, state.length, state.ended);\n  if (!state.destroyed && (state.length || state.ended)) {\n    stream.emit('readable');\n    state.emittedReadable = false;\n  }\n\n  // The stream needs another readable event if\n  // 1. It is not flowing, as the flow mechanism will take\n  //    care of it.\n  // 2. It is not ended.\n  // 3. It is below the highWaterMark, so we can schedule\n  //    another readable later.\n  state.needReadable = !state.flowing && !state.ended && state.length <= state.highWaterMark;\n  flow(stream);\n}\n\n// at this point, the user has presumably seen the 'readable' event,\n// and called read() to consume some data.  that may have triggered\n// in turn another _read(n) call, in which case reading = true if\n// it's in progress.\n// However, if we're not ended, or reading, and the length < hwm,\n// then go ahead and try to read some more preemptively.\nfunction maybeReadMore(stream, state) {\n  if (!state.readingMore) {\n    state.readingMore = true;\n    process.nextTick(maybeReadMore_, stream, state);\n  }\n}\nfunction maybeReadMore_(stream, state) {\n  // Attempt to read more data if we should.\n  //\n  // The conditions for reading more data are (one of):\n  // - Not enough data buffered (state.length < state.highWaterMark). The loop\n  //   is responsible for filling the buffer with enough data if such data\n  //   is available. If highWaterMark is 0 and we are not in the flowing mode\n  //   we should _not_ attempt to buffer any extra data. We'll get more data\n  //   when the stream consumer calls read() instead.\n  // - No data in the buffer, and the stream is in flowing mode. In this mode\n  //   the loop below is responsible for ensuring read() is called. Failing to\n  //   call read here would abort the flow and there's no other mechanism for\n  //   continuing the flow if the stream consumer has just subscribed to the\n  //   'data' event.\n  //\n  // In addition to the above conditions to keep reading data, the following\n  // conditions prevent the data from being read:\n  // - The stream has ended (state.ended).\n  // - There is already a pending 'read' operation (state.reading). This is a\n  //   case where the the stream has called the implementation defined _read()\n  //   method, but they are processing the call asynchronously and have _not_\n  //   called push() with new data. In this case we skip performing more\n  //   read()s. The execution ends in this method again after the _read() ends\n  //   up calling push() with more data.\n  while (!state.reading && !state.ended && (state.length < state.highWaterMark || state.flowing && state.length === 0)) {\n    var len = state.length;\n    debug('maybeReadMore read 0');\n    stream.read(0);\n    if (len === state.length)\n      // didn't get any data, stop spinning.\n      break;\n  }\n  state.readingMore = false;\n}\n\n// abstract method.  to be overridden in specific implementation classes.\n// call cb(er, data) where data is <= n in length.\n// for virtual (non-string, non-buffer) streams, \"length\" is somewhat\n// arbitrary, and perhaps not very meaningful.\nReadable.prototype._read = function (n) {\n  errorOrDestroy(this, new ERR_METHOD_NOT_IMPLEMENTED('_read()'));\n};\nReadable.prototype.pipe = function (dest, pipeOpts) {\n  var src = this;\n  var state = this._readableState;\n  switch (state.pipesCount) {\n    case 0:\n      state.pipes = dest;\n      break;\n    case 1:\n      state.pipes = [state.pipes, dest];\n      break;\n    default:\n      state.pipes.push(dest);\n      break;\n  }\n  state.pipesCount += 1;\n  debug('pipe count=%d opts=%j', state.pipesCount, pipeOpts);\n  var doEnd = (!pipeOpts || pipeOpts.end !== false) && dest !== process.stdout && dest !== process.stderr;\n  var endFn = doEnd ? onend : unpipe;\n  if (state.endEmitted) process.nextTick(endFn);else src.once('end', endFn);\n  dest.on('unpipe', onunpipe);\n  function onunpipe(readable, unpipeInfo) {\n    debug('onunpipe');\n    if (readable === src) {\n      if (unpipeInfo && unpipeInfo.hasUnpiped === false) {\n        unpipeInfo.hasUnpiped = true;\n        cleanup();\n      }\n    }\n  }\n  function onend() {\n    debug('onend');\n    dest.end();\n  }\n\n  // when the dest drains, it reduces the awaitDrain counter\n  // on the source.  This would be more elegant with a .once()\n  // handler in flow(), but adding and removing repeatedly is\n  // too slow.\n  var ondrain = pipeOnDrain(src);\n  dest.on('drain', ondrain);\n  var cleanedUp = false;\n  function cleanup() {\n    debug('cleanup');\n    // cleanup event handlers once the pipe is broken\n    dest.removeListener('close', onclose);\n    dest.removeListener('finish', onfinish);\n    dest.removeListener('drain', ondrain);\n    dest.removeListener('error', onerror);\n    dest.removeListener('unpipe', onunpipe);\n    src.removeListener('end', onend);\n    src.removeListener('end', unpipe);\n    src.removeListener('data', ondata);\n    cleanedUp = true;\n\n    // if the reader is waiting for a drain event from this\n    // specific writer, then it would cause it to never start\n    // flowing again.\n    // So, if this is awaiting a drain, then we just call it now.\n    // If we don't know, then assume that we are waiting for one.\n    if (state.awaitDrain && (!dest._writableState || dest._writableState.needDrain)) ondrain();\n  }\n  src.on('data', ondata);\n  function ondata(chunk) {\n    debug('ondata');\n    var ret = dest.write(chunk);\n    debug('dest.write', ret);\n    if (ret === false) {\n      // If the user unpiped during `dest.write()`, it is possible\n      // to get stuck in a permanently paused state if that write\n      // also returned false.\n      // => Check whether `dest` is still a piping destination.\n      if ((state.pipesCount === 1 && state.pipes === dest || state.pipesCount > 1 && indexOf(state.pipes, dest) !== -1) && !cleanedUp) {\n        debug('false write response, pause', state.awaitDrain);\n        state.awaitDrain++;\n      }\n      src.pause();\n    }\n  }\n\n  // if the dest has an error, then stop piping into it.\n  // however, don't suppress the throwing behavior for this.\n  function onerror(er) {\n    debug('onerror', er);\n    unpipe();\n    dest.removeListener('error', onerror);\n    if (EElistenerCount(dest, 'error') === 0) errorOrDestroy(dest, er);\n  }\n\n  // Make sure our error handler is attached before userland ones.\n  prependListener(dest, 'error', onerror);\n\n  // Both close and finish should trigger unpipe, but only once.\n  function onclose() {\n    dest.removeListener('finish', onfinish);\n    unpipe();\n  }\n  dest.once('close', onclose);\n  function onfinish() {\n    debug('onfinish');\n    dest.removeListener('close', onclose);\n    unpipe();\n  }\n  dest.once('finish', onfinish);\n  function unpipe() {\n    debug('unpipe');\n    src.unpipe(dest);\n  }\n\n  // tell the dest that it's being piped to\n  dest.emit('pipe', src);\n\n  // start the flow if it hasn't been started already.\n  if (!state.flowing) {\n    debug('pipe resume');\n    src.resume();\n  }\n  return dest;\n};\nfunction pipeOnDrain(src) {\n  return function pipeOnDrainFunctionResult() {\n    var state = src._readableState;\n    debug('pipeOnDrain', state.awaitDrain);\n    if (state.awaitDrain) state.awaitDrain--;\n    if (state.awaitDrain === 0 && EElistenerCount(src, 'data')) {\n      state.flowing = true;\n      flow(src);\n    }\n  };\n}\nReadable.prototype.unpipe = function (dest) {\n  var state = this._readableState;\n  var unpipeInfo = {\n    hasUnpiped: false\n  };\n\n  // if we're not piping anywhere, then do nothing.\n  if (state.pipesCount === 0) return this;\n\n  // just one destination.  most common case.\n  if (state.pipesCount === 1) {\n    // passed in one, but it's not the right one.\n    if (dest && dest !== state.pipes) return this;\n    if (!dest) dest = state.pipes;\n\n    // got a match.\n    state.pipes = null;\n    state.pipesCount = 0;\n    state.flowing = false;\n    if (dest) dest.emit('unpipe', this, unpipeInfo);\n    return this;\n  }\n\n  // slow case. multiple pipe destinations.\n\n  if (!dest) {\n    // remove all.\n    var dests = state.pipes;\n    var len = state.pipesCount;\n    state.pipes = null;\n    state.pipesCount = 0;\n    state.flowing = false;\n    for (var i = 0; i < len; i++) dests[i].emit('unpipe', this, {\n      hasUnpiped: false\n    });\n    return this;\n  }\n\n  // try to find the right one.\n  var index = indexOf(state.pipes, dest);\n  if (index === -1) return this;\n  state.pipes.splice(index, 1);\n  state.pipesCount -= 1;\n  if (state.pipesCount === 1) state.pipes = state.pipes[0];\n  dest.emit('unpipe', this, unpipeInfo);\n  return this;\n};\n\n// set up data events if they are asked for\n// Ensure readable listeners eventually get something\nReadable.prototype.on = function (ev, fn) {\n  var res = Stream.prototype.on.call(this, ev, fn);\n  var state = this._readableState;\n  if (ev === 'data') {\n    // update readableListening so that resume() may be a no-op\n    // a few lines down. This is needed to support once('readable').\n    state.readableListening = this.listenerCount('readable') > 0;\n\n    // Try start flowing on next tick if stream isn't explicitly paused\n    if (state.flowing !== false) this.resume();\n  } else if (ev === 'readable') {\n    if (!state.endEmitted && !state.readableListening) {\n      state.readableListening = state.needReadable = true;\n      state.flowing = false;\n      state.emittedReadable = false;\n      debug('on readable', state.length, state.reading);\n      if (state.length) {\n        emitReadable(this);\n      } else if (!state.reading) {\n        process.nextTick(nReadingNextTick, this);\n      }\n    }\n  }\n  return res;\n};\nReadable.prototype.addListener = Readable.prototype.on;\nReadable.prototype.removeListener = function (ev, fn) {\n  var res = Stream.prototype.removeListener.call(this, ev, fn);\n  if (ev === 'readable') {\n    // We need to check if there is someone still listening to\n    // readable and reset the state. However this needs to happen\n    // after readable has been emitted but before I/O (nextTick) to\n    // support once('readable', fn) cycles. This means that calling\n    // resume within the same tick will have no\n    // effect.\n    process.nextTick(updateReadableListening, this);\n  }\n  return res;\n};\nReadable.prototype.removeAllListeners = function (ev) {\n  var res = Stream.prototype.removeAllListeners.apply(this, arguments);\n  if (ev === 'readable' || ev === undefined) {\n    // We need to check if there is someone still listening to\n    // readable and reset the state. However this needs to happen\n    // after readable has been emitted but before I/O (nextTick) to\n    // support once('readable', fn) cycles. This means that calling\n    // resume within the same tick will have no\n    // effect.\n    process.nextTick(updateReadableListening, this);\n  }\n  return res;\n};\nfunction updateReadableListening(self) {\n  var state = self._readableState;\n  state.readableListening = self.listenerCount('readable') > 0;\n  if (state.resumeScheduled && !state.paused) {\n    // flowing needs to be set to true now, otherwise\n    // the upcoming resume will not flow.\n    state.flowing = true;\n\n    // crude way to check if we should resume\n  } else if (self.listenerCount('data') > 0) {\n    self.resume();\n  }\n}\nfunction nReadingNextTick(self) {\n  debug('readable nexttick read 0');\n  self.read(0);\n}\n\n// pause() and resume() are remnants of the legacy readable stream API\n// If the user uses them, then switch into old mode.\nReadable.prototype.resume = function () {\n  var state = this._readableState;\n  if (!state.flowing) {\n    debug('resume');\n    // we flow only if there is no one listening\n    // for readable, but we still have to call\n    // resume()\n    state.flowing = !state.readableListening;\n    resume(this, state);\n  }\n  state.paused = false;\n  return this;\n};\nfunction resume(stream, state) {\n  if (!state.resumeScheduled) {\n    state.resumeScheduled = true;\n    process.nextTick(resume_, stream, state);\n  }\n}\nfunction resume_(stream, state) {\n  debug('resume', state.reading);\n  if (!state.reading) {\n    stream.read(0);\n  }\n  state.resumeScheduled = false;\n  stream.emit('resume');\n  flow(stream);\n  if (state.flowing && !state.reading) stream.read(0);\n}\nReadable.prototype.pause = function () {\n  debug('call pause flowing=%j', this._readableState.flowing);\n  if (this._readableState.flowing !== false) {\n    debug('pause');\n    this._readableState.flowing = false;\n    this.emit('pause');\n  }\n  this._readableState.paused = true;\n  return this;\n};\nfunction flow(stream) {\n  var state = stream._readableState;\n  debug('flow', state.flowing);\n  while (state.flowing && stream.read() !== null);\n}\n\n// wrap an old-style stream as the async data source.\n// This is *not* part of the readable stream interface.\n// It is an ugly unfortunate mess of history.\nReadable.prototype.wrap = function (stream) {\n  var _this = this;\n  var state = this._readableState;\n  var paused = false;\n  stream.on('end', function () {\n    debug('wrapped end');\n    if (state.decoder && !state.ended) {\n      var chunk = state.decoder.end();\n      if (chunk && chunk.length) _this.push(chunk);\n    }\n    _this.push(null);\n  });\n  stream.on('data', function (chunk) {\n    debug('wrapped data');\n    if (state.decoder) chunk = state.decoder.write(chunk);\n\n    // don't skip over falsy values in objectMode\n    if (state.objectMode && (chunk === null || chunk === undefined)) return;else if (!state.objectMode && (!chunk || !chunk.length)) return;\n    var ret = _this.push(chunk);\n    if (!ret) {\n      paused = true;\n      stream.pause();\n    }\n  });\n\n  // proxy all the other methods.\n  // important when wrapping filters and duplexes.\n  for (var i in stream) {\n    if (this[i] === undefined && typeof stream[i] === 'function') {\n      this[i] = function methodWrap(method) {\n        return function methodWrapReturnFunction() {\n          return stream[method].apply(stream, arguments);\n        };\n      }(i);\n    }\n  }\n\n  // proxy certain important events.\n  for (var n = 0; n < kProxyEvents.length; n++) {\n    stream.on(kProxyEvents[n], this.emit.bind(this, kProxyEvents[n]));\n  }\n\n  // when we try to consume some more bytes, simply unpause the\n  // underlying stream.\n  this._read = function (n) {\n    debug('wrapped _read', n);\n    if (paused) {\n      paused = false;\n      stream.resume();\n    }\n  };\n  return this;\n};\nif (typeof Symbol === 'function') {\n  Readable.prototype[Symbol.asyncIterator] = function () {\n    if (createReadableStreamAsyncIterator === undefined) {\n      createReadableStreamAsyncIterator = require('./internal/streams/async_iterator');\n    }\n    return createReadableStreamAsyncIterator(this);\n  };\n}\nObject.defineProperty(Readable.prototype, 'readableHighWaterMark', {\n  // making it explicit this property is not enumerable\n  // because otherwise some prototype manipulation in\n  // userland will fail\n  enumerable: false,\n  get: function get() {\n    return this._readableState.highWaterMark;\n  }\n});\nObject.defineProperty(Readable.prototype, 'readableBuffer', {\n  // making it explicit this property is not enumerable\n  // because otherwise some prototype manipulation in\n  // userland will fail\n  enumerable: false,\n  get: function get() {\n    return this._readableState && this._readableState.buffer;\n  }\n});\nObject.defineProperty(Readable.prototype, 'readableFlowing', {\n  // making it explicit this property is not enumerable\n  // because otherwise some prototype manipulation in\n  // userland will fail\n  enumerable: false,\n  get: function get() {\n    return this._readableState.flowing;\n  },\n  set: function set(state) {\n    if (this._readableState) {\n      this._readableState.flowing = state;\n    }\n  }\n});\n\n// exposed for testing purposes only.\nReadable._fromList = fromList;\nObject.defineProperty(Readable.prototype, 'readableLength', {\n  // making it explicit this property is not enumerable\n  // because otherwise some prototype manipulation in\n  // userland will fail\n  enumerable: false,\n  get: function get() {\n    return this._readableState.length;\n  }\n});\n\n// Pluck off n bytes from an array of buffers.\n// Length is the combined lengths of all the buffers in the list.\n// This function is designed to be inlinable, so please take care when making\n// changes to the function body.\nfunction fromList(n, state) {\n  // nothing buffered\n  if (state.length === 0) return null;\n  var ret;\n  if (state.objectMode) ret = state.buffer.shift();else if (!n || n >= state.length) {\n    // read it all, truncate the list\n    if (state.decoder) ret = state.buffer.join('');else if (state.buffer.length === 1) ret = state.buffer.first();else ret = state.buffer.concat(state.length);\n    state.buffer.clear();\n  } else {\n    // read part of list\n    ret = state.buffer.consume(n, state.decoder);\n  }\n  return ret;\n}\nfunction endReadable(stream) {\n  var state = stream._readableState;\n  debug('endReadable', state.endEmitted);\n  if (!state.endEmitted) {\n    state.ended = true;\n    process.nextTick(endReadableNT, state, stream);\n  }\n}\nfunction endReadableNT(state, stream) {\n  debug('endReadableNT', state.endEmitted, state.length);\n\n  // Check that we didn't get one last unshift.\n  if (!state.endEmitted && state.length === 0) {\n    state.endEmitted = true;\n    stream.readable = false;\n    stream.emit('end');\n    if (state.autoDestroy) {\n      // In case of duplex streams we need a way to detect\n      // if the writable side is ready for autoDestroy as well\n      var wState = stream._writableState;\n      if (!wState || wState.autoDestroy && wState.finished) {\n        stream.destroy();\n      }\n    }\n  }\n}\nif (typeof Symbol === 'function') {\n  Readable.from = function (iterable, opts) {\n    if (from === undefined) {\n      from = require('./internal/streams/from');\n    }\n    return from(Readable, iterable, opts);\n  };\n}\nfunction indexOf(xs, x) {\n  for (var i = 0, l = xs.length; i < l; i++) {\n    if (xs[i] === x) return i;\n  }\n  return -1;\n}","module.exports = require('events').EventEmitter;\n","'use strict';\n\n// undocumented cb() API, needed for core, not for public API\nfunction destroy(err, cb) {\n  var _this = this;\n  var readableDestroyed = this._readableState && this._readableState.destroyed;\n  var writableDestroyed = this._writableState && this._writableState.destroyed;\n  if (readableDestroyed || writableDestroyed) {\n    if (cb) {\n      cb(err);\n    } else if (err) {\n      if (!this._writableState) {\n        process.nextTick(emitErrorNT, this, err);\n      } else if (!this._writableState.errorEmitted) {\n        this._writableState.errorEmitted = true;\n        process.nextTick(emitErrorNT, this, err);\n      }\n    }\n    return this;\n  }\n\n  // we set destroyed to true before firing error callbacks in order\n  // to make it re-entrance safe in case destroy() is called within callbacks\n\n  if (this._readableState) {\n    this._readableState.destroyed = true;\n  }\n\n  // if this is a duplex stream mark the writable part as destroyed as well\n  if (this._writableState) {\n    this._writableState.destroyed = true;\n  }\n  this._destroy(err || null, function (err) {\n    if (!cb && err) {\n      if (!_this._writableState) {\n        process.nextTick(emitErrorAndCloseNT, _this, err);\n      } else if (!_this._writableState.errorEmitted) {\n        _this._writableState.errorEmitted = true;\n        process.nextTick(emitErrorAndCloseNT, _this, err);\n      } else {\n        process.nextTick(emitCloseNT, _this);\n      }\n    } else if (cb) {\n      process.nextTick(emitCloseNT, _this);\n      cb(err);\n    } else {\n      process.nextTick(emitCloseNT, _this);\n    }\n  });\n  return this;\n}\nfunction emitErrorAndCloseNT(self, err) {\n  emitErrorNT(self, err);\n  emitCloseNT(self);\n}\nfunction emitCloseNT(self) {\n  if (self._writableState && !self._writableState.emitClose) return;\n  if (self._readableState && !self._readableState.emitClose) return;\n  self.emit('close');\n}\nfunction undestroy() {\n  if (this._readableState) {\n    this._readableState.destroyed = false;\n    this._readableState.reading = false;\n    this._readableState.ended = false;\n    this._readableState.endEmitted = false;\n  }\n  if (this._writableState) {\n    this._writableState.destroyed = false;\n    this._writableState.ended = false;\n    this._writableState.ending = false;\n    this._writableState.finalCalled = false;\n    this._writableState.prefinished = false;\n    this._writableState.finished = false;\n    this._writableState.errorEmitted = false;\n  }\n}\nfunction emitErrorNT(self, err) {\n  self.emit('error', err);\n}\nfunction errorOrDestroy(stream, err) {\n  // We have tests that rely on errors being emitted\n  // in the same tick, so changing this is semver major.\n  // For now when you opt-in to autoDestroy we allow\n  // the error to be emitted nextTick. In a future\n  // semver major update we should change the default to this.\n\n  var rState = stream._readableState;\n  var wState = stream._writableState;\n  if (rState && rState.autoDestroy || wState && wState.autoDestroy) stream.destroy(err);else stream.emit('error', err);\n}\nmodule.exports = {\n  destroy: destroy,\n  undestroy: undestroy,\n  errorOrDestroy: errorOrDestroy\n};","'use strict';\n\nvar ERR_INVALID_OPT_VALUE = require('../../../errors').codes.ERR_INVALID_OPT_VALUE;\nfunction highWaterMarkFrom(options, isDuplex, duplexKey) {\n  return options.highWaterMark != null ? options.highWaterMark : isDuplex ? options[duplexKey] : null;\n}\nfunction getHighWaterMark(state, options, duplexKey, isDuplex) {\n  var hwm = highWaterMarkFrom(options, isDuplex, duplexKey);\n  if (hwm != null) {\n    if (!(isFinite(hwm) && Math.floor(hwm) === hwm) || hwm < 0) {\n      var name = isDuplex ? duplexKey : 'highWaterMark';\n      throw new ERR_INVALID_OPT_VALUE(name, hwm);\n    }\n    return Math.floor(hwm);\n  }\n\n  // Default value\n  return state.objectMode ? 16 : 16 * 1024;\n}\nmodule.exports = {\n  getHighWaterMark: getHighWaterMark\n};","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n// A bit simpler than readable streams.\n// Implement an async ._write(chunk, encoding, cb), and it'll handle all\n// the drain event emission and buffering.\n\n'use strict';\n\nmodule.exports = Writable;\n\n/* <replacement> */\nfunction WriteReq(chunk, encoding, cb) {\n  this.chunk = chunk;\n  this.encoding = encoding;\n  this.callback = cb;\n  this.next = null;\n}\n\n// It seems a linked list but it is not\n// there will be only 2 of these for each stream\nfunction CorkedRequest(state) {\n  var _this = this;\n  this.next = null;\n  this.entry = null;\n  this.finish = function () {\n    onCorkedFinish(_this, state);\n  };\n}\n/* </replacement> */\n\n/*<replacement>*/\nvar Duplex;\n/*</replacement>*/\n\nWritable.WritableState = WritableState;\n\n/*<replacement>*/\nvar internalUtil = {\n  deprecate: require('util-deprecate')\n};\n/*</replacement>*/\n\n/*<replacement>*/\nvar Stream = require('./internal/streams/stream');\n/*</replacement>*/\n\nvar Buffer = require('buffer').Buffer;\nvar OurUint8Array = (typeof global !== 'undefined' ? global : typeof window !== 'undefined' ? window : typeof self !== 'undefined' ? self : {}).Uint8Array || function () {};\nfunction _uint8ArrayToBuffer(chunk) {\n  return Buffer.from(chunk);\n}\nfunction _isUint8Array(obj) {\n  return Buffer.isBuffer(obj) || obj instanceof OurUint8Array;\n}\nvar destroyImpl = require('./internal/streams/destroy');\nvar _require = require('./internal/streams/state'),\n  getHighWaterMark = _require.getHighWaterMark;\nvar _require$codes = require('../errors').codes,\n  ERR_INVALID_ARG_TYPE = _require$codes.ERR_INVALID_ARG_TYPE,\n  ERR_METHOD_NOT_IMPLEMENTED = _require$codes.ERR_METHOD_NOT_IMPLEMENTED,\n  ERR_MULTIPLE_CALLBACK = _require$codes.ERR_MULTIPLE_CALLBACK,\n  ERR_STREAM_CANNOT_PIPE = _require$codes.ERR_STREAM_CANNOT_PIPE,\n  ERR_STREAM_DESTROYED = _require$codes.ERR_STREAM_DESTROYED,\n  ERR_STREAM_NULL_VALUES = _require$codes.ERR_STREAM_NULL_VALUES,\n  ERR_STREAM_WRITE_AFTER_END = _require$codes.ERR_STREAM_WRITE_AFTER_END,\n  ERR_UNKNOWN_ENCODING = _require$codes.ERR_UNKNOWN_ENCODING;\nvar errorOrDestroy = destroyImpl.errorOrDestroy;\nrequire('inherits')(Writable, Stream);\nfunction nop() {}\nfunction WritableState(options, stream, isDuplex) {\n  Duplex = Duplex || require('./_stream_duplex');\n  options = options || {};\n\n  // Duplex streams are both readable and writable, but share\n  // the same options object.\n  // However, some cases require setting options to different\n  // values for the readable and the writable sides of the duplex stream,\n  // e.g. options.readableObjectMode vs. options.writableObjectMode, etc.\n  if (typeof isDuplex !== 'boolean') isDuplex = stream instanceof Duplex;\n\n  // object stream flag to indicate whether or not this stream\n  // contains buffers or objects.\n  this.objectMode = !!options.objectMode;\n  if (isDuplex) this.objectMode = this.objectMode || !!options.writableObjectMode;\n\n  // the point at which write() starts returning false\n  // Note: 0 is a valid value, means that we always return false if\n  // the entire buffer is not flushed immediately on write()\n  this.highWaterMark = getHighWaterMark(this, options, 'writableHighWaterMark', isDuplex);\n\n  // if _final has been called\n  this.finalCalled = false;\n\n  // drain event flag.\n  this.needDrain = false;\n  // at the start of calling end()\n  this.ending = false;\n  // when end() has been called, and returned\n  this.ended = false;\n  // when 'finish' is emitted\n  this.finished = false;\n\n  // has it been destroyed\n  this.destroyed = false;\n\n  // should we decode strings into buffers before passing to _write?\n  // this is here so that some node-core streams can optimize string\n  // handling at a lower level.\n  var noDecode = options.decodeStrings === false;\n  this.decodeStrings = !noDecode;\n\n  // Crypto is kind of old and crusty.  Historically, its default string\n  // encoding is 'binary' so we have to make this configurable.\n  // Everything else in the universe uses 'utf8', though.\n  this.defaultEncoding = options.defaultEncoding || 'utf8';\n\n  // not an actual buffer we keep track of, but a measurement\n  // of how much we're waiting to get pushed to some underlying\n  // socket or file.\n  this.length = 0;\n\n  // a flag to see when we're in the middle of a write.\n  this.writing = false;\n\n  // when true all writes will be buffered until .uncork() call\n  this.corked = 0;\n\n  // a flag to be able to tell if the onwrite cb is called immediately,\n  // or on a later tick.  We set this to true at first, because any\n  // actions that shouldn't happen until \"later\" should generally also\n  // not happen before the first write call.\n  this.sync = true;\n\n  // a flag to know if we're processing previously buffered items, which\n  // may call the _write() callback in the same tick, so that we don't\n  // end up in an overlapped onwrite situation.\n  this.bufferProcessing = false;\n\n  // the callback that's passed to _write(chunk,cb)\n  this.onwrite = function (er) {\n    onwrite(stream, er);\n  };\n\n  // the callback that the user supplies to write(chunk,encoding,cb)\n  this.writecb = null;\n\n  // the amount that is being written when _write is called.\n  this.writelen = 0;\n  this.bufferedRequest = null;\n  this.lastBufferedRequest = null;\n\n  // number of pending user-supplied write callbacks\n  // this must be 0 before 'finish' can be emitted\n  this.pendingcb = 0;\n\n  // emit prefinish if the only thing we're waiting for is _write cbs\n  // This is relevant for synchronous Transform streams\n  this.prefinished = false;\n\n  // True if the error was already emitted and should not be thrown again\n  this.errorEmitted = false;\n\n  // Should close be emitted on destroy. Defaults to true.\n  this.emitClose = options.emitClose !== false;\n\n  // Should .destroy() be called after 'finish' (and potentially 'end')\n  this.autoDestroy = !!options.autoDestroy;\n\n  // count buffered requests\n  this.bufferedRequestCount = 0;\n\n  // allocate the first CorkedRequest, there is always\n  // one allocated and free to use, and we maintain at most two\n  this.corkedRequestsFree = new CorkedRequest(this);\n}\nWritableState.prototype.getBuffer = function getBuffer() {\n  var current = this.bufferedRequest;\n  var out = [];\n  while (current) {\n    out.push(current);\n    current = current.next;\n  }\n  return out;\n};\n(function () {\n  try {\n    Object.defineProperty(WritableState.prototype, 'buffer', {\n      get: internalUtil.deprecate(function writableStateBufferGetter() {\n        return this.getBuffer();\n      }, '_writableState.buffer is deprecated. Use _writableState.getBuffer ' + 'instead.', 'DEP0003')\n    });\n  } catch (_) {}\n})();\n\n// Test _writableState for inheritance to account for Duplex streams,\n// whose prototype chain only points to Readable.\nvar realHasInstance;\nif (typeof Symbol === 'function' && Symbol.hasInstance && typeof Function.prototype[Symbol.hasInstance] === 'function') {\n  realHasInstance = Function.prototype[Symbol.hasInstance];\n  Object.defineProperty(Writable, Symbol.hasInstance, {\n    value: function value(object) {\n      if (realHasInstance.call(this, object)) return true;\n      if (this !== Writable) return false;\n      return object && object._writableState instanceof WritableState;\n    }\n  });\n} else {\n  realHasInstance = function realHasInstance(object) {\n    return object instanceof this;\n  };\n}\nfunction Writable(options) {\n  Duplex = Duplex || require('./_stream_duplex');\n\n  // Writable ctor is applied to Duplexes, too.\n  // `realHasInstance` is necessary because using plain `instanceof`\n  // would return false, as no `_writableState` property is attached.\n\n  // Trying to use the custom `instanceof` for Writable here will also break the\n  // Node.js LazyTransform implementation, which has a non-trivial getter for\n  // `_writableState` that would lead to infinite recursion.\n\n  // Checking for a Stream.Duplex instance is faster here instead of inside\n  // the WritableState constructor, at least with V8 6.5\n  var isDuplex = this instanceof Duplex;\n  if (!isDuplex && !realHasInstance.call(Writable, this)) return new Writable(options);\n  this._writableState = new WritableState(options, this, isDuplex);\n\n  // legacy.\n  this.writable = true;\n  if (options) {\n    if (typeof options.write === 'function') this._write = options.write;\n    if (typeof options.writev === 'function') this._writev = options.writev;\n    if (typeof options.destroy === 'function') this._destroy = options.destroy;\n    if (typeof options.final === 'function') this._final = options.final;\n  }\n  Stream.call(this);\n}\n\n// Otherwise people can pipe Writable streams, which is just wrong.\nWritable.prototype.pipe = function () {\n  errorOrDestroy(this, new ERR_STREAM_CANNOT_PIPE());\n};\nfunction writeAfterEnd(stream, cb) {\n  var er = new ERR_STREAM_WRITE_AFTER_END();\n  // TODO: defer error events consistently everywhere, not just the cb\n  errorOrDestroy(stream, er);\n  process.nextTick(cb, er);\n}\n\n// Checks that a user-supplied chunk is valid, especially for the particular\n// mode the stream is in. Currently this means that `null` is never accepted\n// and undefined/non-string values are only allowed in object mode.\nfunction validChunk(stream, state, chunk, cb) {\n  var er;\n  if (chunk === null) {\n    er = new ERR_STREAM_NULL_VALUES();\n  } else if (typeof chunk !== 'string' && !state.objectMode) {\n    er = new ERR_INVALID_ARG_TYPE('chunk', ['string', 'Buffer'], chunk);\n  }\n  if (er) {\n    errorOrDestroy(stream, er);\n    process.nextTick(cb, er);\n    return false;\n  }\n  return true;\n}\nWritable.prototype.write = function (chunk, encoding, cb) {\n  var state = this._writableState;\n  var ret = false;\n  var isBuf = !state.objectMode && _isUint8Array(chunk);\n  if (isBuf && !Buffer.isBuffer(chunk)) {\n    chunk = _uint8ArrayToBuffer(chunk);\n  }\n  if (typeof encoding === 'function') {\n    cb = encoding;\n    encoding = null;\n  }\n  if (isBuf) encoding = 'buffer';else if (!encoding) encoding = state.defaultEncoding;\n  if (typeof cb !== 'function') cb = nop;\n  if (state.ending) writeAfterEnd(this, cb);else if (isBuf || validChunk(this, state, chunk, cb)) {\n    state.pendingcb++;\n    ret = writeOrBuffer(this, state, isBuf, chunk, encoding, cb);\n  }\n  return ret;\n};\nWritable.prototype.cork = function () {\n  this._writableState.corked++;\n};\nWritable.prototype.uncork = function () {\n  var state = this._writableState;\n  if (state.corked) {\n    state.corked--;\n    if (!state.writing && !state.corked && !state.bufferProcessing && state.bufferedRequest) clearBuffer(this, state);\n  }\n};\nWritable.prototype.setDefaultEncoding = function setDefaultEncoding(encoding) {\n  // node::ParseEncoding() requires lower case.\n  if (typeof encoding === 'string') encoding = encoding.toLowerCase();\n  if (!(['hex', 'utf8', 'utf-8', 'ascii', 'binary', 'base64', 'ucs2', 'ucs-2', 'utf16le', 'utf-16le', 'raw'].indexOf((encoding + '').toLowerCase()) > -1)) throw new ERR_UNKNOWN_ENCODING(encoding);\n  this._writableState.defaultEncoding = encoding;\n  return this;\n};\nObject.defineProperty(Writable.prototype, 'writableBuffer', {\n  // making it explicit this property is not enumerable\n  // because otherwise some prototype manipulation in\n  // userland will fail\n  enumerable: false,\n  get: function get() {\n    return this._writableState && this._writableState.getBuffer();\n  }\n});\nfunction decodeChunk(state, chunk, encoding) {\n  if (!state.objectMode && state.decodeStrings !== false && typeof chunk === 'string') {\n    chunk = Buffer.from(chunk, encoding);\n  }\n  return chunk;\n}\nObject.defineProperty(Writable.prototype, 'writableHighWaterMark', {\n  // making it explicit this property is not enumerable\n  // because otherwise some prototype manipulation in\n  // userland will fail\n  enumerable: false,\n  get: function get() {\n    return this._writableState.highWaterMark;\n  }\n});\n\n// if we're already writing something, then just put this\n// in the queue, and wait our turn.  Otherwise, call _write\n// If we return false, then we need a drain event, so set that flag.\nfunction writeOrBuffer(stream, state, isBuf, chunk, encoding, cb) {\n  if (!isBuf) {\n    var newChunk = decodeChunk(state, chunk, encoding);\n    if (chunk !== newChunk) {\n      isBuf = true;\n      encoding = 'buffer';\n      chunk = newChunk;\n    }\n  }\n  var len = state.objectMode ? 1 : chunk.length;\n  state.length += len;\n  var ret = state.length < state.highWaterMark;\n  // we must ensure that previous needDrain will not be reset to false.\n  if (!ret) state.needDrain = true;\n  if (state.writing || state.corked) {\n    var last = state.lastBufferedRequest;\n    state.lastBufferedRequest = {\n      chunk: chunk,\n      encoding: encoding,\n      isBuf: isBuf,\n      callback: cb,\n      next: null\n    };\n    if (last) {\n      last.next = state.lastBufferedRequest;\n    } else {\n      state.bufferedRequest = state.lastBufferedRequest;\n    }\n    state.bufferedRequestCount += 1;\n  } else {\n    doWrite(stream, state, false, len, chunk, encoding, cb);\n  }\n  return ret;\n}\nfunction doWrite(stream, state, writev, len, chunk, encoding, cb) {\n  state.writelen = len;\n  state.writecb = cb;\n  state.writing = true;\n  state.sync = true;\n  if (state.destroyed) state.onwrite(new ERR_STREAM_DESTROYED('write'));else if (writev) stream._writev(chunk, state.onwrite);else stream._write(chunk, encoding, state.onwrite);\n  state.sync = false;\n}\nfunction onwriteError(stream, state, sync, er, cb) {\n  --state.pendingcb;\n  if (sync) {\n    // defer the callback if we are being called synchronously\n    // to avoid piling up things on the stack\n    process.nextTick(cb, er);\n    // this can emit finish, and it will always happen\n    // after error\n    process.nextTick(finishMaybe, stream, state);\n    stream._writableState.errorEmitted = true;\n    errorOrDestroy(stream, er);\n  } else {\n    // the caller expect this to happen before if\n    // it is async\n    cb(er);\n    stream._writableState.errorEmitted = true;\n    errorOrDestroy(stream, er);\n    // this can emit finish, but finish must\n    // always follow error\n    finishMaybe(stream, state);\n  }\n}\nfunction onwriteStateUpdate(state) {\n  state.writing = false;\n  state.writecb = null;\n  state.length -= state.writelen;\n  state.writelen = 0;\n}\nfunction onwrite(stream, er) {\n  var state = stream._writableState;\n  var sync = state.sync;\n  var cb = state.writecb;\n  if (typeof cb !== 'function') throw new ERR_MULTIPLE_CALLBACK();\n  onwriteStateUpdate(state);\n  if (er) onwriteError(stream, state, sync, er, cb);else {\n    // Check if we're actually ready to finish, but don't emit yet\n    var finished = needFinish(state) || stream.destroyed;\n    if (!finished && !state.corked && !state.bufferProcessing && state.bufferedRequest) {\n      clearBuffer(stream, state);\n    }\n    if (sync) {\n      process.nextTick(afterWrite, stream, state, finished, cb);\n    } else {\n      afterWrite(stream, state, finished, cb);\n    }\n  }\n}\nfunction afterWrite(stream, state, finished, cb) {\n  if (!finished) onwriteDrain(stream, state);\n  state.pendingcb--;\n  cb();\n  finishMaybe(stream, state);\n}\n\n// Must force callback to be called on nextTick, so that we don't\n// emit 'drain' before the write() consumer gets the 'false' return\n// value, and has a chance to attach a 'drain' listener.\nfunction onwriteDrain(stream, state) {\n  if (state.length === 0 && state.needDrain) {\n    state.needDrain = false;\n    stream.emit('drain');\n  }\n}\n\n// if there's something in the buffer waiting, then process it\nfunction clearBuffer(stream, state) {\n  state.bufferProcessing = true;\n  var entry = state.bufferedRequest;\n  if (stream._writev && entry && entry.next) {\n    // Fast case, write everything using _writev()\n    var l = state.bufferedRequestCount;\n    var buffer = new Array(l);\n    var holder = state.corkedRequestsFree;\n    holder.entry = entry;\n    var count = 0;\n    var allBuffers = true;\n    while (entry) {\n      buffer[count] = entry;\n      if (!entry.isBuf) allBuffers = false;\n      entry = entry.next;\n      count += 1;\n    }\n    buffer.allBuffers = allBuffers;\n    doWrite(stream, state, true, state.length, buffer, '', holder.finish);\n\n    // doWrite is almost always async, defer these to save a bit of time\n    // as the hot path ends with doWrite\n    state.pendingcb++;\n    state.lastBufferedRequest = null;\n    if (holder.next) {\n      state.corkedRequestsFree = holder.next;\n      holder.next = null;\n    } else {\n      state.corkedRequestsFree = new CorkedRequest(state);\n    }\n    state.bufferedRequestCount = 0;\n  } else {\n    // Slow case, write chunks one-by-one\n    while (entry) {\n      var chunk = entry.chunk;\n      var encoding = entry.encoding;\n      var cb = entry.callback;\n      var len = state.objectMode ? 1 : chunk.length;\n      doWrite(stream, state, false, len, chunk, encoding, cb);\n      entry = entry.next;\n      state.bufferedRequestCount--;\n      // if we didn't call the onwrite immediately, then\n      // it means that we need to wait until it does.\n      // also, that means that the chunk and cb are currently\n      // being processed, so move the buffer counter past them.\n      if (state.writing) {\n        break;\n      }\n    }\n    if (entry === null) state.lastBufferedRequest = null;\n  }\n  state.bufferedRequest = entry;\n  state.bufferProcessing = false;\n}\nWritable.prototype._write = function (chunk, encoding, cb) {\n  cb(new ERR_METHOD_NOT_IMPLEMENTED('_write()'));\n};\nWritable.prototype._writev = null;\nWritable.prototype.end = function (chunk, encoding, cb) {\n  var state = this._writableState;\n  if (typeof chunk === 'function') {\n    cb = chunk;\n    chunk = null;\n    encoding = null;\n  } else if (typeof encoding === 'function') {\n    cb = encoding;\n    encoding = null;\n  }\n  if (chunk !== null && chunk !== undefined) this.write(chunk, encoding);\n\n  // .end() fully uncorks\n  if (state.corked) {\n    state.corked = 1;\n    this.uncork();\n  }\n\n  // ignore unnecessary end() calls.\n  if (!state.ending) endWritable(this, state, cb);\n  return this;\n};\nObject.defineProperty(Writable.prototype, 'writableLength', {\n  // making it explicit this property is not enumerable\n  // because otherwise some prototype manipulation in\n  // userland will fail\n  enumerable: false,\n  get: function get() {\n    return this._writableState.length;\n  }\n});\nfunction needFinish(state) {\n  return state.ending && state.length === 0 && state.bufferedRequest === null && !state.finished && !state.writing;\n}\nfunction callFinal(stream, state) {\n  stream._final(function (err) {\n    state.pendingcb--;\n    if (err) {\n      errorOrDestroy(stream, err);\n    }\n    state.prefinished = true;\n    stream.emit('prefinish');\n    finishMaybe(stream, state);\n  });\n}\nfunction prefinish(stream, state) {\n  if (!state.prefinished && !state.finalCalled) {\n    if (typeof stream._final === 'function' && !state.destroyed) {\n      state.pendingcb++;\n      state.finalCalled = true;\n      process.nextTick(callFinal, stream, state);\n    } else {\n      state.prefinished = true;\n      stream.emit('prefinish');\n    }\n  }\n}\nfunction finishMaybe(stream, state) {\n  var need = needFinish(state);\n  if (need) {\n    prefinish(stream, state);\n    if (state.pendingcb === 0) {\n      state.finished = true;\n      stream.emit('finish');\n      if (state.autoDestroy) {\n        // In case of duplex streams we need a way to detect\n        // if the readable side is ready for autoDestroy as well\n        var rState = stream._readableState;\n        if (!rState || rState.autoDestroy && rState.endEmitted) {\n          stream.destroy();\n        }\n      }\n    }\n  }\n  return need;\n}\nfunction endWritable(stream, state, cb) {\n  state.ending = true;\n  finishMaybe(stream, state);\n  if (cb) {\n    if (state.finished) process.nextTick(cb);else stream.once('finish', cb);\n  }\n  state.ended = true;\n  stream.writable = false;\n}\nfunction onCorkedFinish(corkReq, state, err) {\n  var entry = corkReq.entry;\n  corkReq.entry = null;\n  while (entry) {\n    var cb = entry.callback;\n    state.pendingcb--;\n    cb(err);\n    entry = entry.next;\n  }\n\n  // reuse the free corkReq.\n  state.corkedRequestsFree.next = corkReq;\n}\nObject.defineProperty(Writable.prototype, 'destroyed', {\n  // making it explicit this property is not enumerable\n  // because otherwise some prototype manipulation in\n  // userland will fail\n  enumerable: false,\n  get: function get() {\n    if (this._writableState === undefined) {\n      return false;\n    }\n    return this._writableState.destroyed;\n  },\n  set: function set(value) {\n    // we ignore the value if the stream\n    // has not been initialized yet\n    if (!this._writableState) {\n      return;\n    }\n\n    // backward compatibility, the user is explicitly\n    // managing destroyed\n    this._writableState.destroyed = value;\n  }\n});\nWritable.prototype.destroy = destroyImpl.destroy;\nWritable.prototype._undestroy = destroyImpl.undestroy;\nWritable.prototype._destroy = function (err, cb) {\n  cb(err);\n};","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n// a transform stream is a readable/writable stream where you do\n// something with the data.  Sometimes it's called a \"filter\",\n// but that's not a great name for it, since that implies a thing where\n// some bits pass through, and others are simply ignored.  (That would\n// be a valid example of a transform, of course.)\n//\n// While the output is causally related to the input, it's not a\n// necessarily symmetric or synchronous transformation.  For example,\n// a zlib stream might take multiple plain-text writes(), and then\n// emit a single compressed chunk some time in the future.\n//\n// Here's how this works:\n//\n// The Transform stream has all the aspects of the readable and writable\n// stream classes.  When you write(chunk), that calls _write(chunk,cb)\n// internally, and returns false if there's a lot of pending writes\n// buffered up.  When you call read(), that calls _read(n) until\n// there's enough pending readable data buffered up.\n//\n// In a transform stream, the written data is placed in a buffer.  When\n// _read(n) is called, it transforms the queued up data, calling the\n// buffered _write cb's as it consumes chunks.  If consuming a single\n// written chunk would result in multiple output chunks, then the first\n// outputted bit calls the readcb, and subsequent chunks just go into\n// the read buffer, and will cause it to emit 'readable' if necessary.\n//\n// This way, back-pressure is actually determined by the reading side,\n// since _read has to be called to start processing a new chunk.  However,\n// a pathological inflate type of transform can cause excessive buffering\n// here.  For example, imagine a stream where every byte of input is\n// interpreted as an integer from 0-255, and then results in that many\n// bytes of output.  Writing the 4 bytes {ff,ff,ff,ff} would result in\n// 1kb of data being output.  In this case, you could write a very small\n// amount of input, and end up with a very large amount of output.  In\n// such a pathological inflating mechanism, there'd be no way to tell\n// the system to stop doing the transform.  A single 4MB write could\n// cause the system to run out of memory.\n//\n// However, even in such a pathological case, only a single written chunk\n// would be consumed, and then the rest would wait (un-transformed) until\n// the results of the previous transformed chunk were consumed.\n\n'use strict';\n\nmodule.exports = Transform;\nvar _require$codes = require('../errors').codes,\n  ERR_METHOD_NOT_IMPLEMENTED = _require$codes.ERR_METHOD_NOT_IMPLEMENTED,\n  ERR_MULTIPLE_CALLBACK = _require$codes.ERR_MULTIPLE_CALLBACK,\n  ERR_TRANSFORM_ALREADY_TRANSFORMING = _require$codes.ERR_TRANSFORM_ALREADY_TRANSFORMING,\n  ERR_TRANSFORM_WITH_LENGTH_0 = _require$codes.ERR_TRANSFORM_WITH_LENGTH_0;\nvar Duplex = require('./_stream_duplex');\nrequire('inherits')(Transform, Duplex);\nfunction afterTransform(er, data) {\n  var ts = this._transformState;\n  ts.transforming = false;\n  var cb = ts.writecb;\n  if (cb === null) {\n    return this.emit('error', new ERR_MULTIPLE_CALLBACK());\n  }\n  ts.writechunk = null;\n  ts.writecb = null;\n  if (data != null)\n    // single equals check for both `null` and `undefined`\n    this.push(data);\n  cb(er);\n  var rs = this._readableState;\n  rs.reading = false;\n  if (rs.needReadable || rs.length < rs.highWaterMark) {\n    this._read(rs.highWaterMark);\n  }\n}\nfunction Transform(options) {\n  if (!(this instanceof Transform)) return new Transform(options);\n  Duplex.call(this, options);\n  this._transformState = {\n    afterTransform: afterTransform.bind(this),\n    needTransform: false,\n    transforming: false,\n    writecb: null,\n    writechunk: null,\n    writeencoding: null\n  };\n\n  // start out asking for a readable event once data is transformed.\n  this._readableState.needReadable = true;\n\n  // we have implemented the _read method, and done the other things\n  // that Readable wants before the first _read call, so unset the\n  // sync guard flag.\n  this._readableState.sync = false;\n  if (options) {\n    if (typeof options.transform === 'function') this._transform = options.transform;\n    if (typeof options.flush === 'function') this._flush = options.flush;\n  }\n\n  // When the writable side finishes, then flush out anything remaining.\n  this.on('prefinish', prefinish);\n}\nfunction prefinish() {\n  var _this = this;\n  if (typeof this._flush === 'function' && !this._readableState.destroyed) {\n    this._flush(function (er, data) {\n      done(_this, er, data);\n    });\n  } else {\n    done(this, null, null);\n  }\n}\nTransform.prototype.push = function (chunk, encoding) {\n  this._transformState.needTransform = false;\n  return Duplex.prototype.push.call(this, chunk, encoding);\n};\n\n// This is the part where you do stuff!\n// override this function in implementation classes.\n// 'chunk' is an input chunk.\n//\n// Call `push(newChunk)` to pass along transformed output\n// to the readable side.  You may call 'push' zero or more times.\n//\n// Call `cb(err)` when you are done with this chunk.  If you pass\n// an error, then that'll put the hurt on the whole operation.  If you\n// never call cb(), then you'll never get another chunk.\nTransform.prototype._transform = function (chunk, encoding, cb) {\n  cb(new ERR_METHOD_NOT_IMPLEMENTED('_transform()'));\n};\nTransform.prototype._write = function (chunk, encoding, cb) {\n  var ts = this._transformState;\n  ts.writecb = cb;\n  ts.writechunk = chunk;\n  ts.writeencoding = encoding;\n  if (!ts.transforming) {\n    var rs = this._readableState;\n    if (ts.needTransform || rs.needReadable || rs.length < rs.highWaterMark) this._read(rs.highWaterMark);\n  }\n};\n\n// Doesn't matter what the args are here.\n// _transform does all the work.\n// That we got here means that the readable side wants more data.\nTransform.prototype._read = function (n) {\n  var ts = this._transformState;\n  if (ts.writechunk !== null && !ts.transforming) {\n    ts.transforming = true;\n    this._transform(ts.writechunk, ts.writeencoding, ts.afterTransform);\n  } else {\n    // mark that we need a transform, so that any data that comes in\n    // will get processed, now that we've asked for it.\n    ts.needTransform = true;\n  }\n};\nTransform.prototype._destroy = function (err, cb) {\n  Duplex.prototype._destroy.call(this, err, function (err2) {\n    cb(err2);\n  });\n};\nfunction done(stream, er, data) {\n  if (er) return stream.emit('error', er);\n  if (data != null)\n    // single equals check for both `null` and `undefined`\n    stream.push(data);\n\n  // TODO(BridgeAR): Write a test for these two error cases\n  // if there's nothing in the write buffer, then that means\n  // that nothing more will ever be provided\n  if (stream._writableState.length) throw new ERR_TRANSFORM_WITH_LENGTH_0();\n  if (stream._transformState.transforming) throw new ERR_TRANSFORM_ALREADY_TRANSFORMING();\n  return stream.push(null);\n}","import _defineProperty from '@babel/runtime/helpers/defineProperty';\nimport { PublicKey } from '@solana/web3.js';\nimport { createLoggerMiddleware, COMMUNICATION_JRPC_METHODS, COMMUNICATION_NOTIFICATIONS, PROVIDER_JRPC_METHODS, PROVIDER_NOTIFICATIONS } from '@toruslabs/base-controllers';\nimport { setAPIKey } from '@toruslabs/http-helpers';\nimport { SafeEventEmitter, ObjectMultiplex, createStreamMiddleware, JRPCEngine, createIdRemapMiddleware, getRpcPromiseCallback, BasePostMessageStream } from '@toruslabs/openlogin-jrpc';\nimport { ethErrors, EthereumRpcError } from 'eth-rpc-errors';\nimport { duplex } from 'is-stream';\nimport pump from 'pump';\nimport loglevel from 'loglevel';\nimport dequal from 'fast-deep-equal';\n\nvar version = \"0.3.4\";\n\nvar messages = {\n  errors: {\n    disconnected: () => \"Torus: Lost connection to Torus.\",\n    permanentlyDisconnected: () => \"Torus: Disconnected from iframe. Page reload required.\",\n    unsupportedSync: method => `Torus: The Torus Ethereum provider does not support synchronous methods like ${method} without a callback parameter.`,\n    invalidDuplexStream: () => \"Must provide a Node.js-style duplex stream.\",\n    invalidOptions: maxEventListeners => `Invalid options. Received: { maxEventListeners: ${maxEventListeners}}`,\n    invalidRequestArgs: () => `Expected a single, non-array, object argument.`,\n    invalidRequestMethod: () => `'args.method' must be a non-empty string.`,\n    invalidRequestParams: () => `'args.params' must be an object or array if provided.`,\n    invalidLoggerObject: () => `'args.logger' must be an object if provided.`,\n    invalidLoggerMethod: method => `'args.logger' must include required method '${method}'.`\n  },\n  info: {\n    connected: chainId => `Torus: Connected to chain with ID \"${chainId}\".`\n  },\n  warnings: {}\n};\n\nconst PAYMENT_PROVIDER = {\n  MOONPAY: \"moonpay\",\n  WYRE: \"wyre\",\n  RAMPNETWORK: \"rampnetwork\",\n  XANPOOL: \"xanpool\",\n  MERCURYO: \"mercuryo\",\n  TRANSAK: \"transak\"\n};\nconst TORUS_BUILD_ENV = {\n  PRODUCTION: \"production\",\n  DEVELOPMENT: \"development\",\n  TESTING: \"testing\"\n};\nconst BUTTON_POSITION = {\n  BOTTOM_LEFT: \"bottom-left\",\n  TOP_LEFT: \"top-left\",\n  BOTTOM_RIGHT: \"bottom-right\",\n  TOP_RIGHT: \"top-right\"\n};\nconst LOGIN_PROVIDER = {\n  GOOGLE: \"google\",\n  FACEBOOK: \"facebook\",\n  REDDIT: \"reddit\",\n  DISCORD: \"discord\",\n  TWITCH: \"twitch\",\n  APPLE: \"apple\",\n  LINE: \"line\",\n  GITHUB: \"github\",\n  KAKAO: \"kakao\",\n  LINKEDIN: \"linkedin\",\n  TWITTER: \"twitter\",\n  WEIBO: \"weibo\",\n  WECHAT: \"wechat\",\n  EMAIL_PASSWORDLESS: \"email_passwordless\"\n};\n\nconst translations = {\n  en: {\n    embed: {\n      continue: \"Continue\",\n      actionRequired: \"Authorization required\",\n      pendingAction: \"Click continue to proceed with your request in a popup\",\n      cookiesRequired: \"Cookies Required\",\n      enableCookies: \"Please enable cookies in your browser preferences to access Torus\",\n      clickHere: \"More Info\"\n    }\n  },\n  de: {\n    embed: {\n      continue: \"Fortsetzen\",\n      actionRequired: \"Autorisierung erforderlich\",\n      pendingAction: \"Klicken Sie in einem Popup auf Weiter, um mit Ihrer Anfrage fortzufahren\",\n      cookiesRequired: \"Cookies bentigt\",\n      enableCookies: \"Bitte aktivieren Sie Cookies in Ihren Browsereinstellungen, um auf Torus zuzugreifen\",\n      clickHere: \"Mehr Info\"\n    }\n  },\n  ja: {\n    embed: {\n      continue: \"\",\n      actionRequired: \"\",\n      pendingAction: \"\",\n      cookiesRequired: \"\",\n      enableCookies: \"TorusCookie\",\n      clickHere: \"\"\n    }\n  },\n  ko: {\n    embed: {\n      continue: \"\",\n      actionRequired: \" \",\n      pendingAction: \"    .\",\n      cookiesRequired: \" \",\n      enableCookies: \"     Torus .\",\n      clickHere: \"  \"\n    }\n  },\n  zh: {\n    embed: {\n      continue: \"\",\n      actionRequired: \"\",\n      pendingAction: \"\",\n      cookiesRequired: \"Cookie\",\n      enableCookies: \"cookieTorus\",\n      clickHere: \"\"\n    }\n  }\n};\nvar configuration = {\n  supportedVerifierList: [LOGIN_PROVIDER.GOOGLE, LOGIN_PROVIDER.REDDIT, LOGIN_PROVIDER.DISCORD],\n  api: \"https://api.tor.us\",\n  translations,\n  prodTorusUrl: \"\",\n  localStorageKeyPrefix: `torus-`\n};\n\nvar log = loglevel.getLogger(\"solana-embed\");\n\n// utility functions\n/**\n * json-rpc-engine middleware that logs RPC errors and and validates req.method.\n *\n * @param log - The logging API to use.\n * @returns  json-rpc-engine middleware function\n */\nfunction createErrorMiddleware() {\n  return (req, res, next) => {\n    // json-rpc-engine will terminate the request when it notices this error\n    if (typeof req.method !== \"string\" || !req.method) {\n      res.error = ethErrors.rpc.invalidRequest({\n        message: `The request 'method' must be a non-empty string.`,\n        data: req\n      });\n    }\n    next(done => {\n      const {\n        error\n      } = res;\n      if (!error) {\n        return done();\n      }\n      log.error(`Torus - RPC Error: ${error.message}`, error);\n      return done();\n    });\n  };\n}\n/**\n * Logs a stream disconnection error. Emits an 'error' if given an\n * EventEmitter that has listeners for the 'error' event.\n *\n * @param log - The logging API to use.\n * @param remoteLabel - The label of the disconnected stream.\n * @param error - The associated error to log.\n * @param emitter - The logging API to use.\n */\nfunction logStreamDisconnectWarning(remoteLabel, error, emitter) {\n  let warningMsg = `Torus: Lost connection to \"${remoteLabel}\".`;\n  if (error?.stack) {\n    warningMsg += `\\n${error.stack}`;\n  }\n  log.warn(warningMsg);\n  if (emitter && emitter.listenerCount(\"error\") > 0) {\n    emitter.emit(\"error\", warningMsg);\n  }\n}\nconst getWindowId = () => Math.random().toString(36).slice(2);\nconst getTorusUrl = async buildEnv => {\n  let torusUrl;\n  let logLevel;\n  // const versionUsed = version;\n  // log.info(\"solana embed version used: \", versionUsed);\n  switch (buildEnv) {\n    case \"testing\":\n      torusUrl = \"https://solana-testing.tor.us\";\n      logLevel = \"debug\";\n      break;\n    case \"development\":\n      torusUrl = \"http://localhost:8080\";\n      logLevel = \"debug\";\n      break;\n    default:\n      torusUrl = `https://solana.tor.us`;\n      logLevel = \"error\";\n      break;\n  }\n  return {\n    torusUrl,\n    logLevel\n  };\n};\nconst getUserLanguage = () => {\n  let userLanguage = window.navigator.language || \"en-US\";\n  const userLanguages = userLanguage.split(\"-\");\n  userLanguage = Object.prototype.hasOwnProperty.call(configuration.translations, userLanguages[0]) ? userLanguages[0] : \"en\";\n  return userLanguage;\n};\nconst FEATURES_PROVIDER_CHANGE_WINDOW = {\n  height: 660,\n  width: 375\n};\nconst FEATURES_DEFAULT_WALLET_WINDOW = {\n  height: 740,\n  width: 1315\n};\nconst FEATURES_DEFAULT_POPUP_WINDOW = {\n  height: 700,\n  width: 1200\n};\nconst FEATURES_CONFIRM_WINDOW = {\n  height: 600,\n  width: 400\n};\nfunction storageAvailable(type) {\n  let storage;\n  try {\n    storage = window[type];\n    const x = \"__storage_test__\";\n    storage.setItem(x, x);\n    storage.removeItem(x);\n    return true;\n  } catch (e) {\n    return e && (\n    // everything except Firefox\n    e.code === 22 ||\n    // Firefox\n    e.code === 1014 ||\n    // test name field too, because code might not be present\n    // everything except Firefox\n    e.name === \"QuotaExceededError\" ||\n    // Firefox\n    e.name === \"NS_ERROR_DOM_QUOTA_REACHED\") &&\n    // acknowledge QuotaExceededError only if there's something already stored\n    storage && storage.length !== 0;\n  }\n}\n/**\n * popup handler utils\n */\nfunction getPopupFeatures(_ref) {\n  let {\n    width: w,\n    height: h\n  } = _ref;\n  // Fixes dual-screen position                             Most browsers      Firefox\n  const dualScreenLeft = window.screenLeft !== undefined ? window.screenLeft : window.screenX;\n  const dualScreenTop = window.screenTop !== undefined ? window.screenTop : window.screenY;\n  const width = window.innerWidth ? window.innerWidth : document.documentElement.clientWidth ? document.documentElement.clientWidth : window.screen.width;\n  const height = window.innerHeight ? window.innerHeight : document.documentElement.clientHeight ? document.documentElement.clientHeight : window.screen.height;\n  const systemZoom = 1; // No reliable estimate\n  const left = Math.abs((width - w) / 2 / systemZoom + dualScreenLeft);\n  const top = Math.abs((height - h) / 2 / systemZoom + dualScreenTop);\n  const features = `titlebar=0,toolbar=0,status=0,location=0,menubar=0,height=${h / systemZoom},width=${w / systemZoom},top=${top},left=${left}`;\n  return features;\n}\n\nclass BaseProvider extends SafeEventEmitter {\n  /**\n   * Indicating that this provider is a Torus provider.\n   */\n\n  constructor(connectionStream, _ref) {\n    let {\n      maxEventListeners = 100,\n      jsonRpcStreamName = \"provider\"\n    } = _ref;\n    super();\n    _defineProperty(this, \"isTorus\", void 0);\n    _defineProperty(this, \"_rpcEngine\", void 0);\n    _defineProperty(this, \"jsonRpcConnectionEvents\", void 0);\n    _defineProperty(this, \"_state\", void 0);\n    if (!duplex(connectionStream)) {\n      throw new Error(messages.errors.invalidDuplexStream());\n    }\n    this.isTorus = true;\n    this.setMaxListeners(maxEventListeners);\n    this._handleConnect = this._handleConnect.bind(this);\n    this._handleDisconnect = this._handleDisconnect.bind(this);\n    this._handleStreamDisconnect = this._handleStreamDisconnect.bind(this);\n    this._rpcRequest = this._rpcRequest.bind(this);\n    this._initializeState = this._initializeState.bind(this);\n    this.request = this.request.bind(this);\n    this.sendAsync = this.sendAsync.bind(this);\n    // this.enable = this.enable.bind(this);\n    // setup connectionStream multiplexing\n    const mux = new ObjectMultiplex();\n    pump(connectionStream, mux, connectionStream, this._handleStreamDisconnect.bind(this, \"Torus\"));\n    // ignore phishing warning message (handled elsewhere)\n    mux.ignoreStream(\"phishing\");\n    // setup own event listeners\n    // connect to async provider\n    const jsonRpcConnection = createStreamMiddleware();\n    pump(jsonRpcConnection.stream, mux.createStream(jsonRpcStreamName), jsonRpcConnection.stream, this._handleStreamDisconnect.bind(this, \"Torus RpcProvider\"));\n    // handle RPC requests via dapp-side rpc engine\n    const rpcEngine = new JRPCEngine();\n    rpcEngine.push(createIdRemapMiddleware());\n    rpcEngine.push(createErrorMiddleware());\n    rpcEngine.push(createLoggerMiddleware({\n      origin: location.origin\n    }));\n    rpcEngine.push(jsonRpcConnection.middleware);\n    this._rpcEngine = rpcEngine;\n    this.jsonRpcConnectionEvents = jsonRpcConnection.events;\n  }\n  /**\n   * Submits an RPC request for the given method, with the given params.\n   * Resolves with the result of the method call, or rejects on error.\n   */\n  async request(args) {\n    if (!args || typeof args !== \"object\" || Array.isArray(args)) {\n      throw ethErrors.rpc.invalidRequest({\n        message: messages.errors.invalidRequestArgs(),\n        data: args\n      });\n    }\n    const {\n      method,\n      params\n    } = args;\n    if (typeof method !== \"string\" || method.length === 0) {\n      throw ethErrors.rpc.invalidRequest({\n        message: messages.errors.invalidRequestMethod(),\n        data: args\n      });\n    }\n    if (params !== undefined && !Array.isArray(params) && (typeof params !== \"object\" || params === null)) {\n      throw ethErrors.rpc.invalidRequest({\n        message: messages.errors.invalidRequestParams(),\n        data: args\n      });\n    }\n    return new Promise((resolve, reject) => {\n      this._rpcRequest({\n        method,\n        params\n      }, getRpcPromiseCallback(resolve, reject));\n    });\n  }\n  /**\n   * Submits an RPC request per the given JSON-RPC request object.\n   */\n  send(payload, callback) {\n    this._rpcRequest(payload, callback);\n  }\n  /**\n   * Submits an RPC request per the given JSON-RPC request object.\n   */\n  sendAsync(payload) {\n    return new Promise((resolve, reject) => {\n      this._rpcRequest(payload, getRpcPromiseCallback(resolve, reject));\n    });\n  }\n  /**\n   * Called when connection is lost to critical streams.\n   *\n   * emits TorusInpageProvider#disconnect\n   */\n  _handleStreamDisconnect(streamName, error) {\n    logStreamDisconnectWarning(streamName, error, this);\n    this._handleDisconnect(false, error ? error.message : undefined);\n  }\n}\n\nconst handleEvent = function (handle, eventName, handler) {\n  for (var _len = arguments.length, handlerArgs = new Array(_len > 3 ? _len - 3 : 0), _key = 3; _key < _len; _key++) {\n    handlerArgs[_key - 3] = arguments[_key];\n  }\n  const handlerWrapper = () => {\n    handler(...handlerArgs);\n    handle.removeEventListener(eventName, handlerWrapper);\n  };\n  handle.addEventListener(eventName, handlerWrapper);\n};\nasync function documentReady() {\n  return new Promise(resolve => {\n    if (document.readyState !== \"loading\") {\n      resolve();\n    } else {\n      handleEvent(document, \"DOMContentLoaded\", resolve);\n    }\n  });\n}\nconst htmlToElement = html => {\n  const template = window.document.createElement(\"template\");\n  const trimmedHtml = html.trim(); // Never return a text node of whitespace as the result\n  template.innerHTML = trimmedHtml;\n  return template.content.firstChild;\n};\nfunction isLegacyTransactionInstance(transaction) {\n  return transaction.version === undefined;\n}\n\nclass PopupHandler extends SafeEventEmitter {\n  constructor(_ref) {\n    let {\n      url,\n      target,\n      features\n    } = _ref;\n    super();\n    _defineProperty(this, \"url\", void 0);\n    _defineProperty(this, \"target\", void 0);\n    _defineProperty(this, \"features\", void 0);\n    _defineProperty(this, \"window\", void 0);\n    _defineProperty(this, \"windowTimer\", void 0);\n    _defineProperty(this, \"iClosedWindow\", void 0);\n    this.url = url;\n    this.target = target || \"_blank\";\n    this.features = features || getPopupFeatures(FEATURES_DEFAULT_POPUP_WINDOW);\n    this.window = undefined;\n    this.windowTimer = undefined;\n    this.iClosedWindow = false;\n    this._setupTimer();\n  }\n  _setupTimer() {\n    this.windowTimer = Number(setInterval(() => {\n      if (this.window && this.window.closed) {\n        clearInterval(this.windowTimer);\n        if (!this.iClosedWindow) {\n          this.emit(\"close\");\n        }\n        this.iClosedWindow = false;\n        this.window = undefined;\n      }\n      if (this.window === undefined) clearInterval(this.windowTimer);\n    }, 500));\n  }\n  open() {\n    this.window = window.open(this.url.href, this.target, this.features);\n    if (this.window?.focus) this.window.focus();\n    return Promise.resolve();\n  }\n  close() {\n    this.iClosedWindow = true;\n    if (this.window) this.window.close();\n  }\n  redirect(locationReplaceOnRedirect) {\n    if (locationReplaceOnRedirect) {\n      window.location.replace(this.url.href);\n    } else {\n      window.location.href = this.url.href;\n    }\n  }\n}\n\nfunction ownKeys$2(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\nfunction _objectSpread$2(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys$2(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys$2(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\nclass TorusCommunicationProvider extends BaseProvider {\n  constructor(connectionStream, _ref) {\n    let {\n      maxEventListeners = 100,\n      jsonRpcStreamName = \"provider\"\n    } = _ref;\n    super(connectionStream, {\n      maxEventListeners,\n      jsonRpcStreamName\n    });\n    // private state\n    _defineProperty(this, \"embedTranslations\", void 0);\n    _defineProperty(this, \"torusUrl\", void 0);\n    _defineProperty(this, \"dappStorageKey\", void 0);\n    _defineProperty(this, \"windowRefs\", void 0);\n    _defineProperty(this, \"tryWindowHandle\", void 0);\n    _defineProperty(this, \"torusAlertContainer\", void 0);\n    _defineProperty(this, \"torusIframe\", void 0);\n    this._state = _objectSpread$2({}, TorusCommunicationProvider._defaultState);\n    // public state\n    this.torusUrl = \"\";\n    this.dappStorageKey = \"\";\n    const languageTranslations = configuration.translations[getUserLanguage()];\n    this.embedTranslations = languageTranslations.embed;\n    this.windowRefs = {};\n    // setup own event listeners\n    // EIP-1193 connect\n    this.on(\"connect\", () => {\n      this._state.isConnected = true;\n    });\n    const notificationHandler = payload => {\n      const {\n        method,\n        params\n      } = payload;\n      if (method === COMMUNICATION_NOTIFICATIONS.IFRAME_STATUS) {\n        const {\n          isFullScreen,\n          rid\n        } = params;\n        this._displayIframe({\n          isFull: isFullScreen,\n          rid: rid\n        });\n      } else if (method === COMMUNICATION_NOTIFICATIONS.CREATE_WINDOW) {\n        const {\n          windowId,\n          url\n        } = params;\n        this._createPopupBlockAlert(windowId, url);\n      } else if (method === COMMUNICATION_NOTIFICATIONS.CLOSE_WINDOW) {\n        this._handleCloseWindow(params);\n      } else if (method === COMMUNICATION_NOTIFICATIONS.USER_LOGGED_IN) {\n        const {\n          currentLoginProvider\n        } = params;\n        this._state.isLoggedIn = true;\n        this._state.currentLoginProvider = currentLoginProvider;\n      } else if (method === COMMUNICATION_NOTIFICATIONS.USER_LOGGED_OUT) {\n        this._state.isLoggedIn = false;\n        this._state.currentLoginProvider = null;\n        this._displayIframe();\n      }\n    };\n    this.jsonRpcConnectionEvents.on(\"notification\", notificationHandler);\n  }\n  get isLoggedIn() {\n    return this._state.isLoggedIn;\n  }\n  get isIFrameFullScreen() {\n    return this._state.isIFrameFullScreen;\n  }\n  /**\n   * Returns whether the inPage provider is connected to Torus.\n   */\n  isConnected() {\n    return this._state.isConnected;\n  }\n  async _initializeState(params) {\n    try {\n      const {\n        torusUrl,\n        dappStorageKey,\n        torusAlertContainer,\n        torusIframe\n      } = params;\n      this.torusUrl = torusUrl;\n      this.dappStorageKey = dappStorageKey;\n      this.torusAlertContainer = torusAlertContainer;\n      this.torusIframe = torusIframe;\n      this.torusIframe.addEventListener(\"load\", () => {\n        // only do this if iframe is not full screen\n        if (!this._state.isIFrameFullScreen) this._displayIframe();\n      });\n      const {\n        currentLoginProvider,\n        isLoggedIn\n      } = await this.request({\n        method: COMMUNICATION_JRPC_METHODS.GET_PROVIDER_STATE,\n        params: []\n      });\n      // indicate that we've connected, for EIP-1193 compliance\n      this._handleConnect(currentLoginProvider, isLoggedIn);\n    } catch (error) {\n      log.error(\"Torus: Failed to get initial state. Please report this bug.\", error);\n    } finally {\n      log.info(\"initialized communication state\");\n      this._state.initialized = true;\n      this.emit(\"_initialized\");\n    }\n  }\n  _handleWindow(windowId) {\n    let {\n      url,\n      target,\n      features\n    } = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    const finalUrl = new URL(url || `${this.torusUrl}/redirect?windowId=${windowId}`);\n    if (this.dappStorageKey) {\n      // If multiple instances, it returns the first one\n      if (finalUrl.hash) finalUrl.hash += `&dappStorageKey=${this.dappStorageKey}`;else finalUrl.hash = `#dappStorageKey=${this.dappStorageKey}`;\n    }\n    const handledWindow = new PopupHandler({\n      url: finalUrl,\n      target,\n      features\n    });\n    handledWindow.open();\n    if (!handledWindow.window) {\n      this._createPopupBlockAlert(windowId, finalUrl.href);\n      return;\n    }\n    // Add to collection only if window is opened\n    this.windowRefs[windowId] = handledWindow;\n    // We tell the iframe that the window has been successfully opened\n    this.request({\n      method: COMMUNICATION_JRPC_METHODS.OPENED_WINDOW,\n      params: {\n        windowId\n      }\n    });\n    handledWindow.once(\"close\", () => {\n      // user closed the window\n      delete this.windowRefs[windowId];\n      this.request({\n        method: COMMUNICATION_JRPC_METHODS.CLOSED_WINDOW,\n        params: {\n          windowId\n        }\n      });\n    });\n  }\n  _displayIframe() {\n    let {\n      isFull = false,\n      rid = \"\"\n    } = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    const style = {};\n    // set phase\n    if (!isFull) {\n      style.display = this._state.torusWidgetVisibility ? \"block\" : \"none\";\n      style.height = \"70px\";\n      style.width = \"70px\";\n      switch (this._state.buttonPosition) {\n        case BUTTON_POSITION.TOP_LEFT:\n          style.top = \"0px\";\n          style.left = \"0px\";\n          style.right = \"auto\";\n          style.bottom = \"auto\";\n          break;\n        case BUTTON_POSITION.TOP_RIGHT:\n          style.top = \"0px\";\n          style.right = \"0px\";\n          style.left = \"auto\";\n          style.bottom = \"auto\";\n          break;\n        case BUTTON_POSITION.BOTTOM_RIGHT:\n          style.bottom = \"0px\";\n          style.right = \"0px\";\n          style.top = \"auto\";\n          style.left = \"auto\";\n          break;\n        case BUTTON_POSITION.BOTTOM_LEFT:\n        default:\n          style.bottom = \"0px\";\n          style.left = \"0px\";\n          style.top = \"auto\";\n          style.right = \"auto\";\n          break;\n      }\n    } else {\n      style.display = \"block\";\n      style.width = \"100%\";\n      style.height = \"100%\";\n      style.top = \"0px\";\n      style.right = \"0px\";\n      style.left = \"0px\";\n      style.bottom = \"0px\";\n    }\n    Object.assign(this.torusIframe.style, style);\n    this._state.isIFrameFullScreen = isFull;\n    this.request({\n      method: COMMUNICATION_JRPC_METHODS.IFRAME_STATUS,\n      params: {\n        isIFrameFullScreen: isFull,\n        rid\n      }\n    });\n  }\n  hideTorusButton() {\n    this._state.torusWidgetVisibility = false;\n    this._displayIframe();\n  }\n  showTorusButton() {\n    this._state.torusWidgetVisibility = true;\n    this._displayIframe();\n  }\n  /**\n   * Internal RPC method. Forwards requests to background via the RPC engine.\n   * Also remap ids inbound and outbound\n   */\n  _rpcRequest(payload, callback) {\n    const cb = callback;\n    const _payload = payload;\n    if (!Array.isArray(_payload)) {\n      if (!_payload.jsonrpc) {\n        _payload.jsonrpc = \"2.0\";\n      }\n    }\n    this.tryWindowHandle(_payload, cb);\n  }\n  /**\n   * When the provider becomes connected, updates internal state and emits\n   * required events. Idempotent.\n   *\n   * @param currentLoginProvider - The login Provider\n   * emits TorusInpageProvider#connect\n   */\n  _handleConnect(currentLoginProvider, isLoggedIn) {\n    if (!this._state.isConnected) {\n      this._state.isConnected = true;\n      this.emit(\"connect\", {\n        currentLoginProvider,\n        isLoggedIn\n      });\n      log.debug(messages.info.connected(currentLoginProvider));\n    }\n  }\n  /**\n   * When the provider becomes disconnected, updates internal state and emits\n   * required events. Idempotent with respect to the isRecoverable parameter.\n   *\n   * Error codes per the CloseEvent status codes as required by EIP-1193:\n   * https://developer.mozilla.org/en-US/docs/Web/API/CloseEvent#Status_codes\n   *\n   * @param isRecoverable - Whether the disconnection is recoverable.\n   * @param errorMessage - A custom error message.\n   * emits TorusInpageProvider#disconnect\n   */\n  _handleDisconnect(isRecoverable, errorMessage) {\n    if (this._state.isConnected || !this._state.isPermanentlyDisconnected && !isRecoverable) {\n      this._state.isConnected = false;\n      let error;\n      if (isRecoverable) {\n        error = new EthereumRpcError(1013,\n        // Try again later\n        errorMessage || messages.errors.disconnected());\n        log.debug(error);\n      } else {\n        error = new EthereumRpcError(1011,\n        // Internal error\n        errorMessage || messages.errors.permanentlyDisconnected());\n        log.error(error);\n        this._state.currentLoginProvider = null;\n        this._state.isLoggedIn = false;\n        this._state.torusWidgetVisibility = false;\n        this._state.isIFrameFullScreen = false;\n        this._state.isPermanentlyDisconnected = true;\n      }\n      this.emit(\"disconnect\", error);\n    }\n  }\n  // Called if the iframe wants to close the window cause it is done processing the request\n  _handleCloseWindow(params) {\n    const {\n      windowId\n    } = params;\n    if (this.windowRefs[windowId]) {\n      this.windowRefs[windowId].close();\n      delete this.windowRefs[windowId];\n    }\n  }\n  async _createPopupBlockAlert(windowId, url) {\n    const logoUrl = this.getLogoUrl();\n    const torusAlert = htmlToElement('<div id=\"torusAlert\" class=\"torus-alert--v2\">' + `<div id=\"torusAlert__logo\"><img src=\"${logoUrl}\" /></div>` + \"<div>\" + `<h1 id=\"torusAlert__title\">${this.embedTranslations.actionRequired}</h1>` + `<p id=\"torusAlert__desc\">${this.embedTranslations.pendingAction}</p>` + \"</div>\" + \"</div>\");\n    const successAlert = htmlToElement(`<div><a id=\"torusAlert__btn\">${this.embedTranslations.continue}</a></div>`);\n    const btnContainer = htmlToElement('<div id=\"torusAlert__btn-container\"></div>');\n    btnContainer.appendChild(successAlert);\n    torusAlert.appendChild(btnContainer);\n    const bindOnLoad = () => {\n      successAlert.addEventListener(\"click\", () => {\n        this._handleWindow(windowId, {\n          url,\n          target: \"_blank\",\n          features: getPopupFeatures(FEATURES_CONFIRM_WINDOW)\n        });\n        torusAlert.remove();\n        if (this.torusAlertContainer.children.length === 0) this.torusAlertContainer.style.display = \"none\";\n      });\n    };\n    const attachOnLoad = () => {\n      this.torusAlertContainer.appendChild(torusAlert);\n    };\n    await documentReady();\n    attachOnLoad();\n    bindOnLoad();\n    this.torusAlertContainer.style.display = \"block\";\n  }\n  getLogoUrl() {\n    const logoUrl = `${this.torusUrl}/images/torus_icon-blue.svg`;\n    return logoUrl;\n  }\n}\n_defineProperty(TorusCommunicationProvider, \"_defaultState\", {\n  buttonPosition: \"bottom-left\",\n  currentLoginProvider: null,\n  isIFrameFullScreen: false,\n  hasEmittedConnection: false,\n  torusWidgetVisibility: false,\n  initialized: false,\n  isLoggedIn: false,\n  isPermanentlyDisconnected: false,\n  isConnected: false\n});\n\nfunction ownKeys$1(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\nfunction _objectSpread$1(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys$1(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys$1(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\nclass TorusInPageProvider extends BaseProvider {\n  /**\n   * The chain ID of the currently connected Solana chain.\n   * See [chainId.network]{@link https://chainid.network} for more information.\n   */\n\n  /**\n   * The user's currently selected Solana address.\n   * If null, Torus is either locked or the user has not permitted any\n   * addresses to be viewed.\n   */\n\n  constructor(connectionStream, _ref) {\n    let {\n      maxEventListeners = 100,\n      jsonRpcStreamName = \"provider\"\n    } = _ref;\n    super(connectionStream, {\n      maxEventListeners,\n      jsonRpcStreamName\n    });\n    // private state\n    _defineProperty(this, \"chainId\", void 0);\n    _defineProperty(this, \"selectedAddress\", void 0);\n    _defineProperty(this, \"tryWindowHandle\", void 0);\n    this._state = _objectSpread$1({}, TorusInPageProvider._defaultState);\n    // public state\n    this.selectedAddress = null;\n    this.chainId = null;\n    this._handleAccountsChanged = this._handleAccountsChanged.bind(this);\n    this._handleChainChanged = this._handleChainChanged.bind(this);\n    this._handleUnlockStateChanged = this._handleUnlockStateChanged.bind(this);\n    // setup own event listeners\n    // EIP-1193 connect\n    this.on(\"connect\", () => {\n      this._state.isConnected = true;\n    });\n    const jsonRpcNotificationHandler = payload => {\n      const {\n        method,\n        params\n      } = payload;\n      if (method === PROVIDER_NOTIFICATIONS.ACCOUNTS_CHANGED) {\n        this._handleAccountsChanged(params);\n      } else if (method === PROVIDER_NOTIFICATIONS.UNLOCK_STATE_CHANGED) {\n        this._handleUnlockStateChanged(params);\n      } else if (method === PROVIDER_NOTIFICATIONS.CHAIN_CHANGED) {\n        this._handleChainChanged(params);\n      }\n    };\n    // json rpc notification listener\n    this.jsonRpcConnectionEvents.on(\"notification\", jsonRpcNotificationHandler);\n  }\n  /**\n   * Returns whether the inpage provider is connected to Torus.\n   */\n  isConnected() {\n    return this._state.isConnected;\n  }\n  // Private Methods\n  //= ===================\n  /**\n   * Constructor helper.\n   * Populates initial state by calling 'wallet_getProviderState' and emits\n   * necessary events.\n   */\n  async _initializeState() {\n    try {\n      const {\n        accounts,\n        chainId,\n        isUnlocked\n      } = await this.request({\n        method: PROVIDER_JRPC_METHODS.GET_PROVIDER_STATE,\n        params: []\n      });\n      // indicate that we've connected, for EIP-1193 compliance\n      this.emit(\"connect\", {\n        chainId\n      });\n      this._handleChainChanged({\n        chainId\n      });\n      this._handleUnlockStateChanged({\n        accounts,\n        isUnlocked\n      });\n      this._handleAccountsChanged(accounts);\n    } catch (error) {\n      log.error(\"Torus: Failed to get initial state. Please report this bug.\", error);\n    } finally {\n      log.info(\"initialized provider state\");\n      this._state.initialized = true;\n      this.emit(\"_initialized\");\n    }\n  }\n  /**\n   * Internal RPC method. Forwards requests to background via the RPC engine.\n   * Also remap ids inbound and outbound\n   */\n  _rpcRequest(payload, callback) {\n    let isInternal = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n    let cb = callback;\n    const _payload = payload;\n    if (!Array.isArray(_payload)) {\n      if (!_payload.jsonrpc) {\n        _payload.jsonrpc = \"2.0\";\n      }\n      if (_payload.method === \"solana_accounts\" || _payload.method === \"solana_requestAccounts\") {\n        // handle accounts changing\n        cb = (err, res) => {\n          this._handleAccountsChanged(res.result || [], _payload.method === \"solana_accounts\", isInternal);\n          callback(err, res);\n        };\n      } else if (_payload.method === \"wallet_getProviderState\") {\n        this._rpcEngine.handle(payload, cb);\n        return;\n      }\n    }\n    this.tryWindowHandle(_payload, cb);\n  }\n  /**\n   * When the provider becomes connected, updates internal state and emits\n   * required events. Idempotent.\n   *\n   * @param chainId - The ID of the newly connected chain.\n   * emits TorusInpageProvider#connect\n   */\n  _handleConnect(chainId) {\n    if (!this._state.isConnected) {\n      this._state.isConnected = true;\n      this.emit(\"connect\", {\n        chainId\n      });\n      log.debug(messages.info.connected(chainId));\n    }\n  }\n  /**\n   * When the provider becomes disconnected, updates internal state and emits\n   * required events. Idempotent with respect to the isRecoverable parameter.\n   *\n   * Error codes per the CloseEvent status codes as required by EIP-1193:\n   * https://developer.mozilla.org/en-US/docs/Web/API/CloseEvent#Status_codes\n   *\n   * @param isRecoverable - Whether the disconnection is recoverable.\n   * @param errorMessage - A custom error message.\n   * emits TorusInpageProvider#disconnect\n   */\n  _handleDisconnect(isRecoverable, errorMessage) {\n    if (this._state.isConnected || !this._state.isPermanentlyDisconnected && !isRecoverable) {\n      this._state.isConnected = false;\n      let error;\n      if (isRecoverable) {\n        error = new EthereumRpcError(1013,\n        // Try again later\n        errorMessage || messages.errors.disconnected());\n        log.debug(error);\n      } else {\n        error = new EthereumRpcError(1011,\n        // Internal error\n        errorMessage || messages.errors.permanentlyDisconnected());\n        log.error(error);\n        this.chainId = null;\n        this._state.accounts = null;\n        this.selectedAddress = null;\n        this._state.isUnlocked = false;\n        this._state.isPermanentlyDisconnected = true;\n      }\n      this.emit(\"disconnect\", error);\n    }\n  }\n  /**\n   * Called when accounts may have changed.\n   */\n  _handleAccountsChanged(accounts) {\n    let isEthAccounts = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n    let isInternal = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n    // defensive programming\n    let finalAccounts = accounts;\n    if (!Array.isArray(finalAccounts)) {\n      log.error(\"Torus: Received non-array accounts parameter. Please report this bug.\", finalAccounts);\n      finalAccounts = [];\n    }\n    for (const account of accounts) {\n      if (typeof account !== \"string\") {\n        log.error(\"Torus: Received non-string account. Please report this bug.\", accounts);\n        finalAccounts = [];\n        break;\n      }\n    }\n    // emit accountsChanged if anything about the accounts array has changed\n    if (!dequal(this._state.accounts, finalAccounts)) {\n      // we should always have the correct accounts even before solana_accounts\n      // returns, except in cases where isInternal is true\n      if (isEthAccounts && Array.isArray(this._state.accounts) && this._state.accounts.length > 0 && !isInternal) {\n        log.error('Torus: \"solana_accounts\" unexpectedly updated accounts. Please report this bug.', finalAccounts);\n      }\n      this._state.accounts = finalAccounts;\n      this.emit(\"accountsChanged\", finalAccounts);\n    }\n    // handle selectedAddress\n    if (this.selectedAddress !== finalAccounts[0]) {\n      this.selectedAddress = finalAccounts[0] || null;\n    }\n  }\n  /**\n   * Upon receipt of a new chainId and networkVersion, emits corresponding\n   * events and sets relevant public state.\n   * Does nothing if neither the chainId nor the networkVersion are different\n   * from existing values.\n   *\n   * emits TorusInpageProvider#chainChanged\n   * @param networkInfo - An object with network info.\n   */\n  _handleChainChanged() {\n    let {\n      chainId\n    } = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    if (!chainId) {\n      log.error(\"Torus: Received invalid network parameters. Please report this bug.\", {\n        chainId\n      });\n      return;\n    }\n    if (chainId === \"loading\") {\n      this._handleDisconnect(true);\n    } else {\n      this._handleConnect(chainId);\n      if (chainId !== this.chainId) {\n        this.chainId = chainId;\n        if (this._state.initialized) {\n          this.emit(\"chainChanged\", this.chainId);\n        }\n      }\n    }\n  }\n  /**\n   * Upon receipt of a new isUnlocked state, sets relevant public state.\n   * Calls the accounts changed handler with the received accounts, or an empty\n   * array.\n   *\n   * Does nothing if the received value is equal to the existing value.\n   * There are no lock/unlock events.\n   *\n   * @param opts - Options bag.\n   */\n  _handleUnlockStateChanged() {\n    let {\n      accounts,\n      isUnlocked\n    } = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    if (typeof isUnlocked !== \"boolean\") {\n      log.error(\"Torus: Received invalid isUnlocked parameter. Please report this bug.\", {\n        isUnlocked\n      });\n      return;\n    }\n    if (isUnlocked !== this._state.isUnlocked) {\n      this._state.isUnlocked = isUnlocked;\n      this._handleAccountsChanged(accounts || []);\n    }\n  }\n}\n_defineProperty(TorusInPageProvider, \"_defaultState\", {\n  accounts: null,\n  isConnected: false,\n  isUnlocked: false,\n  initialized: false,\n  isPermanentlyDisconnected: false,\n  hasEmittedConnection: false\n});\n\n/**\n * Returns whether the given image URL exists\n */\nfunction imgExists(url) {\n  return new Promise((resolve, reject) => {\n    try {\n      const img = document.createElement(\"img\");\n      img.onload = () => resolve(true);\n      img.onerror = () => resolve(false);\n      img.src = url;\n    } catch (e) {\n      reject(e);\n    }\n  });\n}\n/**\n * Extracts a name for the site from the DOM\n */\nconst getSiteName = window => {\n  const {\n    document\n  } = window;\n  const siteName = document.querySelector('head > meta[property=\"og:site_name\"]');\n  if (siteName) {\n    return siteName.content;\n  }\n  const metaTitle = document.querySelector('head > meta[name=\"title\"]');\n  if (metaTitle) {\n    return metaTitle.content;\n  }\n  if (document.title && document.title.length > 0) {\n    return document.title;\n  }\n  return window.location.hostname;\n};\n/**\n * Extracts an icon for the site from the DOM\n */\nasync function getSiteIcon(window) {\n  try {\n    const {\n      document\n    } = window;\n    // Use the site's favicon if it exists\n    let icon = document.querySelector('head > link[rel=\"shortcut icon\"]');\n    if (icon && (await imgExists(icon.href))) {\n      return icon.href;\n    }\n    // Search through available icons in no particular order\n    icon = Array.from(document.querySelectorAll('head > link[rel=\"icon\"]')).find(_icon => Boolean(_icon.href));\n    if (icon && (await imgExists(icon.href))) {\n      return icon.href;\n    }\n    return \"\";\n  } catch (error) {\n    return \"\";\n  }\n}\n/**\n * Gets site metadata and returns it\n *\n */\nconst getSiteMetadata = async () => ({\n  name: getSiteName(window),\n  icon: await getSiteIcon(window)\n});\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\nconst PROVIDER_UNSAFE_METHODS = [\"send_transaction\", \"sign_transaction\", \"sign_all_transactions\", \"sign_message\", \"connect\"];\nconst COMMUNICATION_UNSAFE_METHODS = [COMMUNICATION_JRPC_METHODS.SET_PROVIDER];\nconst isLocalStorageAvailable = storageAvailable(\"localStorage\");\n// preload for iframe doesn't work https://bugs.chromium.org/p/chromium/issues/detail?id=593267\n(async function preLoadIframe() {\n  try {\n    if (typeof document === \"undefined\") return;\n    const torusIframeHtml = document.createElement(\"link\");\n    const {\n      torusUrl\n    } = await getTorusUrl(\"production\");\n    torusIframeHtml.href = `${torusUrl}/frame`;\n    torusIframeHtml.crossOrigin = \"anonymous\";\n    torusIframeHtml.type = \"text/html\";\n    torusIframeHtml.rel = \"prefetch\";\n    if (torusIframeHtml.relList && torusIframeHtml.relList.supports) {\n      if (torusIframeHtml.relList.supports(\"prefetch\")) {\n        document.head.appendChild(torusIframeHtml);\n      }\n    }\n  } catch (error) {\n    log.warn(error);\n  }\n})();\nclass Torus {\n  constructor() {\n    let {\n      modalZIndex = 99999\n    } = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    _defineProperty(this, \"isInitialized\", void 0);\n    _defineProperty(this, \"torusAlert\", void 0);\n    _defineProperty(this, \"modalZIndex\", void 0);\n    _defineProperty(this, \"alertZIndex\", void 0);\n    _defineProperty(this, \"requestedLoginProvider\", void 0);\n    _defineProperty(this, \"provider\", void 0);\n    _defineProperty(this, \"communicationProvider\", void 0);\n    _defineProperty(this, \"dappStorageKey\", void 0);\n    _defineProperty(this, \"isTopupHidden\", false);\n    _defineProperty(this, \"torusAlertContainer\", void 0);\n    _defineProperty(this, \"torusUrl\", void 0);\n    _defineProperty(this, \"torusIframe\", void 0);\n    _defineProperty(this, \"styleLink\", void 0);\n    this.torusUrl = \"\";\n    this.isInitialized = false; // init done\n    this.requestedLoginProvider = null;\n    this.modalZIndex = modalZIndex;\n    this.alertZIndex = modalZIndex + 1000;\n    this.dappStorageKey = \"\";\n  }\n  get isLoggedIn() {\n    if (!this.communicationProvider) return false;\n    return this.communicationProvider.isLoggedIn;\n  }\n  async init() {\n    let {\n      buildEnv = TORUS_BUILD_ENV.PRODUCTION,\n      enableLogging = false,\n      network,\n      showTorusButton = false,\n      useLocalStorage = false,\n      buttonPosition = BUTTON_POSITION.BOTTOM_LEFT,\n      apiKey = \"torus-default\",\n      extraParams = {},\n      whiteLabel\n    } = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    if (this.isInitialized) throw new Error(\"Already initialized\");\n    setAPIKey(apiKey);\n    const {\n      torusUrl,\n      logLevel\n    } = await getTorusUrl(buildEnv);\n    log.enableAll();\n    log.info(torusUrl, \"url loaded\");\n    log.info(`Solana Embed Version :${version}`);\n    this.torusUrl = torusUrl;\n    log.setDefaultLevel(logLevel);\n    if (enableLogging) log.enableAll();else log.disableAll();\n    const dappStorageKey = this.handleDappStorageKey(useLocalStorage);\n    const torusIframeUrl = new URL(torusUrl);\n    if (torusIframeUrl.pathname.endsWith(\"/\")) torusIframeUrl.pathname += \"frame\";else torusIframeUrl.pathname += \"/frame\";\n    const hashParams = new URLSearchParams();\n    if (dappStorageKey) hashParams.append(\"dappStorageKey\", dappStorageKey);\n    hashParams.append(\"origin\", window.location.origin);\n    torusIframeUrl.hash = hashParams.toString();\n    // Iframe code\n    this.torusIframe = htmlToElement(`<iframe\n        id=\"torusIframe\"\n        class=\"torusIframe\"\n        src=\"${torusIframeUrl.href}\"\n        style=\"display: none; position: fixed; top: 0; right: 0; width: 100%;\n        height: 100%; border: none; border-radius: 0; z-index: ${this.modalZIndex.toString()}\"\n      ></iframe>`);\n    this.torusAlertContainer = htmlToElement(`<div id=\"torusAlertContainer\" style=\"display:none; z-index: ${this.alertZIndex.toString()}\"></div>`);\n    this.styleLink = htmlToElement(`<link href=\"${torusUrl}/css/widget.css\" rel=\"stylesheet\" type=\"text/css\">`);\n    const handleSetup = async () => {\n      return new Promise((resolve, reject) => {\n        try {\n          window.document.head.appendChild(this.styleLink);\n          window.document.body.appendChild(this.torusIframe);\n          window.document.body.appendChild(this.torusAlertContainer);\n          this.torusIframe.addEventListener(\"load\", async () => {\n            const dappMetadata = await getSiteMetadata();\n            // send init params here\n            this.torusIframe.contentWindow.postMessage({\n              buttonPosition,\n              apiKey,\n              network,\n              dappMetadata,\n              extraParams,\n              whiteLabel\n            }, torusIframeUrl.origin);\n            await this._setupWeb3({\n              torusUrl\n            });\n            if (showTorusButton) this.showTorusButton();\n            if (whiteLabel?.topupHide) this.isTopupHidden = whiteLabel.topupHide;else this.hideTorusButton();\n            this.isInitialized = true;\n            window.torus = this;\n            resolve();\n          });\n        } catch (error) {\n          reject(error);\n        }\n      });\n    };\n    await documentReady();\n    await handleSetup();\n  }\n  async login() {\n    let params = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    if (!this.isInitialized) throw new Error(\"Call init() first\");\n    try {\n      this.requestedLoginProvider = params.loginProvider || null;\n      if (!this.requestedLoginProvider) {\n        this.communicationProvider._displayIframe({\n          isFull: true\n        });\n      }\n      // If user is already logged in, we assume they have given access to the website\n      const res = await new Promise((resolve, reject) => {\n        // We use this method because we want to update inPage provider state with account info\n        this.provider._rpcRequest({\n          method: \"solana_requestAccounts\",\n          params: [this.requestedLoginProvider, params.login_hint]\n        }, getRpcPromiseCallback(resolve, reject));\n      });\n      if (Array.isArray(res) && res.length > 0) {\n        return res;\n      }\n      // This would never happen, but just in case\n      throw new Error(\"Login failed\");\n    } catch (error) {\n      log.error(\"login failed\", error);\n      throw error;\n    } finally {\n      if (this.communicationProvider.isIFrameFullScreen) this.communicationProvider._displayIframe();\n    }\n  }\n  async loginWithPrivateKey(loginParams) {\n    if (!this.isInitialized) throw new Error(\"Call init() first\");\n    const {\n      privateKey,\n      userInfo\n    } = loginParams;\n    const {\n      success\n    } = await this.communicationProvider.request({\n      method: \"login_with_private_key\",\n      params: {\n        privateKey,\n        userInfo\n      }\n    });\n    if (!success) throw new Error(\"Login Failed\");\n  }\n  async logout() {\n    if (!this.communicationProvider.isLoggedIn) throw new Error(\"Not logged in\");\n    await this.communicationProvider.request({\n      method: COMMUNICATION_JRPC_METHODS.LOGOUT,\n      params: []\n    });\n    this.requestedLoginProvider = null;\n  }\n  async cleanUp() {\n    if (this.communicationProvider.isLoggedIn) {\n      await this.logout();\n    }\n    this.clearInit();\n  }\n  clearInit() {\n    function isElement(element) {\n      return element instanceof Element || element instanceof Document;\n    }\n    if (isElement(this.styleLink) && window.document.body.contains(this.styleLink)) {\n      this.styleLink.remove();\n      this.styleLink = undefined;\n    }\n    if (isElement(this.torusIframe) && window.document.body.contains(this.torusIframe)) {\n      this.torusIframe.remove();\n      this.torusIframe = undefined;\n    }\n    if (isElement(this.torusAlertContainer) && window.document.body.contains(this.torusAlertContainer)) {\n      this.torusAlert = undefined;\n      this.torusAlertContainer.remove();\n      this.torusAlertContainer = undefined;\n    }\n    this.isInitialized = false;\n  }\n  hideTorusButton() {\n    this.communicationProvider.hideTorusButton();\n  }\n  showTorusButton() {\n    this.communicationProvider.showTorusButton();\n  }\n  async setProvider(params) {\n    await this.communicationProvider.request({\n      method: COMMUNICATION_JRPC_METHODS.SET_PROVIDER,\n      params: _objectSpread({}, params)\n    });\n  }\n  async showWallet(path) {\n    let params = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    const instanceId = await this.communicationProvider.request({\n      method: COMMUNICATION_JRPC_METHODS.WALLET_INSTANCE_ID,\n      params: []\n    });\n    const finalPath = path ? `/${path}` : \"\";\n    const finalUrl = new URL(`${this.torusUrl}/wallet${finalPath}`);\n    // Using URL constructor to prevent js injection and allow parameter validation.!\n    finalUrl.searchParams.append(\"instanceId\", instanceId);\n    Object.keys(params).forEach(x => {\n      finalUrl.searchParams.append(x, params[x]);\n    });\n    if (this.dappStorageKey) {\n      finalUrl.hash = `#dappStorageKey=${this.dappStorageKey}`;\n    }\n    // No need to track this window state. Hence, no _handleWindow call.\n    const walletWindow = new PopupHandler({\n      url: finalUrl,\n      features: getPopupFeatures(FEATURES_DEFAULT_WALLET_WINDOW)\n    });\n    walletWindow.open();\n  }\n  async getUserInfo() {\n    const userInfoResponse = await this.communicationProvider.request({\n      method: COMMUNICATION_JRPC_METHODS.USER_INFO,\n      params: []\n    });\n    return userInfoResponse;\n  }\n  async initiateTopup(provider, params) {\n    if (!this.isInitialized) throw new Error(\"Torus is not initialized\");\n    const windowId = getWindowId();\n    this.communicationProvider._handleWindow(windowId);\n    const topupResponse = await this.communicationProvider.request({\n      method: COMMUNICATION_JRPC_METHODS.TOPUP,\n      params: {\n        provider,\n        params,\n        windowId\n      }\n    });\n    return topupResponse;\n  }\n  // Solana specific API\n  async getAccounts() {\n    const response = await this.provider.request({\n      method: \"getAccounts\",\n      params: []\n    });\n    return response;\n  }\n  async sendTransaction(transaction) {\n    const isLegacyTransaction = isLegacyTransactionInstance(transaction);\n    const message = isLegacyTransaction ? transaction.serialize({\n      requireAllSignatures: false\n    }).toString(\"hex\") : Buffer.from(transaction.serialize()).toString(\"hex\");\n    const response = await this.provider.request({\n      method: \"send_transaction\",\n      params: {\n        message,\n        isLegacyTransaction\n      }\n    });\n    return response;\n  }\n  // support sendOptions\n  async signAndSendTransaction(transaction, options) {\n    const isLegacyTransaction = isLegacyTransactionInstance(transaction);\n    const message = isLegacyTransaction ? transaction.serialize({\n      requireAllSignatures: false\n    }).toString(\"hex\") : Buffer.from(transaction.serialize()).toString(\"hex\");\n    const response = await this.provider.request({\n      method: \"send_transaction\",\n      params: {\n        message,\n        options,\n        isLegacyTransaction\n      }\n    });\n    return {\n      signature: response\n    };\n  }\n  async signTransaction(transaction) {\n    const isLegacyTransaction = isLegacyTransactionInstance(transaction);\n    const message = isLegacyTransaction ? transaction.serializeMessage().toString(\"hex\") : Buffer.from(transaction.message.serialize()).toString(\"hex\");\n    const response = await this.provider.request({\n      method: \"sign_transaction\",\n      params: {\n        message,\n        messageOnly: true,\n        isLegacyTransaction\n      }\n    });\n    // reconstruct signature pair\n    const parsed = JSON.parse(response);\n    const signature = {\n      publicKey: new PublicKey(parsed.publicKey),\n      signature: Buffer.from(parsed.signature, \"hex\")\n    };\n    transaction.addSignature(signature.publicKey, signature.signature);\n    return transaction;\n  }\n  async signAllTransactions(transactions) {\n    let isLegacyTransaction;\n    const encodedMessage = transactions.map(tx => {\n      isLegacyTransaction = isLegacyTransactionInstance(tx);\n      return isLegacyTransaction ? tx.serializeMessage().toString(\"hex\") : Buffer.from(tx.message.serialize()).toString(\"hex\");\n    });\n    const responses = await this.provider.request({\n      method: \"sign_all_transactions\",\n      params: {\n        message: encodedMessage,\n        messageOnly: true,\n        isLegacyTransaction\n      }\n    });\n    // reconstruct signature pairs\n    const signatures = responses.map(item => {\n      const parsed = JSON.parse(item);\n      return {\n        publicKey: new PublicKey(parsed.publicKey),\n        signature: Buffer.from(parsed.signature, \"hex\")\n      };\n    });\n    transactions.forEach((tx, idx) => {\n      tx.addSignature(signatures[idx].publicKey, signatures[idx].signature);\n      return tx;\n    });\n    return transactions;\n  }\n  async signMessage(data) {\n    const response = await this.provider.request({\n      method: \"sign_message\",\n      params: {\n        data\n      }\n    });\n    return response;\n  }\n  async getGaslessPublicKey() {\n    const response = await this.provider.request({\n      method: \"get_gasless_public_key\",\n      params: []\n    });\n    return response;\n  }\n  // async connect(): Promise<boolean> {\n  //   const response = (await this.provider.request({\n  //     method: \"connect\",\n  //     params: {},\n  //   })) as boolean;\n  //   return response;\n  // }\n  handleDappStorageKey(useLocalStorage) {\n    const localStorageKey = `${configuration.localStorageKeyPrefix}${window.location.hostname}`;\n    let dappStorageKey = \"\";\n    if (isLocalStorageAvailable && useLocalStorage) {\n      const storedKey = window.localStorage.getItem(localStorageKey);\n      if (storedKey) dappStorageKey = storedKey;else {\n        const generatedKey = `torus-app-${getWindowId()}`;\n        window.localStorage.setItem(localStorageKey, generatedKey);\n        dappStorageKey = generatedKey;\n      }\n    }\n    this.dappStorageKey = dappStorageKey;\n    return dappStorageKey;\n  }\n  async _setupWeb3(providerParams) {\n    log.info(\"setupWeb3 running\");\n    // setup background connection\n    const providerStream = new BasePostMessageStream({\n      name: \"embed_torus\",\n      target: \"iframe_torus\",\n      targetWindow: this.torusIframe.contentWindow\n    });\n    // We create another LocalMessageDuplexStream for communication between dapp <> iframe\n    const communicationStream = new BasePostMessageStream({\n      name: \"embed_communication\",\n      target: \"iframe_communication\",\n      targetWindow: this.torusIframe.contentWindow\n    });\n    // compose the inPage provider\n    const inPageProvider = new TorusInPageProvider(providerStream, {});\n    const communicationProvider = new TorusCommunicationProvider(communicationStream, {});\n    inPageProvider.tryWindowHandle = (payload, cb) => {\n      const _payload = payload;\n      if (!Array.isArray(_payload) && PROVIDER_UNSAFE_METHODS.includes(_payload.method)) {\n        if (!this.communicationProvider.isLoggedIn) throw new Error(\"User Not Logged In\");\n        const windowId = getWindowId();\n        communicationProvider._handleWindow(windowId, {\n          target: \"_blank\",\n          features: getPopupFeatures(FEATURES_CONFIRM_WINDOW)\n        });\n        // for inPageProvider methods sending windowId in request instead of params\n        // as params might be positional.\n        _payload.windowId = windowId;\n      }\n      inPageProvider._rpcEngine.handle(_payload, cb);\n    };\n    communicationProvider.tryWindowHandle = (payload, cb) => {\n      const _payload = payload;\n      if (!Array.isArray(_payload) && COMMUNICATION_UNSAFE_METHODS.includes(_payload.method)) {\n        const windowId = getWindowId();\n        communicationProvider._handleWindow(windowId, {\n          target: \"_blank\",\n          features: getPopupFeatures(FEATURES_PROVIDER_CHANGE_WINDOW) // todo: are these features generic for all\n        });\n        // for communication methods sending window id in jrpc req params\n        _payload.params.windowId = windowId;\n      }\n      communicationProvider._rpcEngine.handle(_payload, cb);\n    };\n    // detect solana_requestAccounts and pipe to enable for now\n    const detectAccountRequestPrototypeModifier = m => {\n      const originalMethod = inPageProvider[m];\n      // eslint-disable-next-line @typescript-eslint/no-this-alias\n      const self = this;\n      inPageProvider[m] = function providerFunc(request, cb) {\n        const {\n          method,\n          params = []\n        } = request;\n        if (method === \"solana_requestAccounts\") {\n          if (!cb) return self.login({\n            loginProvider: params[0]\n          });\n          self.login({\n            loginProvider: params[0]\n          })\n          // eslint-disable-next-line promise/no-callback-in-promise\n          .then(res => cb(null, res))\n          // eslint-disable-next-line promise/no-callback-in-promise\n          .catch(err => cb(err));\n        }\n        return originalMethod.apply(this, [request, cb]);\n      };\n    };\n    // Detects call to solana_requestAccounts in request & sendAsync and passes to login\n    detectAccountRequestPrototypeModifier(\"request\");\n    detectAccountRequestPrototypeModifier(\"sendAsync\");\n    detectAccountRequestPrototypeModifier(\"send\");\n    const proxiedInPageProvider = new Proxy(inPageProvider, {\n      // straight up lie that we deleted the property so that it doesn't\n      // throw an error in strict mode\n      deleteProperty: () => true\n    });\n    const proxiedCommunicationProvider = new Proxy(communicationProvider, {\n      // straight up lie that we deleted the property so that it doesn't\n      // throw an error in strict mode\n      deleteProperty: () => true\n    });\n    this.provider = proxiedInPageProvider;\n    this.communicationProvider = proxiedCommunicationProvider;\n    await Promise.all([inPageProvider._initializeState(), communicationProvider._initializeState(_objectSpread(_objectSpread({}, providerParams), {}, {\n      dappStorageKey: this.dappStorageKey,\n      torusAlertContainer: this.torusAlertContainer,\n      torusIframe: this.torusIframe\n    }))]);\n    log.debug(\"Torus - injected provider\");\n  }\n}\n\nexport { BUTTON_POSITION, LOGIN_PROVIDER, PAYMENT_PROVIDER, TORUS_BUILD_ENV, TorusInPageProvider, Torus as default };\n//# sourceMappingURL=solanaEmbed.esm.js.map\n",null,null,null,null,null,null,null,null,null,null,null,"import _defineProperty from '@babel/runtime/helpers/defineProperty';\nimport { Duplex } from 'readable-stream';\nimport { randomId } from '@toruslabs/openlogin-utils';\nimport { EventEmitter } from 'events';\nimport stringify from 'fast-safe-stringify';\nimport { serializeError } from 'eth-rpc-errors';\nimport eos from 'end-of-stream';\nimport once from 'once';\nimport pump from 'pump';\n\nfunction noop() {\n  return undefined;\n}\nconst SYN = \"SYN\";\nconst ACK = \"ACK\";\nconst BRK = \"BRK\";\nclass BasePostMessageStream extends Duplex {\n  constructor(_ref) {\n    let {\n      name,\n      target,\n      targetWindow = window,\n      targetOrigin = \"*\"\n    } = _ref;\n    super({\n      objectMode: true\n    });\n    _defineProperty(this, \"_init\", void 0);\n    _defineProperty(this, \"_haveSyn\", void 0);\n    _defineProperty(this, \"_name\", void 0);\n    _defineProperty(this, \"_target\", void 0);\n    _defineProperty(this, \"_targetWindow\", void 0);\n    _defineProperty(this, \"_targetOrigin\", void 0);\n    _defineProperty(this, \"_onMessage\", void 0);\n    _defineProperty(this, \"_synIntervalId\", void 0);\n    if (!name || !target) {\n      throw new Error(\"Invalid input.\");\n    }\n    this._init = false;\n    this._haveSyn = false;\n    this._name = name;\n    this._target = target; // target origin\n    this._targetWindow = targetWindow;\n    this._targetOrigin = targetOrigin;\n    this._onMessage = this.onMessage.bind(this);\n    this._synIntervalId = null;\n    window.addEventListener(\"message\", this._onMessage, false);\n    this._handShake();\n  }\n  _break() {\n    this.cork();\n    this._write(BRK, null, noop);\n    this._haveSyn = false;\n    this._init = false;\n  }\n  _handShake() {\n    this._write(SYN, null, noop);\n    this.cork();\n  }\n  _onData(data) {\n    if (!this._init) {\n      // listen for handshake\n      if (data === SYN) {\n        this._haveSyn = true;\n        this._write(ACK, null, noop);\n      } else if (data === ACK) {\n        this._init = true;\n        if (!this._haveSyn) {\n          this._write(ACK, null, noop);\n        }\n        this.uncork();\n      }\n    } else if (data === BRK) {\n      this._break();\n    } else {\n      // forward message\n      try {\n        this.push(data);\n      } catch (err) {\n        this.emit(\"error\", err);\n      }\n    }\n  }\n  _postMessage(data) {\n    const originConstraint = this._targetOrigin;\n    this._targetWindow.postMessage({\n      target: this._target,\n      data\n    }, originConstraint);\n  }\n  onMessage(event) {\n    const message = event.data;\n    // validate message\n    if (this._targetOrigin !== \"*\" && event.origin !== this._targetOrigin || event.source !== this._targetWindow || typeof message !== \"object\" || message.target !== this._name || !message.data) {\n      return;\n    }\n    this._onData(message.data);\n  }\n  _read() {\n    return undefined;\n  }\n  _write(data, _, cb) {\n    this._postMessage(data);\n    cb();\n  }\n  _destroy() {\n    window.removeEventListener(\"message\", this._onMessage, false);\n  }\n}\n\nfunction safeApply(handler, context, args) {\n  try {\n    Reflect.apply(handler, context, args);\n  } catch (err) {\n    // Throw error after timeout so as not to interrupt the stack\n    setTimeout(() => {\n      throw err;\n    });\n  }\n}\nfunction arrayClone(arr) {\n  const n = arr.length;\n  const copy = new Array(n);\n  for (let i = 0; i < n; i += 1) {\n    copy[i] = arr[i];\n  }\n  return copy;\n}\nclass SafeEventEmitter extends EventEmitter {\n  emit(type) {\n    let doError = type === \"error\";\n    const events = this._events;\n    if (events !== undefined) {\n      doError = doError && events.error === undefined;\n    } else if (!doError) {\n      return false;\n    }\n    // If there is no 'error' event listener then throw.\n    for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n      args[_key - 1] = arguments[_key];\n    }\n    if (doError) {\n      let er;\n      if (args.length > 0) {\n        [er] = args;\n      }\n      if (er instanceof Error) {\n        // Note: The comments on the `throw` lines are intentional, they show\n        // up in Node's output if this results in an unhandled exception.\n        throw er; // Unhandled 'error' event\n      }\n      // At least give some kind of context to the user\n      const err = new Error(`Unhandled error.${er ? ` (${er.message})` : \"\"}`);\n      err.context = er;\n      throw err; // Unhandled 'error' event\n    }\n\n    const handler = events[type];\n    if (handler === undefined) {\n      return false;\n    }\n    if (typeof handler === \"function\") {\n      safeApply(handler, this, args);\n    } else {\n      const len = handler.length;\n      const listeners = arrayClone(handler);\n      for (let i = 0; i < len; i += 1) {\n        safeApply(listeners[i], this, args);\n      }\n    }\n    return true;\n  }\n}\n\nclass SerializableError extends Error {\n  constructor(_ref) {\n    let {\n      code,\n      message,\n      data\n    } = _ref;\n    if (!Number.isInteger(code)) {\n      throw new Error(\"code must be an integer\");\n    }\n    if (!message || typeof message !== \"string\") {\n      throw new Error(\"message must be string\");\n    }\n    super(message);\n    _defineProperty(this, \"code\", void 0);\n    _defineProperty(this, \"data\", void 0);\n    this.code = code;\n    if (data !== undefined) {\n      this.data = data;\n    }\n  }\n  toString() {\n    return stringify({\n      code: this.code,\n      message: this.message,\n      data: this.data,\n      stack: this.stack\n    });\n  }\n}\n\nconst getRpcPromiseCallback = function (resolve, reject) {\n  let unwrapResult = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;\n  return (error, response) => {\n    if (error || response.error) {\n      reject(error || response.error);\n    } else if (!unwrapResult || Array.isArray(response)) {\n      resolve(response);\n    } else {\n      resolve(response.result);\n    }\n  };\n};\nfunction createErrorMiddleware(log) {\n  return (req, res, next, end) => {\n    try {\n      // json-rpc-engine will terminate the request when it notices this error\n      if (typeof req.method !== \"string\" || !req.method) {\n        res.error = new SerializableError({\n          code: -32603,\n          message: \"invalid method\"\n        });\n        end();\n        return;\n      }\n      next(done => {\n        const {\n          error\n        } = res;\n        if (!error) {\n          return done();\n        }\n        log.error(`OpenLogin - RPC Error: ${error.message}`, error);\n        return done();\n      });\n    } catch (error) {\n      log.error(`OpenLogin - RPC Error thrown: ${error.message}`, error);\n      res.error = new SerializableError({\n        code: -32603,\n        message: error.message\n      });\n      end();\n    }\n  };\n}\nfunction createStreamMiddleware() {\n  const idMap = {};\n  function readNoop() {\n    return false;\n  }\n  const events = new SafeEventEmitter();\n  function processResponse(res) {\n    const context = idMap[res.id];\n    if (!context) {\n      throw new Error(`StreamMiddleware - Unknown response id \"${res.id}\"`);\n    }\n    delete idMap[res.id];\n    // copy whole res onto original res\n    Object.assign(context.res, res);\n    // run callback on empty stack,\n    // prevent internal stream-handler from catching errors\n    setTimeout(context.end);\n  }\n  function processNotification(res) {\n    events.emit(\"notification\", res);\n  }\n  function processMessage(res, _encoding, cb) {\n    let err;\n    try {\n      const isNotification = !res.id;\n      if (isNotification) {\n        processNotification(res);\n      } else {\n        processResponse(res);\n      }\n    } catch (_err) {\n      err = _err;\n    }\n    // continue processing stream\n    cb(err);\n  }\n  const stream = new Duplex({\n    objectMode: true,\n    read: readNoop,\n    write: processMessage\n  });\n  const middleware = (req, res, next, end) => {\n    // write req to stream\n    stream.push(req);\n    // register request on id map\n    idMap[req.id] = {\n      req,\n      res,\n      next,\n      end\n    };\n  };\n  return {\n    events,\n    middleware,\n    stream\n  };\n}\nfunction createScaffoldMiddleware(handlers) {\n  return (req, res, next, end) => {\n    const handler = handlers[req.method];\n    // if no handler, return\n    if (handler === undefined) {\n      return next();\n    }\n    // if handler is fn, call as middleware\n    if (typeof handler === \"function\") {\n      return handler(req, res, next, end);\n    }\n    // if handler is some other value, use as result\n    res.result = handler;\n    return end();\n  };\n}\nfunction createIdRemapMiddleware() {\n  return (req, res, next, _end) => {\n    const originalId = req.id;\n    const newId = randomId();\n    req.id = newId;\n    res.id = newId;\n    next(done => {\n      req.id = originalId;\n      res.id = originalId;\n      done();\n    });\n  };\n}\nfunction createLoggerMiddleware(logger) {\n  return (req, res, next, _) => {\n    logger.debug(\"REQ\", req, \"RES\", res);\n    next();\n  };\n}\nfunction createAsyncMiddleware(asyncMiddleware) {\n  return async (req, res, next, end) => {\n    // nextPromise is the key to the implementation\n    // it is resolved by the return handler passed to the\n    // \"next\" function\n    let resolveNextPromise;\n    const nextPromise = new Promise(resolve => {\n      resolveNextPromise = resolve;\n    });\n    let returnHandlerCallback = null;\n    let nextWasCalled = false;\n    // This will be called by the consumer's async middleware.\n    const asyncNext = async () => {\n      nextWasCalled = true;\n      // We pass a return handler to next(). When it is called by the engine,\n      // the consumer's async middleware will resume executing.\n      next(runReturnHandlersCallback => {\n        // This callback comes from JRPCEngine._runReturnHandlers\n        returnHandlerCallback = runReturnHandlersCallback;\n        resolveNextPromise();\n      });\n      await nextPromise;\n    };\n    try {\n      await asyncMiddleware(req, res, asyncNext);\n      if (nextWasCalled) {\n        await nextPromise; // we must wait until the return handler is called\n        returnHandlerCallback(null);\n      } else {\n        end(null);\n      }\n    } catch (error) {\n      if (returnHandlerCallback) {\n        returnHandlerCallback(error);\n      } else {\n        end(error);\n      }\n    }\n  };\n}\n\nfunction ownKeys$1(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\nfunction _objectSpread$1(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys$1(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys$1(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\n/**\n * A JSON-RPC request and response processor.\n * Give it a stack of middleware, pass it requests, and get back responses.\n */\nclass JRPCEngine extends SafeEventEmitter {\n  constructor() {\n    super();\n    _defineProperty(this, \"_middleware\", void 0);\n    this._middleware = [];\n  }\n  /**\n   * Serially executes the given stack of middleware.\n   *\n   * @returns An array of any error encountered during middleware execution,\n   * a boolean indicating whether the request was completed, and an array of\n   * middleware-defined return handlers.\n   */\n  static async _runAllMiddleware(req, res, middlewareStack) {\n    const returnHandlers = [];\n    let error = null;\n    let isComplete = false;\n    // Go down stack of middleware, call and collect optional returnHandlers\n    for (const middleware of middlewareStack) {\n      [error, isComplete] = await JRPCEngine._runMiddleware(req, res, middleware, returnHandlers);\n      if (isComplete) {\n        break;\n      }\n    }\n    return [error, isComplete, returnHandlers.reverse()];\n  }\n  /**\n   * Runs an individual middleware.\n   *\n   * @returns An array of any error encountered during middleware exection,\n   * and a boolean indicating whether the request should end.\n   */\n  static _runMiddleware(req, res, middleware, returnHandlers) {\n    return new Promise(resolve => {\n      const end = err => {\n        const error = err || res.error;\n        if (error) {\n          res.error = serializeError(error);\n        }\n        // True indicates that the request should end\n        resolve([error, true]);\n      };\n      const next = returnHandler => {\n        if (res.error) {\n          end(res.error);\n        } else {\n          if (returnHandler) {\n            if (typeof returnHandler !== \"function\") {\n              end(new SerializableError({\n                code: -32603,\n                message: \"JRPCEngine: 'next' return handlers must be functions\"\n              }));\n            }\n            returnHandlers.push(returnHandler);\n          }\n          // False indicates that the request should not end\n          resolve([null, false]);\n        }\n      };\n      try {\n        middleware(req, res, next, end);\n      } catch (error) {\n        end(error);\n      }\n    });\n  }\n  /**\n   * Serially executes array of return handlers. The request and response are\n   * assumed to be in their scope.\n   */\n  static async _runReturnHandlers(handlers) {\n    for (const handler of handlers) {\n      await new Promise((resolve, reject) => {\n        handler(err => err ? reject(err) : resolve());\n      });\n    }\n  }\n  /**\n   * Throws an error if the response has neither a result nor an error, or if\n   * the \"isComplete\" flag is falsy.\n   */\n  static _checkForCompletion(req, res, isComplete) {\n    if (!(\"result\" in res) && !(\"error\" in res)) {\n      throw new SerializableError({\n        code: -32603,\n        message: \"Response has no error or result for request\"\n      });\n    }\n    if (!isComplete) {\n      throw new SerializableError({\n        code: -32603,\n        message: \"Nothing ended request\"\n      });\n    }\n  }\n  /**\n   * Add a middleware function to the engine's middleware stack.\n   *\n   * @param middleware - The middleware function to add.\n   */\n  push(middleware) {\n    this._middleware.push(middleware);\n  }\n  handle(req, cb) {\n    if (cb && typeof cb !== \"function\") {\n      throw new Error('\"callback\" must be a function if provided.');\n    }\n    if (Array.isArray(req)) {\n      if (cb) {\n        return this._handleBatch(req, cb);\n      }\n      return this._handleBatch(req);\n    }\n    if (cb) {\n      return this._handle(req, cb);\n    }\n    return this._promiseHandle(req);\n  }\n  /**\n   * Returns this engine as a middleware function that can be pushed to other\n   * engines.\n   *\n   * @returns This engine as a middleware function.\n   */\n  asMiddleware() {\n    return async (req, res, next, end) => {\n      try {\n        const [middlewareError, isComplete, returnHandlers] = await JRPCEngine._runAllMiddleware(req, res, this._middleware);\n        if (isComplete) {\n          await JRPCEngine._runReturnHandlers(returnHandlers);\n          return end(middlewareError);\n        }\n        return next(async handlerCallback => {\n          try {\n            await JRPCEngine._runReturnHandlers(returnHandlers);\n          } catch (error) {\n            return handlerCallback(error);\n          }\n          return handlerCallback();\n        });\n      } catch (error) {\n        return end(error);\n      }\n    };\n  }\n  async _handleBatch(reqs, cb) {\n    // The order here is important\n    try {\n      // 2. Wait for all requests to finish, or throw on some kind of fatal\n      // error\n      const responses = await Promise.all(\n      // 1. Begin executing each request in the order received\n      reqs.map(this._promiseHandle.bind(this)));\n      // 3. Return batch response\n      if (cb) {\n        return cb(null, responses);\n      }\n      return responses;\n    } catch (error) {\n      if (cb) {\n        return cb(error);\n      }\n      throw error;\n    }\n  }\n  /**\n   * A promise-wrapped _handle.\n   */\n  _promiseHandle(req) {\n    return new Promise(resolve => {\n      this._handle(req, (_err, res) => {\n        // There will always be a response, and it will always have any error\n        // that is caught and propagated.\n        resolve(res);\n      });\n    });\n  }\n  /**\n   * Ensures that the request object is valid, processes it, and passes any\n   * error and the response object to the given callback.\n   *\n   * Does not reject.\n   */\n  async _handle(callerReq, cb) {\n    if (!callerReq || Array.isArray(callerReq) || typeof callerReq !== \"object\") {\n      const error = new SerializableError({\n        code: -32603,\n        message: \"request must be plain object\"\n      });\n      return cb(error, {\n        id: undefined,\n        jsonrpc: \"2.0\",\n        error\n      });\n    }\n    if (typeof callerReq.method !== \"string\") {\n      const error = new SerializableError({\n        code: -32603,\n        message: \"method must be string\"\n      });\n      return cb(error, {\n        id: callerReq.id,\n        jsonrpc: \"2.0\",\n        error\n      });\n    }\n    const req = _objectSpread$1({}, callerReq);\n    const res = {\n      id: req.id,\n      jsonrpc: req.jsonrpc\n    };\n    let error = null;\n    try {\n      await this._processRequest(req, res);\n    } catch (_error) {\n      // A request handler error, a re-thrown middleware error, or something\n      // unexpected.\n      error = _error;\n    }\n    if (error) {\n      // Ensure no result is present on an errored response\n      delete res.result;\n      if (!res.error) {\n        res.error = serializeError(error);\n      }\n    }\n    return cb(error, res);\n  }\n  /**\n   * For the given request and response, runs all middleware and their return\n   * handlers, if any, and ensures that internal request processing semantics\n   * are satisfied.\n   */\n  async _processRequest(req, res) {\n    const [error, isComplete, returnHandlers] = await JRPCEngine._runAllMiddleware(req, res, this._middleware);\n    // Throw if \"end\" was not called, or if the response has neither a result\n    // nor an error.\n    JRPCEngine._checkForCompletion(req, res, isComplete);\n    // The return handlers should run even if an error was encountered during\n    // middleware processing.\n    await JRPCEngine._runReturnHandlers(returnHandlers);\n    // Now we re-throw the middleware processing error, if any, to catch it\n    // further up the call chain.\n    if (error) {\n      throw error;\n    }\n  }\n}\nfunction mergeMiddleware(middlewareStack) {\n  const engine = new JRPCEngine();\n  middlewareStack.forEach(middleware => engine.push(middleware));\n  return engine.asMiddleware();\n}\nfunction createEngineStream(opts) {\n  if (!opts || !opts.engine) {\n    throw new Error(\"Missing engine parameter!\");\n  }\n  const {\n    engine\n  } = opts;\n  // eslint-disable-next-line prefer-const\n  let stream;\n  function read() {\n    return undefined;\n  }\n  function write(req, _encoding, cb) {\n    engine.handle(req, (_err, res) => {\n      stream.push(res);\n    });\n    cb();\n  }\n  stream = new Duplex({\n    objectMode: true,\n    read,\n    write\n  });\n  // forward notifications\n  if (engine.on) {\n    engine.on(\"notification\", message => {\n      stream.push(message);\n    });\n  }\n  return stream;\n}\n\nclass Substream extends Duplex {\n  constructor(_ref) {\n    let {\n      parent,\n      name\n    } = _ref;\n    super({\n      objectMode: true\n    });\n    _defineProperty(this, \"_parent\", void 0);\n    _defineProperty(this, \"_name\", void 0);\n    this._parent = parent;\n    this._name = name;\n  }\n  /**\n   * Explicitly sets read operations to a no-op.\n   */\n  _read() {\n    return undefined;\n  }\n  /**\n   * Called when data should be written to this writable stream.\n   *\n   * @param chunk - Arbitrary object to write\n   * @param encoding - Encoding to use when writing payload\n   * @param callback - Called when writing is complete or an error occurs\n   */\n  _write(chunk, _encoding, callback) {\n    this._parent.push({\n      name: this._name,\n      data: chunk\n    });\n    callback();\n  }\n}\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\nconst IGNORE_SUBSTREAM = Symbol(\"IGNORE_SUBSTREAM\");\nclass ObjectMultiplex extends Duplex {\n  constructor() {\n    let opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    super(_objectSpread(_objectSpread({}, opts), {}, {\n      objectMode: true\n    }));\n    _defineProperty(this, \"_substreams\", void 0);\n    _defineProperty(this, \"getStream\", void 0);\n    this._substreams = {};\n  }\n  createStream(name) {\n    // validate name\n    if (!name) {\n      throw new Error(\"ObjectMultiplex - name must not be empty\");\n    }\n    if (this._substreams[name]) {\n      throw new Error(`ObjectMultiplex - Substream for name \"${name}\" already exists`);\n    }\n    // create substream\n    const substream = new Substream({\n      parent: this,\n      name\n    });\n    this._substreams[name] = substream;\n    // listen for parent stream to end\n    // eslint-disable-next-line @typescript-eslint/no-use-before-define\n    anyStreamEnd(this, _error => substream.destroy(_error || undefined));\n    return substream;\n  }\n  // ignore streams (dont display orphaned data warning)\n  ignoreStream(name) {\n    // validate name\n    if (!name) {\n      throw new Error(\"ObjectMultiplex - name must not be empty\");\n    }\n    if (this._substreams[name]) {\n      throw new Error(`ObjectMultiplex - Substream for name \"${name}\" already exists`);\n    }\n    // set\n    this._substreams[name] = IGNORE_SUBSTREAM;\n  }\n  _read() {\n    return undefined;\n  }\n  _write(chunk, _encoding, callback) {\n    const {\n      name,\n      data\n    } = chunk;\n    if (!name) {\n      window.console.warn(`ObjectMultiplex - malformed chunk without name \"${chunk}\"`);\n      return callback();\n    }\n    // get corresponding substream\n    const substream = this._substreams[name];\n    if (!substream) {\n      window.console.warn(`ObjectMultiplex - orphaned data for stream \"${name}\"`);\n      return callback();\n    }\n    // push data into substream\n    if (substream !== IGNORE_SUBSTREAM) {\n      substream.push(data);\n    }\n    return callback();\n  }\n}\n// util\nfunction anyStreamEnd(stream, _cb) {\n  const cb = once(_cb);\n  eos(stream, {\n    readable: false\n  }, cb);\n  eos(stream, {\n    writable: false\n  }, cb);\n}\nfunction setupMultiplex(stream) {\n  const mux = new ObjectMultiplex();\n  mux.getStream = function streamHelper(name) {\n    if (this._substreams[name]) {\n      return this._substreams[name];\n    }\n    return this.createStream(name);\n  };\n  pump(stream, mux, stream, err => {\n    if (err) window.console.error(err);\n  });\n  return mux;\n}\n\nclass PostMessageStream extends BasePostMessageStream {\n  _postMessage(data) {\n    let originConstraint = this._targetOrigin;\n    if (typeof data === \"object\") {\n      const dataObj = data;\n      if (typeof dataObj.data === \"object\") {\n        const dataObjData = dataObj.data;\n        if (Array.isArray(dataObjData.params) && dataObjData.params.length > 0) {\n          const dataObjDataParam = dataObjData.params[0];\n          if (dataObjDataParam._origin) {\n            originConstraint = dataObjDataParam._origin;\n          }\n          // add a constraint for the response\n          dataObjDataParam._origin = window.location.origin;\n        }\n      }\n    }\n    this._targetWindow.postMessage({\n      target: this._target,\n      data\n    }, originConstraint);\n  }\n}\n\nexport { BasePostMessageStream, IGNORE_SUBSTREAM, JRPCEngine, ObjectMultiplex, PostMessageStream, SafeEventEmitter, SerializableError, Substream, createAsyncMiddleware, createEngineStream, createErrorMiddleware, createIdRemapMiddleware, createLoggerMiddleware, createScaffoldMiddleware, createStreamMiddleware, getRpcPromiseCallback, mergeMiddleware, setupMultiplex };\n//# sourceMappingURL=openloginJrpc.esm.js.map\n",null,null,null,null,null,null,"exports = module.exports = require('./lib/_stream_readable.js');\nexports.Stream = exports;\nexports.Readable = exports;\nexports.Writable = require('./lib/_stream_writable.js');\nexports.Duplex = require('./lib/_stream_duplex.js');\nexports.Transform = require('./lib/_stream_transform.js');\nexports.PassThrough = require('./lib/_stream_passthrough.js');\nexports.finished = require('./lib/internal/streams/end-of-stream.js');\nexports.pipeline = require('./lib/internal/streams/pipeline.js');\n","'use strict';\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\nfunction _defineProperty(obj, key, value) { key = _toPropertyKey(key); if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\nfunction _toPropertyKey(arg) { var key = _toPrimitive(arg, \"string\"); return typeof key === \"symbol\" ? key : String(key); }\nfunction _toPrimitive(input, hint) { if (typeof input !== \"object\" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || \"default\"); if (typeof res !== \"object\") return res; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (hint === \"string\" ? String : Number)(input); }\nvar _require = require('buffer'),\n  Buffer = _require.Buffer;\nvar _require2 = require('util'),\n  inspect = _require2.inspect;\nvar custom = inspect && inspect.custom || 'inspect';\nfunction copyBuffer(src, target, offset) {\n  Buffer.prototype.copy.call(src, target, offset);\n}\nmodule.exports = /*#__PURE__*/function () {\n  function BufferList() {\n    _classCallCheck(this, BufferList);\n    this.head = null;\n    this.tail = null;\n    this.length = 0;\n  }\n  _createClass(BufferList, [{\n    key: \"push\",\n    value: function push(v) {\n      var entry = {\n        data: v,\n        next: null\n      };\n      if (this.length > 0) this.tail.next = entry;else this.head = entry;\n      this.tail = entry;\n      ++this.length;\n    }\n  }, {\n    key: \"unshift\",\n    value: function unshift(v) {\n      var entry = {\n        data: v,\n        next: this.head\n      };\n      if (this.length === 0) this.tail = entry;\n      this.head = entry;\n      ++this.length;\n    }\n  }, {\n    key: \"shift\",\n    value: function shift() {\n      if (this.length === 0) return;\n      var ret = this.head.data;\n      if (this.length === 1) this.head = this.tail = null;else this.head = this.head.next;\n      --this.length;\n      return ret;\n    }\n  }, {\n    key: \"clear\",\n    value: function clear() {\n      this.head = this.tail = null;\n      this.length = 0;\n    }\n  }, {\n    key: \"join\",\n    value: function join(s) {\n      if (this.length === 0) return '';\n      var p = this.head;\n      var ret = '' + p.data;\n      while (p = p.next) ret += s + p.data;\n      return ret;\n    }\n  }, {\n    key: \"concat\",\n    value: function concat(n) {\n      if (this.length === 0) return Buffer.alloc(0);\n      var ret = Buffer.allocUnsafe(n >>> 0);\n      var p = this.head;\n      var i = 0;\n      while (p) {\n        copyBuffer(p.data, ret, i);\n        i += p.data.length;\n        p = p.next;\n      }\n      return ret;\n    }\n\n    // Consumes a specified amount of bytes or characters from the buffered data.\n  }, {\n    key: \"consume\",\n    value: function consume(n, hasStrings) {\n      var ret;\n      if (n < this.head.data.length) {\n        // `slice` is the same for buffers and strings.\n        ret = this.head.data.slice(0, n);\n        this.head.data = this.head.data.slice(n);\n      } else if (n === this.head.data.length) {\n        // First chunk is a perfect match.\n        ret = this.shift();\n      } else {\n        // Result spans more than one buffer.\n        ret = hasStrings ? this._getString(n) : this._getBuffer(n);\n      }\n      return ret;\n    }\n  }, {\n    key: \"first\",\n    value: function first() {\n      return this.head.data;\n    }\n\n    // Consumes a specified amount of characters from the buffered data.\n  }, {\n    key: \"_getString\",\n    value: function _getString(n) {\n      var p = this.head;\n      var c = 1;\n      var ret = p.data;\n      n -= ret.length;\n      while (p = p.next) {\n        var str = p.data;\n        var nb = n > str.length ? str.length : n;\n        if (nb === str.length) ret += str;else ret += str.slice(0, n);\n        n -= nb;\n        if (n === 0) {\n          if (nb === str.length) {\n            ++c;\n            if (p.next) this.head = p.next;else this.head = this.tail = null;\n          } else {\n            this.head = p;\n            p.data = str.slice(nb);\n          }\n          break;\n        }\n        ++c;\n      }\n      this.length -= c;\n      return ret;\n    }\n\n    // Consumes a specified amount of bytes from the buffered data.\n  }, {\n    key: \"_getBuffer\",\n    value: function _getBuffer(n) {\n      var ret = Buffer.allocUnsafe(n);\n      var p = this.head;\n      var c = 1;\n      p.data.copy(ret);\n      n -= p.data.length;\n      while (p = p.next) {\n        var buf = p.data;\n        var nb = n > buf.length ? buf.length : n;\n        buf.copy(ret, ret.length - n, 0, nb);\n        n -= nb;\n        if (n === 0) {\n          if (nb === buf.length) {\n            ++c;\n            if (p.next) this.head = p.next;else this.head = this.tail = null;\n          } else {\n            this.head = p;\n            p.data = buf.slice(nb);\n          }\n          break;\n        }\n        ++c;\n      }\n      this.length -= c;\n      return ret;\n    }\n\n    // Make sure the linked list only shows the minimal necessary information.\n  }, {\n    key: custom,\n    value: function value(_, options) {\n      return inspect(this, _objectSpread(_objectSpread({}, options), {}, {\n        // Only inspect one level.\n        depth: 0,\n        // It should not recurse.\n        customInspect: false\n      }));\n    }\n  }]);\n  return BufferList;\n}();","'use strict';\n\nvar _Object$setPrototypeO;\nfunction _defineProperty(obj, key, value) { key = _toPropertyKey(key); if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\nfunction _toPropertyKey(arg) { var key = _toPrimitive(arg, \"string\"); return typeof key === \"symbol\" ? key : String(key); }\nfunction _toPrimitive(input, hint) { if (typeof input !== \"object\" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || \"default\"); if (typeof res !== \"object\") return res; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (hint === \"string\" ? String : Number)(input); }\nvar finished = require('./end-of-stream');\nvar kLastResolve = Symbol('lastResolve');\nvar kLastReject = Symbol('lastReject');\nvar kError = Symbol('error');\nvar kEnded = Symbol('ended');\nvar kLastPromise = Symbol('lastPromise');\nvar kHandlePromise = Symbol('handlePromise');\nvar kStream = Symbol('stream');\nfunction createIterResult(value, done) {\n  return {\n    value: value,\n    done: done\n  };\n}\nfunction readAndResolve(iter) {\n  var resolve = iter[kLastResolve];\n  if (resolve !== null) {\n    var data = iter[kStream].read();\n    // we defer if data is null\n    // we can be expecting either 'end' or\n    // 'error'\n    if (data !== null) {\n      iter[kLastPromise] = null;\n      iter[kLastResolve] = null;\n      iter[kLastReject] = null;\n      resolve(createIterResult(data, false));\n    }\n  }\n}\nfunction onReadable(iter) {\n  // we wait for the next tick, because it might\n  // emit an error with process.nextTick\n  process.nextTick(readAndResolve, iter);\n}\nfunction wrapForNext(lastPromise, iter) {\n  return function (resolve, reject) {\n    lastPromise.then(function () {\n      if (iter[kEnded]) {\n        resolve(createIterResult(undefined, true));\n        return;\n      }\n      iter[kHandlePromise](resolve, reject);\n    }, reject);\n  };\n}\nvar AsyncIteratorPrototype = Object.getPrototypeOf(function () {});\nvar ReadableStreamAsyncIteratorPrototype = Object.setPrototypeOf((_Object$setPrototypeO = {\n  get stream() {\n    return this[kStream];\n  },\n  next: function next() {\n    var _this = this;\n    // if we have detected an error in the meanwhile\n    // reject straight away\n    var error = this[kError];\n    if (error !== null) {\n      return Promise.reject(error);\n    }\n    if (this[kEnded]) {\n      return Promise.resolve(createIterResult(undefined, true));\n    }\n    if (this[kStream].destroyed) {\n      // We need to defer via nextTick because if .destroy(err) is\n      // called, the error will be emitted via nextTick, and\n      // we cannot guarantee that there is no error lingering around\n      // waiting to be emitted.\n      return new Promise(function (resolve, reject) {\n        process.nextTick(function () {\n          if (_this[kError]) {\n            reject(_this[kError]);\n          } else {\n            resolve(createIterResult(undefined, true));\n          }\n        });\n      });\n    }\n\n    // if we have multiple next() calls\n    // we will wait for the previous Promise to finish\n    // this logic is optimized to support for await loops,\n    // where next() is only called once at a time\n    var lastPromise = this[kLastPromise];\n    var promise;\n    if (lastPromise) {\n      promise = new Promise(wrapForNext(lastPromise, this));\n    } else {\n      // fast path needed to support multiple this.push()\n      // without triggering the next() queue\n      var data = this[kStream].read();\n      if (data !== null) {\n        return Promise.resolve(createIterResult(data, false));\n      }\n      promise = new Promise(this[kHandlePromise]);\n    }\n    this[kLastPromise] = promise;\n    return promise;\n  }\n}, _defineProperty(_Object$setPrototypeO, Symbol.asyncIterator, function () {\n  return this;\n}), _defineProperty(_Object$setPrototypeO, \"return\", function _return() {\n  var _this2 = this;\n  // destroy(err, cb) is a private API\n  // we can guarantee we have that here, because we control the\n  // Readable class this is attached to\n  return new Promise(function (resolve, reject) {\n    _this2[kStream].destroy(null, function (err) {\n      if (err) {\n        reject(err);\n        return;\n      }\n      resolve(createIterResult(undefined, true));\n    });\n  });\n}), _Object$setPrototypeO), AsyncIteratorPrototype);\nvar createReadableStreamAsyncIterator = function createReadableStreamAsyncIterator(stream) {\n  var _Object$create;\n  var iterator = Object.create(ReadableStreamAsyncIteratorPrototype, (_Object$create = {}, _defineProperty(_Object$create, kStream, {\n    value: stream,\n    writable: true\n  }), _defineProperty(_Object$create, kLastResolve, {\n    value: null,\n    writable: true\n  }), _defineProperty(_Object$create, kLastReject, {\n    value: null,\n    writable: true\n  }), _defineProperty(_Object$create, kError, {\n    value: null,\n    writable: true\n  }), _defineProperty(_Object$create, kEnded, {\n    value: stream._readableState.endEmitted,\n    writable: true\n  }), _defineProperty(_Object$create, kHandlePromise, {\n    value: function value(resolve, reject) {\n      var data = iterator[kStream].read();\n      if (data) {\n        iterator[kLastPromise] = null;\n        iterator[kLastResolve] = null;\n        iterator[kLastReject] = null;\n        resolve(createIterResult(data, false));\n      } else {\n        iterator[kLastResolve] = resolve;\n        iterator[kLastReject] = reject;\n      }\n    },\n    writable: true\n  }), _Object$create));\n  iterator[kLastPromise] = null;\n  finished(stream, function (err) {\n    if (err && err.code !== 'ERR_STREAM_PREMATURE_CLOSE') {\n      var reject = iterator[kLastReject];\n      // reject if we are waiting for data in the Promise\n      // returned by next() and store the error\n      if (reject !== null) {\n        iterator[kLastPromise] = null;\n        iterator[kLastResolve] = null;\n        iterator[kLastReject] = null;\n        reject(err);\n      }\n      iterator[kError] = err;\n      return;\n    }\n    var resolve = iterator[kLastResolve];\n    if (resolve !== null) {\n      iterator[kLastPromise] = null;\n      iterator[kLastResolve] = null;\n      iterator[kLastReject] = null;\n      resolve(createIterResult(undefined, true));\n    }\n    iterator[kEnded] = true;\n  });\n  stream.on('readable', onReadable.bind(null, iterator));\n  return iterator;\n};\nmodule.exports = createReadableStreamAsyncIterator;","module.exports = function () {\n  throw new Error('Readable.from is not available in the browser')\n};\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n// a passthrough stream.\n// basically just the most minimal sort of Transform stream.\n// Every written chunk gets output as-is.\n\n'use strict';\n\nmodule.exports = PassThrough;\nvar Transform = require('./_stream_transform');\nrequire('inherits')(PassThrough, Transform);\nfunction PassThrough(options) {\n  if (!(this instanceof PassThrough)) return new PassThrough(options);\n  Transform.call(this, options);\n}\nPassThrough.prototype._transform = function (chunk, encoding, cb) {\n  cb(null, chunk);\n};","// Ported from https://github.com/mafintosh/pump with\n// permission from the author, Mathias Buus (@mafintosh).\n\n'use strict';\n\nvar eos;\nfunction once(callback) {\n  var called = false;\n  return function () {\n    if (called) return;\n    called = true;\n    callback.apply(void 0, arguments);\n  };\n}\nvar _require$codes = require('../../../errors').codes,\n  ERR_MISSING_ARGS = _require$codes.ERR_MISSING_ARGS,\n  ERR_STREAM_DESTROYED = _require$codes.ERR_STREAM_DESTROYED;\nfunction noop(err) {\n  // Rethrow the error if it exists to avoid swallowing it\n  if (err) throw err;\n}\nfunction isRequest(stream) {\n  return stream.setHeader && typeof stream.abort === 'function';\n}\nfunction destroyer(stream, reading, writing, callback) {\n  callback = once(callback);\n  var closed = false;\n  stream.on('close', function () {\n    closed = true;\n  });\n  if (eos === undefined) eos = require('./end-of-stream');\n  eos(stream, {\n    readable: reading,\n    writable: writing\n  }, function (err) {\n    if (err) return callback(err);\n    closed = true;\n    callback();\n  });\n  var destroyed = false;\n  return function (err) {\n    if (closed) return;\n    if (destroyed) return;\n    destroyed = true;\n\n    // request.destroy just do .end - .abort is what we want\n    if (isRequest(stream)) return stream.abort();\n    if (typeof stream.destroy === 'function') return stream.destroy();\n    callback(err || new ERR_STREAM_DESTROYED('pipe'));\n  };\n}\nfunction call(fn) {\n  fn();\n}\nfunction pipe(from, to) {\n  return from.pipe(to);\n}\nfunction popCallback(streams) {\n  if (!streams.length) return noop;\n  if (typeof streams[streams.length - 1] !== 'function') return noop;\n  return streams.pop();\n}\nfunction pipeline() {\n  for (var _len = arguments.length, streams = new Array(_len), _key = 0; _key < _len; _key++) {\n    streams[_key] = arguments[_key];\n  }\n  var callback = popCallback(streams);\n  if (Array.isArray(streams[0])) streams = streams[0];\n  if (streams.length < 2) {\n    throw new ERR_MISSING_ARGS('streams');\n  }\n  var error;\n  var destroys = streams.map(function (stream, i) {\n    var reading = i < streams.length - 1;\n    var writing = i > 0;\n    return destroyer(stream, reading, writing, function (err) {\n      if (!error) error = err;\n      if (err) destroys.forEach(call);\n      if (reading) return;\n      destroys.forEach(call);\n      callback(error);\n    });\n  });\n  return streams.reduce(pipe);\n}\nmodule.exports = pipeline;","import randombytes from 'randombytes';\nimport _defineProperty from '@babel/runtime/helpers/defineProperty';\nimport base64urlLib from 'base64url';\nimport keccakLib from 'keccak';\n\nconst randomId = () => randombytes(32).toString(\"hex\");\n\nclass URLWithHashParams extends URL {\n  constructor() {\n    super(...arguments);\n    _defineProperty(this, \"hashParams\", new URLSearchParams());\n  }\n  toString() {\n    this.hash = this.hashParams.toString();\n    return super.toString.call(this);\n  }\n}\n\nconst base64url = base64urlLib;\nfunction safebtoa(str) {\n  return base64url.encode(str);\n}\nfunction safeatob(str) {\n  // Going backwards: from bytestream, to percent-encoding, to original string.\n  return base64url.decode(str);\n}\nconst keccak = keccakLib;\nfunction base64toJSON(b64str) {\n  return JSON.parse(base64url.decode(b64str));\n}\nfunction jsonToBase64(json) {\n  return base64url.encode(JSON.stringify(json));\n}\nfunction keccak256(str) {\n  let input = str;\n  if (typeof str === \"string\" && str.slice(0, 2) === \"0x\" && str.length === 66) {\n    input = Buffer.from(str.slice(2), \"hex\");\n  }\n  const data = `0x${keccak(\"keccak256\").update(input).digest(\"hex\").padStart(64, \"0\")}`;\n  return data;\n}\n\nexport { URLWithHashParams, base64toJSON, base64url, jsonToBase64, keccak, keccak256, randomId, safeatob, safebtoa };\n//# sourceMappingURL=openloginUtils.esm.js.map\n",null,null,"import _asyncToGenerator from '@babel/runtime/helpers/asyncToGenerator';\nimport _classCallCheck from '@babel/runtime/helpers/classCallCheck';\nimport _createClass from '@babel/runtime/helpers/createClass';\nimport _assertThisInitialized from '@babel/runtime/helpers/assertThisInitialized';\nimport _get from '@babel/runtime/helpers/get';\nimport _inherits from '@babel/runtime/helpers/inherits';\nimport _possibleConstructorReturn from '@babel/runtime/helpers/possibleConstructorReturn';\nimport _getPrototypeOf from '@babel/runtime/helpers/getPrototypeOf';\nimport _defineProperty from '@babel/runtime/helpers/defineProperty';\nimport _regeneratorRuntime from '@babel/runtime/regenerator';\nimport Torus from '@toruslabs/solana-embed';\nimport { WALLET_ADAPTERS, ADAPTER_NAMESPACES, CHAIN_NAMESPACES, ADAPTER_CATEGORY, ADAPTER_STATUS, log, ADAPTER_EVENTS, getChainConfig, WalletLoginError, Web3AuthError, WalletInitializationError } from '@web3auth/base';\nimport { BaseSolanaAdapter } from '@web3auth/base-solana-adapter';\nimport { TorusInjectedProvider } from '@web3auth/solana-provider';\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\nvar SolanaWalletAdapter = /*#__PURE__*/function (_BaseSolanaAdapter) {\n  _inherits(SolanaWalletAdapter, _BaseSolanaAdapter);\n\n  var _super = _createSuper(SolanaWalletAdapter);\n\n  function SolanaWalletAdapter(params) {\n    var _this;\n\n    _classCallCheck(this, SolanaWalletAdapter);\n\n    _this = _super.call(this, params);\n\n    _defineProperty(_assertThisInitialized(_this), \"name\", WALLET_ADAPTERS.TORUS_SOLANA);\n\n    _defineProperty(_assertThisInitialized(_this), \"adapterNamespace\", ADAPTER_NAMESPACES.SOLANA);\n\n    _defineProperty(_assertThisInitialized(_this), \"currentChainNamespace\", CHAIN_NAMESPACES.SOLANA);\n\n    _defineProperty(_assertThisInitialized(_this), \"type\", ADAPTER_CATEGORY.EXTERNAL);\n\n    _defineProperty(_assertThisInitialized(_this), \"status\", ADAPTER_STATUS.NOT_READY);\n\n    _defineProperty(_assertThisInitialized(_this), \"torusInstance\", null);\n\n    _defineProperty(_assertThisInitialized(_this), \"torusWalletOptions\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"initParams\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"loginSettings\", {});\n\n    _defineProperty(_assertThisInitialized(_this), \"solanaProvider\", null);\n\n    _defineProperty(_assertThisInitialized(_this), \"rehydrated\", false);\n\n    _this.torusWalletOptions = params.adapterSettings || {};\n    _this.initParams = params.initParams || {};\n    _this.loginSettings = params.loginSettings || {};\n    _this.chainConfig = params.chainConfig || null;\n    _this.sessionTime = params.sessionTime || 86400;\n    return _this;\n  }\n\n  _createClass(SolanaWalletAdapter, [{\n    key: \"provider\",\n    get: function get() {\n      if (this.status === ADAPTER_STATUS.CONNECTED && this.solanaProvider) {\n        var _this$solanaProvider;\n\n        return ((_this$solanaProvider = this.solanaProvider) === null || _this$solanaProvider === void 0 ? void 0 : _this$solanaProvider.provider) || null;\n      }\n\n      return null;\n    },\n    set: function set(_) {\n      throw new Error(\"Not implemented\");\n    }\n  }, {\n    key: \"init\",\n    value: function () {\n      var _init = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(options) {\n        var network, _this$chainConfig, blockExplorer, displayName, ticker, tickerName, rpcTarget, chainId, _this$chainConfig2, _chainId, _blockExplorer, _displayName, _rpcTarget, _ticker, _tickerName;\n\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _get(_getPrototypeOf(SolanaWalletAdapter.prototype), \"checkInitializationRequirements\", this).call(this); // set chainConfig for mainnet by default if not set\n\n\n                if (!this.chainConfig) {\n                  this.chainConfig = getChainConfig(CHAIN_NAMESPACES.SOLANA, \"0x1\");\n                  _this$chainConfig = this.chainConfig, blockExplorer = _this$chainConfig.blockExplorer, displayName = _this$chainConfig.displayName, ticker = _this$chainConfig.ticker, tickerName = _this$chainConfig.tickerName, rpcTarget = _this$chainConfig.rpcTarget, chainId = _this$chainConfig.chainId;\n                  network = {\n                    chainId: chainId,\n                    rpcTarget: rpcTarget,\n                    blockExplorerUrl: blockExplorer,\n                    displayName: displayName,\n                    ticker: ticker,\n                    tickerName: tickerName,\n                    logo: \"\"\n                  };\n                } else {\n                  _this$chainConfig2 = this.chainConfig, _chainId = _this$chainConfig2.chainId, _blockExplorer = _this$chainConfig2.blockExplorer, _displayName = _this$chainConfig2.displayName, _rpcTarget = _this$chainConfig2.rpcTarget, _ticker = _this$chainConfig2.ticker, _tickerName = _this$chainConfig2.tickerName;\n                  network = {\n                    chainId: _chainId,\n                    rpcTarget: _rpcTarget,\n                    blockExplorerUrl: _blockExplorer,\n                    displayName: _displayName,\n                    tickerName: _tickerName,\n                    ticker: _ticker,\n                    logo: \"\"\n                  };\n                }\n\n                this.torusInstance = new Torus(this.torusWalletOptions);\n                log.debug(\"initializing torus solana adapter init\");\n                _context.next = 6;\n                return this.torusInstance.init(_objectSpread(_objectSpread({\n                  showTorusButton: false\n                }, this.initParams), {}, {\n                  network: network\n                }));\n\n              case 6:\n                this.solanaProvider = new TorusInjectedProvider({\n                  config: {\n                    chainConfig: this.chainConfig\n                  }\n                });\n                this.status = ADAPTER_STATUS.READY;\n                this.emit(ADAPTER_EVENTS.READY, WALLET_ADAPTERS.TORUS_SOLANA);\n                _context.prev = 9;\n                log.debug(\"initializing torus solana adapter\");\n\n                if (!options.autoConnect) {\n                  _context.next = 15;\n                  break;\n                }\n\n                this.rehydrated = true;\n                _context.next = 15;\n                return this.connect();\n\n              case 15:\n                _context.next = 21;\n                break;\n\n              case 17:\n                _context.prev = 17;\n                _context.t0 = _context[\"catch\"](9);\n                log.error(\"Failed to connect with cached torus solana provider\", _context.t0);\n                this.emit(ADAPTER_EVENTS.ERRORED, _context.t0);\n\n              case 21:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this, [[9, 17]]);\n      }));\n\n      function init(_x) {\n        return _init.apply(this, arguments);\n      }\n\n      return init;\n    }()\n  }, {\n    key: \"connect\",\n    value: function () {\n      var _connect = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n        var torusInpageProvider, _this$chainConfig3, chainId, blockExplorer, displayName, rpcTarget, ticker, tickerName, network;\n\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _get(_getPrototypeOf(SolanaWalletAdapter.prototype), \"checkConnectionRequirements\", this).call(this);\n\n                if (this.torusInstance) {\n                  _context2.next = 3;\n                  break;\n                }\n\n                throw WalletInitializationError.notReady(\"Torus wallet is not initialized\");\n\n              case 3:\n                if (this.solanaProvider) {\n                  _context2.next = 5;\n                  break;\n                }\n\n                throw WalletInitializationError.notReady(\"Torus wallet is not initialized\");\n\n              case 5:\n                this.status = ADAPTER_STATUS.CONNECTING;\n                this.emit(ADAPTER_EVENTS.CONNECTING, {\n                  adapter: WALLET_ADAPTERS.TORUS_SOLANA\n                });\n                _context2.prev = 7;\n                _context2.next = 10;\n                return this.torusInstance.login(this.loginSettings);\n\n              case 10:\n                _context2.prev = 10;\n                torusInpageProvider = this.torusInstance.provider;\n                torusInpageProvider.sendTransaction = this.torusInstance.sendTransaction.bind(this.torusInstance);\n                torusInpageProvider.signAllTransactions = this.torusInstance.signAllTransactions.bind(this.torusInstance);\n                torusInpageProvider.signMessage = this.torusInstance.signMessage.bind(this.torusInstance);\n                torusInpageProvider.signTransaction = this.torusInstance.signTransaction.bind(this.torusInstance);\n                _context2.next = 18;\n                return this.solanaProvider.setupProvider(torusInpageProvider);\n\n              case 18:\n                _context2.next = 30;\n                break;\n\n              case 20:\n                _context2.prev = 20;\n                _context2.t0 = _context2[\"catch\"](10);\n\n                if (!(_context2.t0 instanceof Web3AuthError && _context2.t0.code === 5010)) {\n                  _context2.next = 29;\n                  break;\n                }\n\n                _this$chainConfig3 = this.chainConfig, chainId = _this$chainConfig3.chainId, blockExplorer = _this$chainConfig3.blockExplorer, displayName = _this$chainConfig3.displayName, rpcTarget = _this$chainConfig3.rpcTarget, ticker = _this$chainConfig3.ticker, tickerName = _this$chainConfig3.tickerName;\n                network = {\n                  chainId: chainId,\n                  rpcTarget: rpcTarget,\n                  blockExplorerUrl: blockExplorer,\n                  displayName: displayName,\n                  tickerName: tickerName,\n                  ticker: ticker,\n                  logo: \"\"\n                };\n                _context2.next = 27;\n                return this.torusInstance.setProvider(network);\n\n              case 27:\n                _context2.next = 30;\n                break;\n\n              case 29:\n                throw _context2.t0;\n\n              case 30:\n                this.status = ADAPTER_STATUS.CONNECTED;\n                this.torusInstance.showTorusButton();\n                this.emit(ADAPTER_STATUS.CONNECTED, {\n                  adapter: WALLET_ADAPTERS.TORUS_SOLANA,\n                  reconnected: this.rehydrated\n                });\n                return _context2.abrupt(\"return\", this.provider);\n\n              case 36:\n                _context2.prev = 36;\n                _context2.t1 = _context2[\"catch\"](7);\n                // ready again to be connected\n                this.status = ADAPTER_STATUS.READY;\n                this.rehydrated = false;\n                this.emit(ADAPTER_EVENTS.ERRORED, _context2.t1);\n                throw WalletLoginError.connectionError(\"Failed to login with torus solana wallet\");\n\n              case 42:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this, [[7, 36], [10, 20]]);\n      }));\n\n      function connect() {\n        return _connect.apply(this, arguments);\n      }\n\n      return connect;\n    }()\n  }, {\n    key: \"disconnect\",\n    value: function () {\n      var _disconnect = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n        var options,\n            _args3 = arguments;\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                options = _args3.length > 0 && _args3[0] !== undefined ? _args3[0] : {\n                  cleanup: false\n                };\n\n                if (this.torusInstance) {\n                  _context3.next = 3;\n                  break;\n                }\n\n                throw WalletInitializationError.notReady(\"Torus wallet is not initialized\");\n\n              case 3:\n                _context3.next = 5;\n                return _get(_getPrototypeOf(SolanaWalletAdapter.prototype), \"disconnect\", this).call(this);\n\n              case 5:\n                _context3.next = 7;\n                return this.torusInstance.logout();\n\n              case 7:\n                if (options.cleanup) {\n                  // ready to connect again\n                  this.status = ADAPTER_STATUS.NOT_READY;\n                  this.torusInstance = null;\n                  this.solanaProvider = null;\n                } else {\n                  // ready to connect again\n                  this.status = ADAPTER_STATUS.READY;\n                }\n\n                this.emit(ADAPTER_EVENTS.DISCONNECTED);\n\n              case 9:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      function disconnect() {\n        return _disconnect.apply(this, arguments);\n      }\n\n      return disconnect;\n    }()\n  }, {\n    key: \"getUserInfo\",\n    value: function () {\n      var _getUserInfo = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4() {\n        var userInfo;\n        return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                if (!(this.status !== ADAPTER_STATUS.CONNECTED)) {\n                  _context4.next = 2;\n                  break;\n                }\n\n                throw WalletLoginError.notConnectedError(\"Not connected with wallet\");\n\n              case 2:\n                if (this.torusInstance) {\n                  _context4.next = 4;\n                  break;\n                }\n\n                throw WalletInitializationError.notReady(\"Torus wallet is not initialized\");\n\n              case 4:\n                _context4.next = 6;\n                return this.torusInstance.getUserInfo();\n\n              case 6:\n                userInfo = _context4.sent;\n                return _context4.abrupt(\"return\", userInfo);\n\n              case 8:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this);\n      }));\n\n      function getUserInfo() {\n        return _getUserInfo.apply(this, arguments);\n      }\n\n      return getUserInfo;\n    }()\n  }, {\n    key: \"setAdapterSettings\",\n    value: function setAdapterSettings(options) {\n      if (this.status === ADAPTER_STATUS.READY) return;\n\n      if (options !== null && options !== void 0 && options.sessionTime) {\n        this.sessionTime = options.sessionTime;\n      }\n\n      if (options !== null && options !== void 0 && options.clientId) {\n        this.clientId = options.clientId;\n      }\n    }\n  }]);\n\n  return SolanaWalletAdapter;\n}(BaseSolanaAdapter);\n\nexport { SolanaWalletAdapter };\n//# sourceMappingURL=torusSolanaAdapter.esm.js.map\n"],"sourceRoot":""}