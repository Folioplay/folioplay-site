{"version":3,"sources":["../node_modules/@toruslabs/torus-embed/node_modules/readable-stream/errors-browser.js","../node_modules/@toruslabs/torus-embed/node_modules/readable-stream/lib/_stream_duplex.js","../../src/baseEvmAdapter.ts","../node_modules/@babel/runtime/helpers/objectWithoutProperties.js","../node_modules/@babel/runtime/helpers/objectWithoutPropertiesLoose.js","../node_modules/@toruslabs/torus-embed/node_modules/readable-stream/lib/internal/streams/end-of-stream.js","../../src/ObservableStore.ts","../node_modules/fast-deep-equal/index.js","../node_modules/is-stream/index.js","../node_modules/@toruslabs/torus-embed/node_modules/readable-stream/lib/_stream_readable.js","../node_modules/@toruslabs/torus-embed/node_modules/readable-stream/lib/internal/streams/stream-browser.js","../node_modules/@toruslabs/torus-embed/node_modules/readable-stream/lib/internal/streams/destroy.js","../node_modules/@toruslabs/torus-embed/node_modules/readable-stream/lib/internal/streams/state.js","../node_modules/@toruslabs/torus-embed/node_modules/readable-stream/lib/_stream_writable.js","../node_modules/@toruslabs/torus-embed/node_modules/readable-stream/lib/_stream_transform.js","../../src/interfaces.ts","../../src/supportedCurrencies.ts","../../src/config.ts","../../src/embedUtils.ts","../../src/loglevel.ts","../../src/messages.ts","../../src/utils.ts","../../src/inpage-provider.ts","../../src/integrity.ts","../../src/PopupHandler.ts","../../src/siteMetadata.ts","../../src/embed.ts","../../src/basePostMessageStream.ts","../../src/safeEventEmitter.ts","../../src/serializableError.ts","../../src/jrpc.ts","../../src/jrpcEngine.ts","../../src/substream.ts","../../src/mux.ts","../node_modules/@toruslabs/torus-embed/node_modules/readable-stream/readable-browser.js","../node_modules/@toruslabs/torus-embed/node_modules/readable-stream/lib/internal/streams/buffer_list.js","../node_modules/@toruslabs/torus-embed/node_modules/readable-stream/lib/internal/streams/async_iterator.js","../node_modules/@toruslabs/torus-embed/node_modules/readable-stream/lib/internal/streams/from-browser.js","../node_modules/@toruslabs/torus-embed/node_modules/readable-stream/lib/_stream_passthrough.js","../node_modules/@toruslabs/torus-embed/node_modules/readable-stream/lib/internal/streams/pipeline.js","../../src/randomId.ts","../../src/url.ts","../../src/index.ts","../../src/asStream.ts","../../src/ComposedStore.ts","../../src/MergedStore.ts","../../src/transform.ts","../node_modules/through2/through2.js","../../src/torusWalletAdapter.ts"],"names":["codes","createErrorType","code","message","Base","Error","NodeError","_Base","subClass","superClass","arg1","arg2","arg3","call","this","getMessage","prototype","Object","create","constructor","__proto__","name","oneOf","expected","thing","Array","isArray","len","length","map","i","String","concat","slice","join","value","TypeError","actual","determiner","search","pos","msg","substr","replace","str","this_len","undefined","substring","endsWith","type","start","indexOf","includes","arg","module","exports","objectKeys","keys","obj","key","push","Duplex","Readable","require","Writable","v","method","options","allowHalfOpen","readable","writable","once","onend","_writableState","ended","process","nextTick","onEndNT","self","end","defineProperty","enumerable","get","highWaterMark","getBuffer","_readableState","destroyed","set","BaseEvmAdapter","params","clientId","provider","chainConfig","chainId","WalletLoginError","notConnectedError","chainNamespace","status","ADAPTER_STATUS","CONNECTED","request","accounts","existingToken","getSavedToken","checkIfTokenIsExpired","idToken","payload","domain","window","location","origin","uri","href","address","parseInt","version","nonce","Math","random","toString","issuedAt","Date","toISOString","signChallenge","challenge","signedMessage","verifySignedChallenge","sessionTime","saveToken","disconnectionError","clearToken","BaseAdapter","objectWithoutPropertiesLoose","source","excluded","target","getOwnPropertySymbols","sourceSymbolKeys","propertyIsEnumerable","__esModule","sourceKeys","ERR_STREAM_PREMATURE_CLOSE","noop","eos","stream","opts","callback","called","_len","arguments","args","_key","apply","onlegacyfinish","onfinish","writableEnded","finished","readableEnded","endEmitted","onerror","err","onclose","onrequest","req","on","setHeader","abort","isRequest","error","removeListener","ObservableStore","initState","_state","_getState","newState","_putState","emit","partialState","state","getState","putState","handler","equal","a","b","RegExp","flags","valueOf","hasOwnProperty","isStream","pipe","_write","_read","duplex","transform","_transform","ReadableState","EventEmitter","EElistenerCount","emitter","listeners","Stream","Buffer","OurUint8Array","global","Uint8Array","debug","debugUtil","debuglog","StringDecoder","createReadableStreamAsyncIterator","from","BufferList","destroyImpl","getHighWaterMark","_require$codes","ERR_INVALID_ARG_TYPE","ERR_STREAM_PUSH_AFTER_EOF","ERR_METHOD_NOT_IMPLEMENTED","ERR_STREAM_UNSHIFT_AFTER_END_EVENT","errorOrDestroy","kProxyEvents","isDuplex","objectMode","readableObjectMode","buffer","pipes","pipesCount","flowing","reading","sync","needReadable","emittedReadable","readableListening","resumeScheduled","paused","emitClose","autoDestroy","defaultEncoding","awaitDrain","readingMore","decoder","encoding","read","destroy","_destroy","readableAddChunk","chunk","addToFront","skipChunkCheck","er","emitReadable","emitReadable_","onEofChunk","isBuffer","chunkInvalid","getPrototypeOf","_uint8ArrayToBuffer","addChunk","write","maybeReadMore","unshift","_undestroy","undestroy","cb","isPaused","setEncoding","enc","p","head","content","data","next","clear","MAX_HWM","howMuchToRead","n","computeNewHighWaterMark","flow","maybeReadMore_","updateReadableListening","listenerCount","resume","nReadingNextTick","resume_","fromList","ret","shift","first","consume","endReadable","endReadableNT","wState","xs","x","l","nOrig","doRead","dest","pipeOpts","src","endFn","stdout","stderr","unpipe","onunpipe","unpipeInfo","hasUnpiped","ondrain","ondata","cleanedUp","needDrain","pipeOnDrain","pause","event","fn","prependListener","_events","dests","index","splice","ev","res","addListener","removeAllListeners","wrap","_this","bind","Symbol","asyncIterator","_fromList","iterable","emitErrorAndCloseNT","emitErrorNT","emitCloseNT","readableDestroyed","writableDestroyed","errorEmitted","ending","finalCalled","prefinished","rState","ERR_INVALID_OPT_VALUE","duplexKey","hwm","highWaterMarkFrom","isFinite","floor","CorkedRequest","entry","finish","corkReq","pendingcb","corkedRequestsFree","onCorkedFinish","WritableState","internalUtil","deprecate","realHasInstance","ERR_MULTIPLE_CALLBACK","ERR_STREAM_CANNOT_PIPE","ERR_STREAM_DESTROYED","ERR_STREAM_NULL_VALUES","ERR_STREAM_WRITE_AFTER_END","ERR_UNKNOWN_ENCODING","nop","writableObjectMode","noDecode","decodeStrings","writing","corked","bufferProcessing","onwrite","writecb","writelen","onwriteStateUpdate","finishMaybe","onwriteError","needFinish","bufferedRequest","clearBuffer","afterWrite","lastBufferedRequest","bufferedRequestCount","writev","_writev","final","_final","doWrite","onwriteDrain","holder","count","allBuffers","isBuf","callFinal","need","prefinish","current","out","_","hasInstance","Function","object","writeAfterEnd","validChunk","newChunk","decodeChunk","last","writeOrBuffer","cork","uncork","setDefaultEncoding","toLowerCase","endWritable","Transform","ERR_TRANSFORM_ALREADY_TRANSFORMING","ERR_TRANSFORM_WITH_LENGTH_0","afterTransform","ts","_transformState","transforming","writechunk","rs","needTransform","writeencoding","flush","_flush","done","err2","LOGIN_PROVIDER","WALLET_VERIFIERS","GOOGLE","FACEBOOK","TWITCH","REDDIT","DISCORD","EMAIL_PASSWORDLESS","WALLET_OPENLOGIN_VERIFIER_MAP","PAYMENT_PROVIDER","SUPPORTED_PAYMENT_NETWORK","TORUS_BUILD_ENV","BUTTON_POSITION","PROVIDER_SUPPORTED_FIAT_CURRENCIES","cryptoCompareCurrenciesSet","Set","supportedFiatCurrencies","filter","currency","has","paymentProviders","line1","line2","line3","supportPage","minOrderValue","maxOrderValue","validCurrencies","validCryptoCurrenciesByChain","display","includeFees","api","enforceMax","receiveHint","sell","supportedVerifierList","values","translations","en","embed","continue","actionRequired","pendingAction","cookiesRequired","enableCookies","clickHere","de","ja","ko","zh","prodTorusUrl","localStorageKeyPrefix","runOnLoad","Promise","resolve","reject","document","body","then","catch","addEventListener","htmlToElement","html","template","createElement","trimmedHtml","trim","innerHTML","firstChild","handleEvent","handle","eventName","handlerArgs","handlerWrapper","removeEventListener","handleStream","documentReady","readyState","loglevel","getLogger","errors","disconnected","permanentlyDisconnected","sendSiteMetadata","unsupportedSync","invalidDuplexStream","invalidOptions","maxEventListeners","shouldSendMetadata","invalidRequestArgs","invalidRequestMethod","invalidRequestParams","invalidLoggerObject","invalidLoggerMethod","info","connected","warnings","enableDeprecation","sendDeprecation","events","close","networkChanged","notification","publicConfigStore","config","logStreamDisconnectWarning","remoteLabel","warningMsg","stack","log","warn","getPreopenInstanceId","getTorusUrl","buildEnv","integrity","versionUsed","useAPIKey","response","torusUrl","logLevel","getUserLanguage","userLanguage","navigator","language","userLanguages","split","EMITTED_NOTIFICATIONS","NOOP","FEATURES_PROVIDER_CHANGE_WINDOW","FEATURES_CONFIRM_WINDOW","SafeEventEmitter","defaultMaxListeners","getRpcPromiseCallback","unwrapResult","result","TorusInpageProvider","connectionStream","jsonRpcStreamName","_defineProperty","enable","experimentalMethods","send","isDuplexStream","messages","isTorus","setMaxListeners","_defaultState","selectedAddress","networkVersion","_handleAccountsChanged","_handleChainChanged","_handleUnlockStateChanged","_handleConnect","_handleDisconnect","_handleStreamDisconnect","_sendSync","_rpcRequest","_warnOfDeprecation","_initializeState","sendAsync","mux","ObjectMultiplex","pump","_publicConfigStore","storageKey","createStream","storeAsStream","ignoreStream","isConnected","jsonRpcConnection","createStreamMiddleware","rpcEngine","JRPCEngine","createIdRemapMiddleware","ethErrors","rpc","invalidRequest","middleware","_rpcEngine","_sentWarnings","listener","prependOnceListener","isUnlocked","initialized","isInternal","_payload","jsonrpc","tryPreopenHandle","methodOrPayload","callbackOrArgs","id","isRecoverable","errorMessage","isPermanentlyDisconnected","EthereumRpcError","streamName","isEthAccounts","finalAccounts","dequal","hasEmittedConnection","hashes","internalHashes","algorithms","forEach","algorithm","createHash","update","digest","main","finalOptions","delimiter","full","defaults","sri","output","PopupHandler","url","features","dualScreenLeft","screenLeft","screenX","dualScreenTop","screenTop","screenY","width","innerWidth","documentElement","clientWidth","screen","height","innerHeight","clientHeight","left","abs","top","w","getPopupFeatures","windowTimer","iClosedWindow","_setupTimer","Number","setInterval","closed","clearInterval","open","focus","redirect","locationReplaceOnRedirect","imgExists","img","onload","e","getSiteName","siteName","querySelector","metaTitle","title","hostname","getSiteIcon","icon","querySelectorAll","find","_icon","Boolean","getSiteMetadata","defaultVerifiers","iframeIntegrity","UNSAFE_METHODS","preLoadIframe","torusIframeHtml","check","hash","crossOrigin","rel","relList","supports","appendChild","Torus","buttonPosition","buttonSize","modalZIndex","apiKey","configuration","isLoggedIn","isInitialized","torusWidgetVisibility","requestedVerifier","currentVerifier","setAPIKey","alertZIndex","isIframeFullScreen","enableLogging","enabledVerifiers","network","host","networkName","blockExplorer","ticker","tickerName","loginConfig","showTorusButton","whiteLabel","skipTKey","useWalletConnect","mfaLevel","isCustomLogin","setDefaultLevel","enableAll","disableAll","torusIframeUrl","URL","pathname","torusIframe","torusAlertContainer","style","setProperty","link","setAttribute","styleLink","defaultLanguage","customTranslations","mergedTranslations","deepmerge","languageTranslations","embedTranslations","handleSetup","_setupWeb3","initStream","communicationMux","getStream","success","_displayIframe","fetchUrl","fetch","cache","resp","headers","text","calculatedIntegrity","generateIntegrity","clearInit","login","verifier","login_hint","loginHint","ethereum","logout","statusStream","loggedIn","isElement","element","Element","HTMLDocument","contains","remove","torusAlert","hideTorusButton","_sendWidgetVisibilityStatus","setProvider","rest","providerChangeStream","preopenInstanceId","_handleWindow","override","showWallet","path","showWalletStream","finalPath","instanceId","finalUrl","searchParams","append","getPublicAddress","verifierId","isExtended","walletVerifier","openloginVerifier","getUserInfo","userInfoAccessStream","approved","rejected","newRequest","userInfoStream","handlerChunk","initiateTopup","validatePaymentProvider","isValid","selectedProvider","selectedParams","fiatValue","requestedOrderAmount","parseFloat","selectedCurrency","selectedCryptoCurrency","flat","finalCryptoCurrency","JSON","stringify","topupStream","loginParams","userInfo","privateKey","loginPrivKeyStream","walletConnectStream","windowStream","handledWindow","_createPopupBlockAlert","closeHandler","_ref3","receivedId","_setEmbedWhiteLabel","theme","isDark","colors","classList","add","torusBrand1","torusGray2","_getLogoUrl","logoUrl","logoLight","logoDark","isFull","size","right","bottom","assign","metamaskStream","BasePostMessageStream","targetWindow","contentWindow","targetOrigin","communicationStream","inpageProvider","detectAccountRequestPrototypeModifier","m","originalMethod","setTimeout","handleLoginCb","_showLoginPopup","isLoginCallback","proxiedInpageProvider","Proxy","deleteProperty","setupMultiplex","engine","domainMetadata","originalError","calledFromEmbed","loginHandler","oauthStream","successAlert","btnContainer","attachOnLoad","bindOnLoad","children","ACK","_init","_haveSyn","_name","_target","_targetWindow","_targetOrigin","_onMessage","onMessage","_synIntervalId","_handShake","_break","_onData","_postMessage","originConstraint","postMessage","safeApply","context","Reflect","doError","arr","copy","arrayClone","isInteger","idMap","_encoding","processNotification","processResponse","_err","_end","originalId","newId","randomId","_middleware","_handleBatch","_handle","_promiseHandle","asMiddleware","_runAllMiddleware","middlewareError","isComplete","returnHandlers","_runReturnHandlers","handlerCallback","reqs","all","responses","callerReq","SerializableError","_processRequest","serializeError","_checkForCompletion","middlewareStack","_runMiddleware","reverse","returnHandler","handlers","parent","_parent","IGNORE_SUBSTREAM","_substreams","substream","Substream","_cb","anyStreamEnd","_error","console","PassThrough","pipeline","ownKeys","enumerableOnly","symbols","sym","getOwnPropertyDescriptor","_objectSpread","getOwnPropertyDescriptors","defineProperties","_toPropertyKey","configurable","_defineProperties","props","descriptor","input","hint","prim","toPrimitive","_toPrimitive","inspect","custom","instance","Constructor","_classCallCheck","tail","protoProps","staticProps","s","alloc","offset","allocUnsafe","hasStrings","_getString","_getBuffer","c","nb","buf","depth","customInspect","_Object$setPrototypeO","kLastResolve","kLastReject","kError","kEnded","kLastPromise","kHandlePromise","kStream","createIterResult","readAndResolve","iter","onReadable","AsyncIteratorPrototype","ReadableStreamAsyncIteratorPrototype","setPrototypeOf","promise","lastPromise","wrapForNext","_this2","_Object$create","iterator","ERR_MISSING_ARGS","to","streams","pop","popCallback","destroys","destroyer","reduce","randombytes","base64urlLib","keccakLib","ObservableStoreStream","obsStore","subscribe","_size","unsubscribe","ComposedStore","_children","childKey","child","_addChild","updateFromChild","childValue","MergedStore","_updateWholeState","childStates","syncTransformFn","inherits","xtend","DestroyableTransform","_destroyed","through2","construct","t2","ctor","Through2","TorusWalletAdapter","WALLET_ADAPTERS","TORUS_EVM","ADAPTER_NAMESPACES","EIP155","CHAIN_NAMESPACES","ADAPTER_CATEGORY","EXTERNAL","NOT_READY","torusWalletOptions","adapterSettings","initParams","loginSettings","torusInstance","displayName","rpcTarget","getChainConfig","init","READY","ADAPTER_EVENTS","autoConnect","rehydrated","connect","ERRORED","WalletInitializationError","notReady","CONNECTING","adapter","_chainId","updatedChainID","fromCode","reconnected","Web3AuthError","connectionError","cleanup","DISCONNECTED"],"mappings":"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A6B,mBACvCP,GAAiBC,OAAS,eAAa,cACvCD,GAAiBE,SAAW,iBAAe,cAC3CF,GAAiBG,OAAS,eAAa,cACvCH,GAAiBI,OAAS,eAAa,cACvCJ,GAAiBK,QAAU,gBAAc,cACzCL,GAAiBM,mBAAqB,oCAG5BE,GACF,UADEA,GAEL,OAFKA,GAGE,cAHFA,GAIF,UAJEA,GAKD,WALCA,GAMF,UANEA,GAOJ,QAGIC,GACF,UADEA,GAEJ,QAFIA,GAGE,cAHFA,GAIQ,oBAIRC,GACC,aAyCDC,GACE,cADFA,GAED,WAFCA,GAGG,eAHHA,GAIA,YC2MPC,IAAkC,mBAGrCJ,GAA2B,CAC1B,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,QACD,cAKAA,GAAwB,CACvB,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,QACD,cAEAA,GAA+B,CAAC,MAAO,MAAO,QAAM,cAEpDA,GAA2B,CAAC,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,QAAM,cAGjGA,GAA4B,CAAC,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,QAAM,cAMlGA,GAA2B,CAC1B,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,QACD,cACAA,GAAyB,CAAC,MAAO,MAAO,QAAK,GAG1CK,GAA6B,IAAIC,IAhbE,CACvC,MACA,OACA,OACA,OACA,QACA,MACA,MACA,OACA,OACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,OACA,OACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,OACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,OACA,OACA,QACA,OACA,MACA,MACA,MACA,MACA,MACA,MACA,OACA,OACA,MACA,MACA,MACA,MACA,MACA,SACA,QACA,MACA,MACA,SACA,KACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,KACA,MACA,MACA,OACA,MACA,OACA,MACA,MACA,KACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,OACA,OACA,MACA,MACA,MACA,OACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,OACA,MACA,OACA,MACA,MACA,OACA,OACA,OACA,MACA,MACA,MACA,WACA,OACA,MACA,MACA,UACA,SACA,MACA,SACA,OACA,OACA,QACA,MACA,MACA,MACA,MACA,OACA,MACA,OACA,MACA,MACA,MACA,QACA,MACA,OACA,OACA,OACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,MACA,OACA,MACA,QACA,MACA,MACA,MACA,QACA,MACA,OACA,MACA,O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","file":"static/js/7.6007da12.chunk.js","sourcesContent":["'use strict';\n\nfunction _inheritsLoose(subClass, superClass) { subClass.prototype = Object.create(superClass.prototype); subClass.prototype.constructor = subClass; subClass.__proto__ = superClass; }\n\nvar codes = {};\n\nfunction createErrorType(code, message, Base) {\n  if (!Base) {\n    Base = Error;\n  }\n\n  function getMessage(arg1, arg2, arg3) {\n    if (typeof message === 'string') {\n      return message;\n    } else {\n      return message(arg1, arg2, arg3);\n    }\n  }\n\n  var NodeError =\n  /*#__PURE__*/\n  function (_Base) {\n    _inheritsLoose(NodeError, _Base);\n\n    function NodeError(arg1, arg2, arg3) {\n      return _Base.call(this, getMessage(arg1, arg2, arg3)) || this;\n    }\n\n    return NodeError;\n  }(Base);\n\n  NodeError.prototype.name = Base.name;\n  NodeError.prototype.code = code;\n  codes[code] = NodeError;\n} // https://github.com/nodejs/node/blob/v10.8.0/lib/internal/errors.js\n\n\nfunction oneOf(expected, thing) {\n  if (Array.isArray(expected)) {\n    var len = expected.length;\n    expected = expected.map(function (i) {\n      return String(i);\n    });\n\n    if (len > 2) {\n      return \"one of \".concat(thing, \" \").concat(expected.slice(0, len - 1).join(', '), \", or \") + expected[len - 1];\n    } else if (len === 2) {\n      return \"one of \".concat(thing, \" \").concat(expected[0], \" or \").concat(expected[1]);\n    } else {\n      return \"of \".concat(thing, \" \").concat(expected[0]);\n    }\n  } else {\n    return \"of \".concat(thing, \" \").concat(String(expected));\n  }\n} // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/startsWith\n\n\nfunction startsWith(str, search, pos) {\n  return str.substr(!pos || pos < 0 ? 0 : +pos, search.length) === search;\n} // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/endsWith\n\n\nfunction endsWith(str, search, this_len) {\n  if (this_len === undefined || this_len > str.length) {\n    this_len = str.length;\n  }\n\n  return str.substring(this_len - search.length, this_len) === search;\n} // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/includes\n\n\nfunction includes(str, search, start) {\n  if (typeof start !== 'number') {\n    start = 0;\n  }\n\n  if (start + search.length > str.length) {\n    return false;\n  } else {\n    return str.indexOf(search, start) !== -1;\n  }\n}\n\ncreateErrorType('ERR_INVALID_OPT_VALUE', function (name, value) {\n  return 'The value \"' + value + '\" is invalid for option \"' + name + '\"';\n}, TypeError);\ncreateErrorType('ERR_INVALID_ARG_TYPE', function (name, expected, actual) {\n  // determiner: 'must be' or 'must not be'\n  var determiner;\n\n  if (typeof expected === 'string' && startsWith(expected, 'not ')) {\n    determiner = 'must not be';\n    expected = expected.replace(/^not /, '');\n  } else {\n    determiner = 'must be';\n  }\n\n  var msg;\n\n  if (endsWith(name, ' argument')) {\n    // For cases like 'first argument'\n    msg = \"The \".concat(name, \" \").concat(determiner, \" \").concat(oneOf(expected, 'type'));\n  } else {\n    var type = includes(name, '.') ? 'property' : 'argument';\n    msg = \"The \\\"\".concat(name, \"\\\" \").concat(type, \" \").concat(determiner, \" \").concat(oneOf(expected, 'type'));\n  }\n\n  msg += \". Received type \".concat(typeof actual);\n  return msg;\n}, TypeError);\ncreateErrorType('ERR_STREAM_PUSH_AFTER_EOF', 'stream.push() after EOF');\ncreateErrorType('ERR_METHOD_NOT_IMPLEMENTED', function (name) {\n  return 'The ' + name + ' method is not implemented';\n});\ncreateErrorType('ERR_STREAM_PREMATURE_CLOSE', 'Premature close');\ncreateErrorType('ERR_STREAM_DESTROYED', function (name) {\n  return 'Cannot call ' + name + ' after a stream was destroyed';\n});\ncreateErrorType('ERR_MULTIPLE_CALLBACK', 'Callback called multiple times');\ncreateErrorType('ERR_STREAM_CANNOT_PIPE', 'Cannot pipe, not readable');\ncreateErrorType('ERR_STREAM_WRITE_AFTER_END', 'write after end');\ncreateErrorType('ERR_STREAM_NULL_VALUES', 'May not write null values to stream', TypeError);\ncreateErrorType('ERR_UNKNOWN_ENCODING', function (arg) {\n  return 'Unknown encoding: ' + arg;\n}, TypeError);\ncreateErrorType('ERR_STREAM_UNSHIFT_AFTER_END_EVENT', 'stream.unshift() after end event');\nmodule.exports.codes = codes;\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n// a duplex stream is just a stream that is both readable and writable.\n// Since JS doesn't have multiple prototypal inheritance, this class\n// prototypally inherits from Readable, and then parasitically from\n// Writable.\n\n'use strict';\n\n/*<replacement>*/\nvar objectKeys = Object.keys || function (obj) {\n  var keys = [];\n  for (var key in obj) keys.push(key);\n  return keys;\n};\n/*</replacement>*/\n\nmodule.exports = Duplex;\nvar Readable = require('./_stream_readable');\nvar Writable = require('./_stream_writable');\nrequire('inherits')(Duplex, Readable);\n{\n  // Allow the keys array to be GC'ed.\n  var keys = objectKeys(Writable.prototype);\n  for (var v = 0; v < keys.length; v++) {\n    var method = keys[v];\n    if (!Duplex.prototype[method]) Duplex.prototype[method] = Writable.prototype[method];\n  }\n}\nfunction Duplex(options) {\n  if (!(this instanceof Duplex)) return new Duplex(options);\n  Readable.call(this, options);\n  Writable.call(this, options);\n  this.allowHalfOpen = true;\n  if (options) {\n    if (options.readable === false) this.readable = false;\n    if (options.writable === false) this.writable = false;\n    if (options.allowHalfOpen === false) {\n      this.allowHalfOpen = false;\n      this.once('end', onend);\n    }\n  }\n}\nObject.defineProperty(Duplex.prototype, 'writableHighWaterMark', {\n  // making it explicit this property is not enumerable\n  // because otherwise some prototype manipulation in\n  // userland will fail\n  enumerable: false,\n  get: function get() {\n    return this._writableState.highWaterMark;\n  }\n});\nObject.defineProperty(Duplex.prototype, 'writableBuffer', {\n  // making it explicit this property is not enumerable\n  // because otherwise some prototype manipulation in\n  // userland will fail\n  enumerable: false,\n  get: function get() {\n    return this._writableState && this._writableState.getBuffer();\n  }\n});\nObject.defineProperty(Duplex.prototype, 'writableLength', {\n  // making it explicit this property is not enumerable\n  // because otherwise some prototype manipulation in\n  // userland will fail\n  enumerable: false,\n  get: function get() {\n    return this._writableState.length;\n  }\n});\n\n// the no-half-open enforcer\nfunction onend() {\n  // If the writable side ended, then we're ok.\n  if (this._writableState.ended) return;\n\n  // no more data can be written.\n  // But allow more writes to happen in this tick.\n  process.nextTick(onEndNT, this);\n}\nfunction onEndNT(self) {\n  self.end();\n}\nObject.defineProperty(Duplex.prototype, 'destroyed', {\n  // making it explicit this property is not enumerable\n  // because otherwise some prototype manipulation in\n  // userland will fail\n  enumerable: false,\n  get: function get() {\n    if (this._readableState === undefined || this._writableState === undefined) {\n      return false;\n    }\n    return this._readableState.destroyed && this._writableState.destroyed;\n  },\n  set: function set(value) {\n    // we ignore the value if the stream\n    // has not been initialized yet\n    if (this._readableState === undefined || this._writableState === undefined) {\n      return;\n    }\n\n    // backward compatibility, the user is explicitly\n    // managing destroyed\n    this._readableState.destroyed = value;\n    this._writableState.destroyed = value;\n  }\n});","import _asyncToGenerator from '@babel/runtime/helpers/asyncToGenerator';\nimport _classCallCheck from '@babel/runtime/helpers/classCallCheck';\nimport _createClass from '@babel/runtime/helpers/createClass';\nimport _assertThisInitialized from '@babel/runtime/helpers/assertThisInitialized';\nimport _inherits from '@babel/runtime/helpers/inherits';\nimport _possibleConstructorReturn from '@babel/runtime/helpers/possibleConstructorReturn';\nimport _getPrototypeOf from '@babel/runtime/helpers/getPrototypeOf';\nimport _defineProperty from '@babel/runtime/helpers/defineProperty';\nimport _regeneratorRuntime from '@babel/runtime/regenerator';\nimport { WalletLoginError, saveToken, verifySignedChallenge, signChallenge, getSavedToken, checkIfTokenIsExpired, ADAPTER_STATUS, clearToken, BaseAdapter } from '@web3auth/base';\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\nvar BaseEvmAdapter = /*#__PURE__*/function (_BaseAdapter) {\n  _inherits(BaseEvmAdapter, _BaseAdapter);\n\n  var _super = _createSuper(BaseEvmAdapter);\n\n  function BaseEvmAdapter() {\n    var _this;\n\n    var params = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n    _classCallCheck(this, BaseEvmAdapter);\n\n    _this = _super.call(this);\n\n    _defineProperty(_assertThisInitialized(_this), \"clientId\", void 0);\n\n    _this.clientId = params.clientId;\n    return _this;\n  }\n\n  _createClass(BaseEvmAdapter, [{\n    key: \"authenticateUser\",\n    value: function () {\n      var _authenticateUser = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        var _this$chainConfig;\n\n        var _this$chainConfig2, chainNamespace, chainId, accounts, existingToken, isExpired, payload, challenge, signedMessage, idToken;\n\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                if (!(!this.provider || !((_this$chainConfig = this.chainConfig) !== null && _this$chainConfig !== void 0 && _this$chainConfig.chainId))) {\n                  _context.next = 2;\n                  break;\n                }\n\n                throw WalletLoginError.notConnectedError();\n\n              case 2:\n                _this$chainConfig2 = this.chainConfig, chainNamespace = _this$chainConfig2.chainNamespace, chainId = _this$chainConfig2.chainId;\n\n                if (!(this.status !== ADAPTER_STATUS.CONNECTED)) {\n                  _context.next = 5;\n                  break;\n                }\n\n                throw WalletLoginError.notConnectedError(\"Not connected with wallet, Please login/connect first\");\n\n              case 5:\n                _context.next = 7;\n                return this.provider.request({\n                  method: \"eth_accounts\"\n                });\n\n              case 7:\n                accounts = _context.sent;\n\n                if (!(accounts && accounts.length > 0)) {\n                  _context.next = 26;\n                  break;\n                }\n\n                existingToken = getSavedToken(accounts[0], this.name);\n\n                if (!existingToken) {\n                  _context.next = 14;\n                  break;\n                }\n\n                isExpired = checkIfTokenIsExpired(existingToken);\n\n                if (isExpired) {\n                  _context.next = 14;\n                  break;\n                }\n\n                return _context.abrupt(\"return\", {\n                  idToken: existingToken\n                });\n\n              case 14:\n                payload = {\n                  domain: window.location.origin,\n                  uri: window.location.href,\n                  address: accounts[0],\n                  chainId: parseInt(chainId, 16),\n                  version: \"1\",\n                  nonce: Math.random().toString(36).slice(2),\n                  issuedAt: new Date().toISOString()\n                };\n                _context.next = 17;\n                return signChallenge(payload, chainNamespace);\n\n              case 17:\n                challenge = _context.sent;\n                _context.next = 20;\n                return this.provider.request({\n                  method: \"personal_sign\",\n                  params: [challenge, accounts[0]]\n                });\n\n              case 20:\n                signedMessage = _context.sent;\n                _context.next = 23;\n                return verifySignedChallenge(chainNamespace, signedMessage, challenge, this.name, this.sessionTime, this.clientId);\n\n              case 23:\n                idToken = _context.sent;\n                saveToken(accounts[0], this.name, idToken);\n                return _context.abrupt(\"return\", {\n                  idToken: idToken\n                });\n\n              case 26:\n                throw WalletLoginError.notConnectedError(\"Not connected with wallet, Please login/connect first\");\n\n              case 27:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function authenticateUser() {\n        return _authenticateUser.apply(this, arguments);\n      }\n\n      return authenticateUser;\n    }()\n  }, {\n    key: \"disconnect\",\n    value: function () {\n      var _disconnect = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n        var accounts;\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                if (!(this.status !== ADAPTER_STATUS.CONNECTED)) {\n                  _context2.next = 2;\n                  break;\n                }\n\n                throw WalletLoginError.disconnectionError(\"Not connected with wallet\");\n\n              case 2:\n                _context2.next = 4;\n                return this.provider.request({\n                  method: \"eth_accounts\"\n                });\n\n              case 4:\n                accounts = _context2.sent;\n\n                if (accounts && accounts.length > 0) {\n                  clearToken(accounts[0], this.name);\n                }\n\n              case 6:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function disconnect() {\n        return _disconnect.apply(this, arguments);\n      }\n\n      return disconnect;\n    }()\n  }]);\n\n  return BaseEvmAdapter;\n}(BaseAdapter);\n\nexport { BaseEvmAdapter };\n//# sourceMappingURL=baseEvmAdapter.esm.js.map\n","var objectWithoutPropertiesLoose = require(\"./objectWithoutPropertiesLoose.js\");\nfunction _objectWithoutProperties(source, excluded) {\n  if (source == null) return {};\n  var target = objectWithoutPropertiesLoose(source, excluded);\n  var key, i;\n  if (Object.getOwnPropertySymbols) {\n    var sourceSymbolKeys = Object.getOwnPropertySymbols(source);\n    for (i = 0; i < sourceSymbolKeys.length; i++) {\n      key = sourceSymbolKeys[i];\n      if (excluded.indexOf(key) >= 0) continue;\n      if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;\n      target[key] = source[key];\n    }\n  }\n  return target;\n}\nmodule.exports = _objectWithoutProperties, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n  return target;\n}\nmodule.exports = _objectWithoutPropertiesLoose, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","// Ported from https://github.com/mafintosh/end-of-stream with\n// permission from the author, Mathias Buus (@mafintosh).\n\n'use strict';\n\nvar ERR_STREAM_PREMATURE_CLOSE = require('../../../errors').codes.ERR_STREAM_PREMATURE_CLOSE;\nfunction once(callback) {\n  var called = false;\n  return function () {\n    if (called) return;\n    called = true;\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n    callback.apply(this, args);\n  };\n}\nfunction noop() {}\nfunction isRequest(stream) {\n  return stream.setHeader && typeof stream.abort === 'function';\n}\nfunction eos(stream, opts, callback) {\n  if (typeof opts === 'function') return eos(stream, null, opts);\n  if (!opts) opts = {};\n  callback = once(callback || noop);\n  var readable = opts.readable || opts.readable !== false && stream.readable;\n  var writable = opts.writable || opts.writable !== false && stream.writable;\n  var onlegacyfinish = function onlegacyfinish() {\n    if (!stream.writable) onfinish();\n  };\n  var writableEnded = stream._writableState && stream._writableState.finished;\n  var onfinish = function onfinish() {\n    writable = false;\n    writableEnded = true;\n    if (!readable) callback.call(stream);\n  };\n  var readableEnded = stream._readableState && stream._readableState.endEmitted;\n  var onend = function onend() {\n    readable = false;\n    readableEnded = true;\n    if (!writable) callback.call(stream);\n  };\n  var onerror = function onerror(err) {\n    callback.call(stream, err);\n  };\n  var onclose = function onclose() {\n    var err;\n    if (readable && !readableEnded) {\n      if (!stream._readableState || !stream._readableState.ended) err = new ERR_STREAM_PREMATURE_CLOSE();\n      return callback.call(stream, err);\n    }\n    if (writable && !writableEnded) {\n      if (!stream._writableState || !stream._writableState.ended) err = new ERR_STREAM_PREMATURE_CLOSE();\n      return callback.call(stream, err);\n    }\n  };\n  var onrequest = function onrequest() {\n    stream.req.on('finish', onfinish);\n  };\n  if (isRequest(stream)) {\n    stream.on('complete', onfinish);\n    stream.on('abort', onclose);\n    if (stream.req) onrequest();else stream.on('request', onrequest);\n  } else if (writable && !stream._writableState) {\n    // legacy streams\n    stream.on('end', onlegacyfinish);\n    stream.on('close', onlegacyfinish);\n  }\n  stream.on('end', onend);\n  stream.on('finish', onfinish);\n  if (opts.error !== false) stream.on('error', onerror);\n  stream.on('close', onclose);\n  return function () {\n    stream.removeListener('complete', onfinish);\n    stream.removeListener('abort', onclose);\n    stream.removeListener('request', onrequest);\n    if (stream.req) stream.req.removeListener('finish', onfinish);\n    stream.removeListener('end', onlegacyfinish);\n    stream.removeListener('close', onlegacyfinish);\n    stream.removeListener('finish', onfinish);\n    stream.removeListener('end', onend);\n    stream.removeListener('error', onerror);\n    stream.removeListener('close', onclose);\n  };\n}\nmodule.exports = eos;","import SafeEventEmitter from '@metamask/safe-event-emitter';\n\nexport class ObservableStore<T> extends SafeEventEmitter {\n  private _state: T;\n\n  constructor(initState: T) {\n    super();\n    if (initState) {\n      this._state = initState;\n    } else {\n      // Typecast/default state: Preserve existing behavior\n      this._state = {} as unknown as T;\n    }\n  }\n\n  // wrapper around internal getState\n  getState(): T {\n    return this._getState();\n  }\n\n  // wrapper around internal putState\n  putState(newState: T): void {\n    this._putState(newState);\n    this.emit('update', newState);\n  }\n\n  updateState(partialState: Partial<T>): void {\n    // if non-null object, merge\n    if (partialState && typeof partialState === 'object') {\n      const state = this.getState();\n      this.putState({ ...state, ...partialState });\n      // if not object, use new value\n    } else {\n      this.putState(partialState);\n    }\n  }\n\n  // subscribe to changes\n  subscribe(handler: (state: T) => void): void {\n    this.on('update', handler);\n  }\n\n  // unsubscribe to changes\n  unsubscribe(handler: (state: T) => void): void {\n    this.removeListener('update', handler);\n  }\n\n  //\n  // private\n  //\n\n  // read from persistence\n  protected _getState(): T {\n    return this._state;\n  }\n\n  // write to persistence\n  protected _putState(newState: T): void {\n    this._state = newState;\n  }\n}\n","'use strict';\n\n// do not edit .js files directly - edit src/index.jst\n\n\n\nmodule.exports = function equal(a, b) {\n  if (a === b) return true;\n\n  if (a && b && typeof a == 'object' && typeof b == 'object') {\n    if (a.constructor !== b.constructor) return false;\n\n    var length, i, keys;\n    if (Array.isArray(a)) {\n      length = a.length;\n      if (length != b.length) return false;\n      for (i = length; i-- !== 0;)\n        if (!equal(a[i], b[i])) return false;\n      return true;\n    }\n\n\n\n    if (a.constructor === RegExp) return a.source === b.source && a.flags === b.flags;\n    if (a.valueOf !== Object.prototype.valueOf) return a.valueOf() === b.valueOf();\n    if (a.toString !== Object.prototype.toString) return a.toString() === b.toString();\n\n    keys = Object.keys(a);\n    length = keys.length;\n    if (length !== Object.keys(b).length) return false;\n\n    for (i = length; i-- !== 0;)\n      if (!Object.prototype.hasOwnProperty.call(b, keys[i])) return false;\n\n    for (i = length; i-- !== 0;) {\n      var key = keys[i];\n\n      if (!equal(a[key], b[key])) return false;\n    }\n\n    return true;\n  }\n\n  // true if both NaN, false otherwise\n  return a!==a && b!==b;\n};\n","'use strict';\n\nconst isStream = stream =>\n\tstream !== null &&\n\ttypeof stream === 'object' &&\n\ttypeof stream.pipe === 'function';\n\nisStream.writable = stream =>\n\tisStream(stream) &&\n\tstream.writable !== false &&\n\ttypeof stream._write === 'function' &&\n\ttypeof stream._writableState === 'object';\n\nisStream.readable = stream =>\n\tisStream(stream) &&\n\tstream.readable !== false &&\n\ttypeof stream._read === 'function' &&\n\ttypeof stream._readableState === 'object';\n\nisStream.duplex = stream =>\n\tisStream.writable(stream) &&\n\tisStream.readable(stream);\n\nisStream.transform = stream =>\n\tisStream.duplex(stream) &&\n\ttypeof stream._transform === 'function';\n\nmodule.exports = isStream;\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n'use strict';\n\nmodule.exports = Readable;\n\n/*<replacement>*/\nvar Duplex;\n/*</replacement>*/\n\nReadable.ReadableState = ReadableState;\n\n/*<replacement>*/\nvar EE = require('events').EventEmitter;\nvar EElistenerCount = function EElistenerCount(emitter, type) {\n  return emitter.listeners(type).length;\n};\n/*</replacement>*/\n\n/*<replacement>*/\nvar Stream = require('./internal/streams/stream');\n/*</replacement>*/\n\nvar Buffer = require('buffer').Buffer;\nvar OurUint8Array = (typeof global !== 'undefined' ? global : typeof window !== 'undefined' ? window : typeof self !== 'undefined' ? self : {}).Uint8Array || function () {};\nfunction _uint8ArrayToBuffer(chunk) {\n  return Buffer.from(chunk);\n}\nfunction _isUint8Array(obj) {\n  return Buffer.isBuffer(obj) || obj instanceof OurUint8Array;\n}\n\n/*<replacement>*/\nvar debugUtil = require('util');\nvar debug;\nif (debugUtil && debugUtil.debuglog) {\n  debug = debugUtil.debuglog('stream');\n} else {\n  debug = function debug() {};\n}\n/*</replacement>*/\n\nvar BufferList = require('./internal/streams/buffer_list');\nvar destroyImpl = require('./internal/streams/destroy');\nvar _require = require('./internal/streams/state'),\n  getHighWaterMark = _require.getHighWaterMark;\nvar _require$codes = require('../errors').codes,\n  ERR_INVALID_ARG_TYPE = _require$codes.ERR_INVALID_ARG_TYPE,\n  ERR_STREAM_PUSH_AFTER_EOF = _require$codes.ERR_STREAM_PUSH_AFTER_EOF,\n  ERR_METHOD_NOT_IMPLEMENTED = _require$codes.ERR_METHOD_NOT_IMPLEMENTED,\n  ERR_STREAM_UNSHIFT_AFTER_END_EVENT = _require$codes.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;\n\n// Lazy loaded to improve the startup performance.\nvar StringDecoder;\nvar createReadableStreamAsyncIterator;\nvar from;\nrequire('inherits')(Readable, Stream);\nvar errorOrDestroy = destroyImpl.errorOrDestroy;\nvar kProxyEvents = ['error', 'close', 'destroy', 'pause', 'resume'];\nfunction prependListener(emitter, event, fn) {\n  // Sadly this is not cacheable as some libraries bundle their own\n  // event emitter implementation with them.\n  if (typeof emitter.prependListener === 'function') return emitter.prependListener(event, fn);\n\n  // This is a hack to make sure that our error handler is attached before any\n  // userland ones.  NEVER DO THIS. This is here only because this code needs\n  // to continue to work with older versions of Node.js that do not include\n  // the prependListener() method. The goal is to eventually remove this hack.\n  if (!emitter._events || !emitter._events[event]) emitter.on(event, fn);else if (Array.isArray(emitter._events[event])) emitter._events[event].unshift(fn);else emitter._events[event] = [fn, emitter._events[event]];\n}\nfunction ReadableState(options, stream, isDuplex) {\n  Duplex = Duplex || require('./_stream_duplex');\n  options = options || {};\n\n  // Duplex streams are both readable and writable, but share\n  // the same options object.\n  // However, some cases require setting options to different\n  // values for the readable and the writable sides of the duplex stream.\n  // These options can be provided separately as readableXXX and writableXXX.\n  if (typeof isDuplex !== 'boolean') isDuplex = stream instanceof Duplex;\n\n  // object stream flag. Used to make read(n) ignore n and to\n  // make all the buffer merging and length checks go away\n  this.objectMode = !!options.objectMode;\n  if (isDuplex) this.objectMode = this.objectMode || !!options.readableObjectMode;\n\n  // the point at which it stops calling _read() to fill the buffer\n  // Note: 0 is a valid value, means \"don't call _read preemptively ever\"\n  this.highWaterMark = getHighWaterMark(this, options, 'readableHighWaterMark', isDuplex);\n\n  // A linked list is used to store data chunks instead of an array because the\n  // linked list can remove elements from the beginning faster than\n  // array.shift()\n  this.buffer = new BufferList();\n  this.length = 0;\n  this.pipes = null;\n  this.pipesCount = 0;\n  this.flowing = null;\n  this.ended = false;\n  this.endEmitted = false;\n  this.reading = false;\n\n  // a flag to be able to tell if the event 'readable'/'data' is emitted\n  // immediately, or on a later tick.  We set this to true at first, because\n  // any actions that shouldn't happen until \"later\" should generally also\n  // not happen before the first read call.\n  this.sync = true;\n\n  // whenever we return null, then we set a flag to say\n  // that we're awaiting a 'readable' event emission.\n  this.needReadable = false;\n  this.emittedReadable = false;\n  this.readableListening = false;\n  this.resumeScheduled = false;\n  this.paused = true;\n\n  // Should close be emitted on destroy. Defaults to true.\n  this.emitClose = options.emitClose !== false;\n\n  // Should .destroy() be called after 'end' (and potentially 'finish')\n  this.autoDestroy = !!options.autoDestroy;\n\n  // has it been destroyed\n  this.destroyed = false;\n\n  // Crypto is kind of old and crusty.  Historically, its default string\n  // encoding is 'binary' so we have to make this configurable.\n  // Everything else in the universe uses 'utf8', though.\n  this.defaultEncoding = options.defaultEncoding || 'utf8';\n\n  // the number of writers that are awaiting a drain event in .pipe()s\n  this.awaitDrain = 0;\n\n  // if true, a maybeReadMore has been scheduled\n  this.readingMore = false;\n  this.decoder = null;\n  this.encoding = null;\n  if (options.encoding) {\n    if (!StringDecoder) StringDecoder = require('string_decoder/').StringDecoder;\n    this.decoder = new StringDecoder(options.encoding);\n    this.encoding = options.encoding;\n  }\n}\nfunction Readable(options) {\n  Duplex = Duplex || require('./_stream_duplex');\n  if (!(this instanceof Readable)) return new Readable(options);\n\n  // Checking for a Stream.Duplex instance is faster here instead of inside\n  // the ReadableState constructor, at least with V8 6.5\n  var isDuplex = this instanceof Duplex;\n  this._readableState = new ReadableState(options, this, isDuplex);\n\n  // legacy\n  this.readable = true;\n  if (options) {\n    if (typeof options.read === 'function') this._read = options.read;\n    if (typeof options.destroy === 'function') this._destroy = options.destroy;\n  }\n  Stream.call(this);\n}\nObject.defineProperty(Readable.prototype, 'destroyed', {\n  // making it explicit this property is not enumerable\n  // because otherwise some prototype manipulation in\n  // userland will fail\n  enumerable: false,\n  get: function get() {\n    if (this._readableState === undefined) {\n      return false;\n    }\n    return this._readableState.destroyed;\n  },\n  set: function set(value) {\n    // we ignore the value if the stream\n    // has not been initialized yet\n    if (!this._readableState) {\n      return;\n    }\n\n    // backward compatibility, the user is explicitly\n    // managing destroyed\n    this._readableState.destroyed = value;\n  }\n});\nReadable.prototype.destroy = destroyImpl.destroy;\nReadable.prototype._undestroy = destroyImpl.undestroy;\nReadable.prototype._destroy = function (err, cb) {\n  cb(err);\n};\n\n// Manually shove something into the read() buffer.\n// This returns true if the highWaterMark has not been hit yet,\n// similar to how Writable.write() returns true if you should\n// write() some more.\nReadable.prototype.push = function (chunk, encoding) {\n  var state = this._readableState;\n  var skipChunkCheck;\n  if (!state.objectMode) {\n    if (typeof chunk === 'string') {\n      encoding = encoding || state.defaultEncoding;\n      if (encoding !== state.encoding) {\n        chunk = Buffer.from(chunk, encoding);\n        encoding = '';\n      }\n      skipChunkCheck = true;\n    }\n  } else {\n    skipChunkCheck = true;\n  }\n  return readableAddChunk(this, chunk, encoding, false, skipChunkCheck);\n};\n\n// Unshift should *always* be something directly out of read()\nReadable.prototype.unshift = function (chunk) {\n  return readableAddChunk(this, chunk, null, true, false);\n};\nfunction readableAddChunk(stream, chunk, encoding, addToFront, skipChunkCheck) {\n  debug('readableAddChunk', chunk);\n  var state = stream._readableState;\n  if (chunk === null) {\n    state.reading = false;\n    onEofChunk(stream, state);\n  } else {\n    var er;\n    if (!skipChunkCheck) er = chunkInvalid(state, chunk);\n    if (er) {\n      errorOrDestroy(stream, er);\n    } else if (state.objectMode || chunk && chunk.length > 0) {\n      if (typeof chunk !== 'string' && !state.objectMode && Object.getPrototypeOf(chunk) !== Buffer.prototype) {\n        chunk = _uint8ArrayToBuffer(chunk);\n      }\n      if (addToFront) {\n        if (state.endEmitted) errorOrDestroy(stream, new ERR_STREAM_UNSHIFT_AFTER_END_EVENT());else addChunk(stream, state, chunk, true);\n      } else if (state.ended) {\n        errorOrDestroy(stream, new ERR_STREAM_PUSH_AFTER_EOF());\n      } else if (state.destroyed) {\n        return false;\n      } else {\n        state.reading = false;\n        if (state.decoder && !encoding) {\n          chunk = state.decoder.write(chunk);\n          if (state.objectMode || chunk.length !== 0) addChunk(stream, state, chunk, false);else maybeReadMore(stream, state);\n        } else {\n          addChunk(stream, state, chunk, false);\n        }\n      }\n    } else if (!addToFront) {\n      state.reading = false;\n      maybeReadMore(stream, state);\n    }\n  }\n\n  // We can push more data if we are below the highWaterMark.\n  // Also, if we have no data yet, we can stand some more bytes.\n  // This is to work around cases where hwm=0, such as the repl.\n  return !state.ended && (state.length < state.highWaterMark || state.length === 0);\n}\nfunction addChunk(stream, state, chunk, addToFront) {\n  if (state.flowing && state.length === 0 && !state.sync) {\n    state.awaitDrain = 0;\n    stream.emit('data', chunk);\n  } else {\n    // update the buffer info.\n    state.length += state.objectMode ? 1 : chunk.length;\n    if (addToFront) state.buffer.unshift(chunk);else state.buffer.push(chunk);\n    if (state.needReadable) emitReadable(stream);\n  }\n  maybeReadMore(stream, state);\n}\nfunction chunkInvalid(state, chunk) {\n  var er;\n  if (!_isUint8Array(chunk) && typeof chunk !== 'string' && chunk !== undefined && !state.objectMode) {\n    er = new ERR_INVALID_ARG_TYPE('chunk', ['string', 'Buffer', 'Uint8Array'], chunk);\n  }\n  return er;\n}\nReadable.prototype.isPaused = function () {\n  return this._readableState.flowing === false;\n};\n\n// backwards compatibility.\nReadable.prototype.setEncoding = function (enc) {\n  if (!StringDecoder) StringDecoder = require('string_decoder/').StringDecoder;\n  var decoder = new StringDecoder(enc);\n  this._readableState.decoder = decoder;\n  // If setEncoding(null), decoder.encoding equals utf8\n  this._readableState.encoding = this._readableState.decoder.encoding;\n\n  // Iterate over current buffer to convert already stored Buffers:\n  var p = this._readableState.buffer.head;\n  var content = '';\n  while (p !== null) {\n    content += decoder.write(p.data);\n    p = p.next;\n  }\n  this._readableState.buffer.clear();\n  if (content !== '') this._readableState.buffer.push(content);\n  this._readableState.length = content.length;\n  return this;\n};\n\n// Don't raise the hwm > 1GB\nvar MAX_HWM = 0x40000000;\nfunction computeNewHighWaterMark(n) {\n  if (n >= MAX_HWM) {\n    // TODO(ronag): Throw ERR_VALUE_OUT_OF_RANGE.\n    n = MAX_HWM;\n  } else {\n    // Get the next highest power of 2 to prevent increasing hwm excessively in\n    // tiny amounts\n    n--;\n    n |= n >>> 1;\n    n |= n >>> 2;\n    n |= n >>> 4;\n    n |= n >>> 8;\n    n |= n >>> 16;\n    n++;\n  }\n  return n;\n}\n\n// This function is designed to be inlinable, so please take care when making\n// changes to the function body.\nfunction howMuchToRead(n, state) {\n  if (n <= 0 || state.length === 0 && state.ended) return 0;\n  if (state.objectMode) return 1;\n  if (n !== n) {\n    // Only flow one buffer at a time\n    if (state.flowing && state.length) return state.buffer.head.data.length;else return state.length;\n  }\n  // If we're asking for more than the current hwm, then raise the hwm.\n  if (n > state.highWaterMark) state.highWaterMark = computeNewHighWaterMark(n);\n  if (n <= state.length) return n;\n  // Don't have enough\n  if (!state.ended) {\n    state.needReadable = true;\n    return 0;\n  }\n  return state.length;\n}\n\n// you can override either this method, or the async _read(n) below.\nReadable.prototype.read = function (n) {\n  debug('read', n);\n  n = parseInt(n, 10);\n  var state = this._readableState;\n  var nOrig = n;\n  if (n !== 0) state.emittedReadable = false;\n\n  // if we're doing read(0) to trigger a readable event, but we\n  // already have a bunch of data in the buffer, then just trigger\n  // the 'readable' event and move on.\n  if (n === 0 && state.needReadable && ((state.highWaterMark !== 0 ? state.length >= state.highWaterMark : state.length > 0) || state.ended)) {\n    debug('read: emitReadable', state.length, state.ended);\n    if (state.length === 0 && state.ended) endReadable(this);else emitReadable(this);\n    return null;\n  }\n  n = howMuchToRead(n, state);\n\n  // if we've ended, and we're now clear, then finish it up.\n  if (n === 0 && state.ended) {\n    if (state.length === 0) endReadable(this);\n    return null;\n  }\n\n  // All the actual chunk generation logic needs to be\n  // *below* the call to _read.  The reason is that in certain\n  // synthetic stream cases, such as passthrough streams, _read\n  // may be a completely synchronous operation which may change\n  // the state of the read buffer, providing enough data when\n  // before there was *not* enough.\n  //\n  // So, the steps are:\n  // 1. Figure out what the state of things will be after we do\n  // a read from the buffer.\n  //\n  // 2. If that resulting state will trigger a _read, then call _read.\n  // Note that this may be asynchronous, or synchronous.  Yes, it is\n  // deeply ugly to write APIs this way, but that still doesn't mean\n  // that the Readable class should behave improperly, as streams are\n  // designed to be sync/async agnostic.\n  // Take note if the _read call is sync or async (ie, if the read call\n  // has returned yet), so that we know whether or not it's safe to emit\n  // 'readable' etc.\n  //\n  // 3. Actually pull the requested chunks out of the buffer and return.\n\n  // if we need a readable event, then we need to do some reading.\n  var doRead = state.needReadable;\n  debug('need readable', doRead);\n\n  // if we currently have less than the highWaterMark, then also read some\n  if (state.length === 0 || state.length - n < state.highWaterMark) {\n    doRead = true;\n    debug('length less than watermark', doRead);\n  }\n\n  // however, if we've ended, then there's no point, and if we're already\n  // reading, then it's unnecessary.\n  if (state.ended || state.reading) {\n    doRead = false;\n    debug('reading or ended', doRead);\n  } else if (doRead) {\n    debug('do read');\n    state.reading = true;\n    state.sync = true;\n    // if the length is currently zero, then we *need* a readable event.\n    if (state.length === 0) state.needReadable = true;\n    // call internal read method\n    this._read(state.highWaterMark);\n    state.sync = false;\n    // If _read pushed data synchronously, then `reading` will be false,\n    // and we need to re-evaluate how much data we can return to the user.\n    if (!state.reading) n = howMuchToRead(nOrig, state);\n  }\n  var ret;\n  if (n > 0) ret = fromList(n, state);else ret = null;\n  if (ret === null) {\n    state.needReadable = state.length <= state.highWaterMark;\n    n = 0;\n  } else {\n    state.length -= n;\n    state.awaitDrain = 0;\n  }\n  if (state.length === 0) {\n    // If we have nothing in the buffer, then we want to know\n    // as soon as we *do* get something into the buffer.\n    if (!state.ended) state.needReadable = true;\n\n    // If we tried to read() past the EOF, then emit end on the next tick.\n    if (nOrig !== n && state.ended) endReadable(this);\n  }\n  if (ret !== null) this.emit('data', ret);\n  return ret;\n};\nfunction onEofChunk(stream, state) {\n  debug('onEofChunk');\n  if (state.ended) return;\n  if (state.decoder) {\n    var chunk = state.decoder.end();\n    if (chunk && chunk.length) {\n      state.buffer.push(chunk);\n      state.length += state.objectMode ? 1 : chunk.length;\n    }\n  }\n  state.ended = true;\n  if (state.sync) {\n    // if we are sync, wait until next tick to emit the data.\n    // Otherwise we risk emitting data in the flow()\n    // the readable code triggers during a read() call\n    emitReadable(stream);\n  } else {\n    // emit 'readable' now to make sure it gets picked up.\n    state.needReadable = false;\n    if (!state.emittedReadable) {\n      state.emittedReadable = true;\n      emitReadable_(stream);\n    }\n  }\n}\n\n// Don't emit readable right away in sync mode, because this can trigger\n// another read() call => stack overflow.  This way, it might trigger\n// a nextTick recursion warning, but that's not so bad.\nfunction emitReadable(stream) {\n  var state = stream._readableState;\n  debug('emitReadable', state.needReadable, state.emittedReadable);\n  state.needReadable = false;\n  if (!state.emittedReadable) {\n    debug('emitReadable', state.flowing);\n    state.emittedReadable = true;\n    process.nextTick(emitReadable_, stream);\n  }\n}\nfunction emitReadable_(stream) {\n  var state = stream._readableState;\n  debug('emitReadable_', state.destroyed, state.length, state.ended);\n  if (!state.destroyed && (state.length || state.ended)) {\n    stream.emit('readable');\n    state.emittedReadable = false;\n  }\n\n  // The stream needs another readable event if\n  // 1. It is not flowing, as the flow mechanism will take\n  //    care of it.\n  // 2. It is not ended.\n  // 3. It is below the highWaterMark, so we can schedule\n  //    another readable later.\n  state.needReadable = !state.flowing && !state.ended && state.length <= state.highWaterMark;\n  flow(stream);\n}\n\n// at this point, the user has presumably seen the 'readable' event,\n// and called read() to consume some data.  that may have triggered\n// in turn another _read(n) call, in which case reading = true if\n// it's in progress.\n// However, if we're not ended, or reading, and the length < hwm,\n// then go ahead and try to read some more preemptively.\nfunction maybeReadMore(stream, state) {\n  if (!state.readingMore) {\n    state.readingMore = true;\n    process.nextTick(maybeReadMore_, stream, state);\n  }\n}\nfunction maybeReadMore_(stream, state) {\n  // Attempt to read more data if we should.\n  //\n  // The conditions for reading more data are (one of):\n  // - Not enough data buffered (state.length < state.highWaterMark). The loop\n  //   is responsible for filling the buffer with enough data if such data\n  //   is available. If highWaterMark is 0 and we are not in the flowing mode\n  //   we should _not_ attempt to buffer any extra data. We'll get more data\n  //   when the stream consumer calls read() instead.\n  // - No data in the buffer, and the stream is in flowing mode. In this mode\n  //   the loop below is responsible for ensuring read() is called. Failing to\n  //   call read here would abort the flow and there's no other mechanism for\n  //   continuing the flow if the stream consumer has just subscribed to the\n  //   'data' event.\n  //\n  // In addition to the above conditions to keep reading data, the following\n  // conditions prevent the data from being read:\n  // - The stream has ended (state.ended).\n  // - There is already a pending 'read' operation (state.reading). This is a\n  //   case where the the stream has called the implementation defined _read()\n  //   method, but they are processing the call asynchronously and have _not_\n  //   called push() with new data. In this case we skip performing more\n  //   read()s. The execution ends in this method again after the _read() ends\n  //   up calling push() with more data.\n  while (!state.reading && !state.ended && (state.length < state.highWaterMark || state.flowing && state.length === 0)) {\n    var len = state.length;\n    debug('maybeReadMore read 0');\n    stream.read(0);\n    if (len === state.length)\n      // didn't get any data, stop spinning.\n      break;\n  }\n  state.readingMore = false;\n}\n\n// abstract method.  to be overridden in specific implementation classes.\n// call cb(er, data) where data is <= n in length.\n// for virtual (non-string, non-buffer) streams, \"length\" is somewhat\n// arbitrary, and perhaps not very meaningful.\nReadable.prototype._read = function (n) {\n  errorOrDestroy(this, new ERR_METHOD_NOT_IMPLEMENTED('_read()'));\n};\nReadable.prototype.pipe = function (dest, pipeOpts) {\n  var src = this;\n  var state = this._readableState;\n  switch (state.pipesCount) {\n    case 0:\n      state.pipes = dest;\n      break;\n    case 1:\n      state.pipes = [state.pipes, dest];\n      break;\n    default:\n      state.pipes.push(dest);\n      break;\n  }\n  state.pipesCount += 1;\n  debug('pipe count=%d opts=%j', state.pipesCount, pipeOpts);\n  var doEnd = (!pipeOpts || pipeOpts.end !== false) && dest !== process.stdout && dest !== process.stderr;\n  var endFn = doEnd ? onend : unpipe;\n  if (state.endEmitted) process.nextTick(endFn);else src.once('end', endFn);\n  dest.on('unpipe', onunpipe);\n  function onunpipe(readable, unpipeInfo) {\n    debug('onunpipe');\n    if (readable === src) {\n      if (unpipeInfo && unpipeInfo.hasUnpiped === false) {\n        unpipeInfo.hasUnpiped = true;\n        cleanup();\n      }\n    }\n  }\n  function onend() {\n    debug('onend');\n    dest.end();\n  }\n\n  // when the dest drains, it reduces the awaitDrain counter\n  // on the source.  This would be more elegant with a .once()\n  // handler in flow(), but adding and removing repeatedly is\n  // too slow.\n  var ondrain = pipeOnDrain(src);\n  dest.on('drain', ondrain);\n  var cleanedUp = false;\n  function cleanup() {\n    debug('cleanup');\n    // cleanup event handlers once the pipe is broken\n    dest.removeListener('close', onclose);\n    dest.removeListener('finish', onfinish);\n    dest.removeListener('drain', ondrain);\n    dest.removeListener('error', onerror);\n    dest.removeListener('unpipe', onunpipe);\n    src.removeListener('end', onend);\n    src.removeListener('end', unpipe);\n    src.removeListener('data', ondata);\n    cleanedUp = true;\n\n    // if the reader is waiting for a drain event from this\n    // specific writer, then it would cause it to never start\n    // flowing again.\n    // So, if this is awaiting a drain, then we just call it now.\n    // If we don't know, then assume that we are waiting for one.\n    if (state.awaitDrain && (!dest._writableState || dest._writableState.needDrain)) ondrain();\n  }\n  src.on('data', ondata);\n  function ondata(chunk) {\n    debug('ondata');\n    var ret = dest.write(chunk);\n    debug('dest.write', ret);\n    if (ret === false) {\n      // If the user unpiped during `dest.write()`, it is possible\n      // to get stuck in a permanently paused state if that write\n      // also returned false.\n      // => Check whether `dest` is still a piping destination.\n      if ((state.pipesCount === 1 && state.pipes === dest || state.pipesCount > 1 && indexOf(state.pipes, dest) !== -1) && !cleanedUp) {\n        debug('false write response, pause', state.awaitDrain);\n        state.awaitDrain++;\n      }\n      src.pause();\n    }\n  }\n\n  // if the dest has an error, then stop piping into it.\n  // however, don't suppress the throwing behavior for this.\n  function onerror(er) {\n    debug('onerror', er);\n    unpipe();\n    dest.removeListener('error', onerror);\n    if (EElistenerCount(dest, 'error') === 0) errorOrDestroy(dest, er);\n  }\n\n  // Make sure our error handler is attached before userland ones.\n  prependListener(dest, 'error', onerror);\n\n  // Both close and finish should trigger unpipe, but only once.\n  function onclose() {\n    dest.removeListener('finish', onfinish);\n    unpipe();\n  }\n  dest.once('close', onclose);\n  function onfinish() {\n    debug('onfinish');\n    dest.removeListener('close', onclose);\n    unpipe();\n  }\n  dest.once('finish', onfinish);\n  function unpipe() {\n    debug('unpipe');\n    src.unpipe(dest);\n  }\n\n  // tell the dest that it's being piped to\n  dest.emit('pipe', src);\n\n  // start the flow if it hasn't been started already.\n  if (!state.flowing) {\n    debug('pipe resume');\n    src.resume();\n  }\n  return dest;\n};\nfunction pipeOnDrain(src) {\n  return function pipeOnDrainFunctionResult() {\n    var state = src._readableState;\n    debug('pipeOnDrain', state.awaitDrain);\n    if (state.awaitDrain) state.awaitDrain--;\n    if (state.awaitDrain === 0 && EElistenerCount(src, 'data')) {\n      state.flowing = true;\n      flow(src);\n    }\n  };\n}\nReadable.prototype.unpipe = function (dest) {\n  var state = this._readableState;\n  var unpipeInfo = {\n    hasUnpiped: false\n  };\n\n  // if we're not piping anywhere, then do nothing.\n  if (state.pipesCount === 0) return this;\n\n  // just one destination.  most common case.\n  if (state.pipesCount === 1) {\n    // passed in one, but it's not the right one.\n    if (dest && dest !== state.pipes) return this;\n    if (!dest) dest = state.pipes;\n\n    // got a match.\n    state.pipes = null;\n    state.pipesCount = 0;\n    state.flowing = false;\n    if (dest) dest.emit('unpipe', this, unpipeInfo);\n    return this;\n  }\n\n  // slow case. multiple pipe destinations.\n\n  if (!dest) {\n    // remove all.\n    var dests = state.pipes;\n    var len = state.pipesCount;\n    state.pipes = null;\n    state.pipesCount = 0;\n    state.flowing = false;\n    for (var i = 0; i < len; i++) dests[i].emit('unpipe', this, {\n      hasUnpiped: false\n    });\n    return this;\n  }\n\n  // try to find the right one.\n  var index = indexOf(state.pipes, dest);\n  if (index === -1) return this;\n  state.pipes.splice(index, 1);\n  state.pipesCount -= 1;\n  if (state.pipesCount === 1) state.pipes = state.pipes[0];\n  dest.emit('unpipe', this, unpipeInfo);\n  return this;\n};\n\n// set up data events if they are asked for\n// Ensure readable listeners eventually get something\nReadable.prototype.on = function (ev, fn) {\n  var res = Stream.prototype.on.call(this, ev, fn);\n  var state = this._readableState;\n  if (ev === 'data') {\n    // update readableListening so that resume() may be a no-op\n    // a few lines down. This is needed to support once('readable').\n    state.readableListening = this.listenerCount('readable') > 0;\n\n    // Try start flowing on next tick if stream isn't explicitly paused\n    if (state.flowing !== false) this.resume();\n  } else if (ev === 'readable') {\n    if (!state.endEmitted && !state.readableListening) {\n      state.readableListening = state.needReadable = true;\n      state.flowing = false;\n      state.emittedReadable = false;\n      debug('on readable', state.length, state.reading);\n      if (state.length) {\n        emitReadable(this);\n      } else if (!state.reading) {\n        process.nextTick(nReadingNextTick, this);\n      }\n    }\n  }\n  return res;\n};\nReadable.prototype.addListener = Readable.prototype.on;\nReadable.prototype.removeListener = function (ev, fn) {\n  var res = Stream.prototype.removeListener.call(this, ev, fn);\n  if (ev === 'readable') {\n    // We need to check if there is someone still listening to\n    // readable and reset the state. However this needs to happen\n    // after readable has been emitted but before I/O (nextTick) to\n    // support once('readable', fn) cycles. This means that calling\n    // resume within the same tick will have no\n    // effect.\n    process.nextTick(updateReadableListening, this);\n  }\n  return res;\n};\nReadable.prototype.removeAllListeners = function (ev) {\n  var res = Stream.prototype.removeAllListeners.apply(this, arguments);\n  if (ev === 'readable' || ev === undefined) {\n    // We need to check if there is someone still listening to\n    // readable and reset the state. However this needs to happen\n    // after readable has been emitted but before I/O (nextTick) to\n    // support once('readable', fn) cycles. This means that calling\n    // resume within the same tick will have no\n    // effect.\n    process.nextTick(updateReadableListening, this);\n  }\n  return res;\n};\nfunction updateReadableListening(self) {\n  var state = self._readableState;\n  state.readableListening = self.listenerCount('readable') > 0;\n  if (state.resumeScheduled && !state.paused) {\n    // flowing needs to be set to true now, otherwise\n    // the upcoming resume will not flow.\n    state.flowing = true;\n\n    // crude way to check if we should resume\n  } else if (self.listenerCount('data') > 0) {\n    self.resume();\n  }\n}\nfunction nReadingNextTick(self) {\n  debug('readable nexttick read 0');\n  self.read(0);\n}\n\n// pause() and resume() are remnants of the legacy readable stream API\n// If the user uses them, then switch into old mode.\nReadable.prototype.resume = function () {\n  var state = this._readableState;\n  if (!state.flowing) {\n    debug('resume');\n    // we flow only if there is no one listening\n    // for readable, but we still have to call\n    // resume()\n    state.flowing = !state.readableListening;\n    resume(this, state);\n  }\n  state.paused = false;\n  return this;\n};\nfunction resume(stream, state) {\n  if (!state.resumeScheduled) {\n    state.resumeScheduled = true;\n    process.nextTick(resume_, stream, state);\n  }\n}\nfunction resume_(stream, state) {\n  debug('resume', state.reading);\n  if (!state.reading) {\n    stream.read(0);\n  }\n  state.resumeScheduled = false;\n  stream.emit('resume');\n  flow(stream);\n  if (state.flowing && !state.reading) stream.read(0);\n}\nReadable.prototype.pause = function () {\n  debug('call pause flowing=%j', this._readableState.flowing);\n  if (this._readableState.flowing !== false) {\n    debug('pause');\n    this._readableState.flowing = false;\n    this.emit('pause');\n  }\n  this._readableState.paused = true;\n  return this;\n};\nfunction flow(stream) {\n  var state = stream._readableState;\n  debug('flow', state.flowing);\n  while (state.flowing && stream.read() !== null);\n}\n\n// wrap an old-style stream as the async data source.\n// This is *not* part of the readable stream interface.\n// It is an ugly unfortunate mess of history.\nReadable.prototype.wrap = function (stream) {\n  var _this = this;\n  var state = this._readableState;\n  var paused = false;\n  stream.on('end', function () {\n    debug('wrapped end');\n    if (state.decoder && !state.ended) {\n      var chunk = state.decoder.end();\n      if (chunk && chunk.length) _this.push(chunk);\n    }\n    _this.push(null);\n  });\n  stream.on('data', function (chunk) {\n    debug('wrapped data');\n    if (state.decoder) chunk = state.decoder.write(chunk);\n\n    // don't skip over falsy values in objectMode\n    if (state.objectMode && (chunk === null || chunk === undefined)) return;else if (!state.objectMode && (!chunk || !chunk.length)) return;\n    var ret = _this.push(chunk);\n    if (!ret) {\n      paused = true;\n      stream.pause();\n    }\n  });\n\n  // proxy all the other methods.\n  // important when wrapping filters and duplexes.\n  for (var i in stream) {\n    if (this[i] === undefined && typeof stream[i] === 'function') {\n      this[i] = function methodWrap(method) {\n        return function methodWrapReturnFunction() {\n          return stream[method].apply(stream, arguments);\n        };\n      }(i);\n    }\n  }\n\n  // proxy certain important events.\n  for (var n = 0; n < kProxyEvents.length; n++) {\n    stream.on(kProxyEvents[n], this.emit.bind(this, kProxyEvents[n]));\n  }\n\n  // when we try to consume some more bytes, simply unpause the\n  // underlying stream.\n  this._read = function (n) {\n    debug('wrapped _read', n);\n    if (paused) {\n      paused = false;\n      stream.resume();\n    }\n  };\n  return this;\n};\nif (typeof Symbol === 'function') {\n  Readable.prototype[Symbol.asyncIterator] = function () {\n    if (createReadableStreamAsyncIterator === undefined) {\n      createReadableStreamAsyncIterator = require('./internal/streams/async_iterator');\n    }\n    return createReadableStreamAsyncIterator(this);\n  };\n}\nObject.defineProperty(Readable.prototype, 'readableHighWaterMark', {\n  // making it explicit this property is not enumerable\n  // because otherwise some prototype manipulation in\n  // userland will fail\n  enumerable: false,\n  get: function get() {\n    return this._readableState.highWaterMark;\n  }\n});\nObject.defineProperty(Readable.prototype, 'readableBuffer', {\n  // making it explicit this property is not enumerable\n  // because otherwise some prototype manipulation in\n  // userland will fail\n  enumerable: false,\n  get: function get() {\n    return this._readableState && this._readableState.buffer;\n  }\n});\nObject.defineProperty(Readable.prototype, 'readableFlowing', {\n  // making it explicit this property is not enumerable\n  // because otherwise some prototype manipulation in\n  // userland will fail\n  enumerable: false,\n  get: function get() {\n    return this._readableState.flowing;\n  },\n  set: function set(state) {\n    if (this._readableState) {\n      this._readableState.flowing = state;\n    }\n  }\n});\n\n// exposed for testing purposes only.\nReadable._fromList = fromList;\nObject.defineProperty(Readable.prototype, 'readableLength', {\n  // making it explicit this property is not enumerable\n  // because otherwise some prototype manipulation in\n  // userland will fail\n  enumerable: false,\n  get: function get() {\n    return this._readableState.length;\n  }\n});\n\n// Pluck off n bytes from an array of buffers.\n// Length is the combined lengths of all the buffers in the list.\n// This function is designed to be inlinable, so please take care when making\n// changes to the function body.\nfunction fromList(n, state) {\n  // nothing buffered\n  if (state.length === 0) return null;\n  var ret;\n  if (state.objectMode) ret = state.buffer.shift();else if (!n || n >= state.length) {\n    // read it all, truncate the list\n    if (state.decoder) ret = state.buffer.join('');else if (state.buffer.length === 1) ret = state.buffer.first();else ret = state.buffer.concat(state.length);\n    state.buffer.clear();\n  } else {\n    // read part of list\n    ret = state.buffer.consume(n, state.decoder);\n  }\n  return ret;\n}\nfunction endReadable(stream) {\n  var state = stream._readableState;\n  debug('endReadable', state.endEmitted);\n  if (!state.endEmitted) {\n    state.ended = true;\n    process.nextTick(endReadableNT, state, stream);\n  }\n}\nfunction endReadableNT(state, stream) {\n  debug('endReadableNT', state.endEmitted, state.length);\n\n  // Check that we didn't get one last unshift.\n  if (!state.endEmitted && state.length === 0) {\n    state.endEmitted = true;\n    stream.readable = false;\n    stream.emit('end');\n    if (state.autoDestroy) {\n      // In case of duplex streams we need a way to detect\n      // if the writable side is ready for autoDestroy as well\n      var wState = stream._writableState;\n      if (!wState || wState.autoDestroy && wState.finished) {\n        stream.destroy();\n      }\n    }\n  }\n}\nif (typeof Symbol === 'function') {\n  Readable.from = function (iterable, opts) {\n    if (from === undefined) {\n      from = require('./internal/streams/from');\n    }\n    return from(Readable, iterable, opts);\n  };\n}\nfunction indexOf(xs, x) {\n  for (var i = 0, l = xs.length; i < l; i++) {\n    if (xs[i] === x) return i;\n  }\n  return -1;\n}","module.exports = require('events').EventEmitter;\n","'use strict';\n\n// undocumented cb() API, needed for core, not for public API\nfunction destroy(err, cb) {\n  var _this = this;\n  var readableDestroyed = this._readableState && this._readableState.destroyed;\n  var writableDestroyed = this._writableState && this._writableState.destroyed;\n  if (readableDestroyed || writableDestroyed) {\n    if (cb) {\n      cb(err);\n    } else if (err) {\n      if (!this._writableState) {\n        process.nextTick(emitErrorNT, this, err);\n      } else if (!this._writableState.errorEmitted) {\n        this._writableState.errorEmitted = true;\n        process.nextTick(emitErrorNT, this, err);\n      }\n    }\n    return this;\n  }\n\n  // we set destroyed to true before firing error callbacks in order\n  // to make it re-entrance safe in case destroy() is called within callbacks\n\n  if (this._readableState) {\n    this._readableState.destroyed = true;\n  }\n\n  // if this is a duplex stream mark the writable part as destroyed as well\n  if (this._writableState) {\n    this._writableState.destroyed = true;\n  }\n  this._destroy(err || null, function (err) {\n    if (!cb && err) {\n      if (!_this._writableState) {\n        process.nextTick(emitErrorAndCloseNT, _this, err);\n      } else if (!_this._writableState.errorEmitted) {\n        _this._writableState.errorEmitted = true;\n        process.nextTick(emitErrorAndCloseNT, _this, err);\n      } else {\n        process.nextTick(emitCloseNT, _this);\n      }\n    } else if (cb) {\n      process.nextTick(emitCloseNT, _this);\n      cb(err);\n    } else {\n      process.nextTick(emitCloseNT, _this);\n    }\n  });\n  return this;\n}\nfunction emitErrorAndCloseNT(self, err) {\n  emitErrorNT(self, err);\n  emitCloseNT(self);\n}\nfunction emitCloseNT(self) {\n  if (self._writableState && !self._writableState.emitClose) return;\n  if (self._readableState && !self._readableState.emitClose) return;\n  self.emit('close');\n}\nfunction undestroy() {\n  if (this._readableState) {\n    this._readableState.destroyed = false;\n    this._readableState.reading = false;\n    this._readableState.ended = false;\n    this._readableState.endEmitted = false;\n  }\n  if (this._writableState) {\n    this._writableState.destroyed = false;\n    this._writableState.ended = false;\n    this._writableState.ending = false;\n    this._writableState.finalCalled = false;\n    this._writableState.prefinished = false;\n    this._writableState.finished = false;\n    this._writableState.errorEmitted = false;\n  }\n}\nfunction emitErrorNT(self, err) {\n  self.emit('error', err);\n}\nfunction errorOrDestroy(stream, err) {\n  // We have tests that rely on errors being emitted\n  // in the same tick, so changing this is semver major.\n  // For now when you opt-in to autoDestroy we allow\n  // the error to be emitted nextTick. In a future\n  // semver major update we should change the default to this.\n\n  var rState = stream._readableState;\n  var wState = stream._writableState;\n  if (rState && rState.autoDestroy || wState && wState.autoDestroy) stream.destroy(err);else stream.emit('error', err);\n}\nmodule.exports = {\n  destroy: destroy,\n  undestroy: undestroy,\n  errorOrDestroy: errorOrDestroy\n};","'use strict';\n\nvar ERR_INVALID_OPT_VALUE = require('../../../errors').codes.ERR_INVALID_OPT_VALUE;\nfunction highWaterMarkFrom(options, isDuplex, duplexKey) {\n  return options.highWaterMark != null ? options.highWaterMark : isDuplex ? options[duplexKey] : null;\n}\nfunction getHighWaterMark(state, options, duplexKey, isDuplex) {\n  var hwm = highWaterMarkFrom(options, isDuplex, duplexKey);\n  if (hwm != null) {\n    if (!(isFinite(hwm) && Math.floor(hwm) === hwm) || hwm < 0) {\n      var name = isDuplex ? duplexKey : 'highWaterMark';\n      throw new ERR_INVALID_OPT_VALUE(name, hwm);\n    }\n    return Math.floor(hwm);\n  }\n\n  // Default value\n  return state.objectMode ? 16 : 16 * 1024;\n}\nmodule.exports = {\n  getHighWaterMark: getHighWaterMark\n};","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n// A bit simpler than readable streams.\n// Implement an async ._write(chunk, encoding, cb), and it'll handle all\n// the drain event emission and buffering.\n\n'use strict';\n\nmodule.exports = Writable;\n\n/* <replacement> */\nfunction WriteReq(chunk, encoding, cb) {\n  this.chunk = chunk;\n  this.encoding = encoding;\n  this.callback = cb;\n  this.next = null;\n}\n\n// It seems a linked list but it is not\n// there will be only 2 of these for each stream\nfunction CorkedRequest(state) {\n  var _this = this;\n  this.next = null;\n  this.entry = null;\n  this.finish = function () {\n    onCorkedFinish(_this, state);\n  };\n}\n/* </replacement> */\n\n/*<replacement>*/\nvar Duplex;\n/*</replacement>*/\n\nWritable.WritableState = WritableState;\n\n/*<replacement>*/\nvar internalUtil = {\n  deprecate: require('util-deprecate')\n};\n/*</replacement>*/\n\n/*<replacement>*/\nvar Stream = require('./internal/streams/stream');\n/*</replacement>*/\n\nvar Buffer = require('buffer').Buffer;\nvar OurUint8Array = (typeof global !== 'undefined' ? global : typeof window !== 'undefined' ? window : typeof self !== 'undefined' ? self : {}).Uint8Array || function () {};\nfunction _uint8ArrayToBuffer(chunk) {\n  return Buffer.from(chunk);\n}\nfunction _isUint8Array(obj) {\n  return Buffer.isBuffer(obj) || obj instanceof OurUint8Array;\n}\nvar destroyImpl = require('./internal/streams/destroy');\nvar _require = require('./internal/streams/state'),\n  getHighWaterMark = _require.getHighWaterMark;\nvar _require$codes = require('../errors').codes,\n  ERR_INVALID_ARG_TYPE = _require$codes.ERR_INVALID_ARG_TYPE,\n  ERR_METHOD_NOT_IMPLEMENTED = _require$codes.ERR_METHOD_NOT_IMPLEMENTED,\n  ERR_MULTIPLE_CALLBACK = _require$codes.ERR_MULTIPLE_CALLBACK,\n  ERR_STREAM_CANNOT_PIPE = _require$codes.ERR_STREAM_CANNOT_PIPE,\n  ERR_STREAM_DESTROYED = _require$codes.ERR_STREAM_DESTROYED,\n  ERR_STREAM_NULL_VALUES = _require$codes.ERR_STREAM_NULL_VALUES,\n  ERR_STREAM_WRITE_AFTER_END = _require$codes.ERR_STREAM_WRITE_AFTER_END,\n  ERR_UNKNOWN_ENCODING = _require$codes.ERR_UNKNOWN_ENCODING;\nvar errorOrDestroy = destroyImpl.errorOrDestroy;\nrequire('inherits')(Writable, Stream);\nfunction nop() {}\nfunction WritableState(options, stream, isDuplex) {\n  Duplex = Duplex || require('./_stream_duplex');\n  options = options || {};\n\n  // Duplex streams are both readable and writable, but share\n  // the same options object.\n  // However, some cases require setting options to different\n  // values for the readable and the writable sides of the duplex stream,\n  // e.g. options.readableObjectMode vs. options.writableObjectMode, etc.\n  if (typeof isDuplex !== 'boolean') isDuplex = stream instanceof Duplex;\n\n  // object stream flag to indicate whether or not this stream\n  // contains buffers or objects.\n  this.objectMode = !!options.objectMode;\n  if (isDuplex) this.objectMode = this.objectMode || !!options.writableObjectMode;\n\n  // the point at which write() starts returning false\n  // Note: 0 is a valid value, means that we always return false if\n  // the entire buffer is not flushed immediately on write()\n  this.highWaterMark = getHighWaterMark(this, options, 'writableHighWaterMark', isDuplex);\n\n  // if _final has been called\n  this.finalCalled = false;\n\n  // drain event flag.\n  this.needDrain = false;\n  // at the start of calling end()\n  this.ending = false;\n  // when end() has been called, and returned\n  this.ended = false;\n  // when 'finish' is emitted\n  this.finished = false;\n\n  // has it been destroyed\n  this.destroyed = false;\n\n  // should we decode strings into buffers before passing to _write?\n  // this is here so that some node-core streams can optimize string\n  // handling at a lower level.\n  var noDecode = options.decodeStrings === false;\n  this.decodeStrings = !noDecode;\n\n  // Crypto is kind of old and crusty.  Historically, its default string\n  // encoding is 'binary' so we have to make this configurable.\n  // Everything else in the universe uses 'utf8', though.\n  this.defaultEncoding = options.defaultEncoding || 'utf8';\n\n  // not an actual buffer we keep track of, but a measurement\n  // of how much we're waiting to get pushed to some underlying\n  // socket or file.\n  this.length = 0;\n\n  // a flag to see when we're in the middle of a write.\n  this.writing = false;\n\n  // when true all writes will be buffered until .uncork() call\n  this.corked = 0;\n\n  // a flag to be able to tell if the onwrite cb is called immediately,\n  // or on a later tick.  We set this to true at first, because any\n  // actions that shouldn't happen until \"later\" should generally also\n  // not happen before the first write call.\n  this.sync = true;\n\n  // a flag to know if we're processing previously buffered items, which\n  // may call the _write() callback in the same tick, so that we don't\n  // end up in an overlapped onwrite situation.\n  this.bufferProcessing = false;\n\n  // the callback that's passed to _write(chunk,cb)\n  this.onwrite = function (er) {\n    onwrite(stream, er);\n  };\n\n  // the callback that the user supplies to write(chunk,encoding,cb)\n  this.writecb = null;\n\n  // the amount that is being written when _write is called.\n  this.writelen = 0;\n  this.bufferedRequest = null;\n  this.lastBufferedRequest = null;\n\n  // number of pending user-supplied write callbacks\n  // this must be 0 before 'finish' can be emitted\n  this.pendingcb = 0;\n\n  // emit prefinish if the only thing we're waiting for is _write cbs\n  // This is relevant for synchronous Transform streams\n  this.prefinished = false;\n\n  // True if the error was already emitted and should not be thrown again\n  this.errorEmitted = false;\n\n  // Should close be emitted on destroy. Defaults to true.\n  this.emitClose = options.emitClose !== false;\n\n  // Should .destroy() be called after 'finish' (and potentially 'end')\n  this.autoDestroy = !!options.autoDestroy;\n\n  // count buffered requests\n  this.bufferedRequestCount = 0;\n\n  // allocate the first CorkedRequest, there is always\n  // one allocated and free to use, and we maintain at most two\n  this.corkedRequestsFree = new CorkedRequest(this);\n}\nWritableState.prototype.getBuffer = function getBuffer() {\n  var current = this.bufferedRequest;\n  var out = [];\n  while (current) {\n    out.push(current);\n    current = current.next;\n  }\n  return out;\n};\n(function () {\n  try {\n    Object.defineProperty(WritableState.prototype, 'buffer', {\n      get: internalUtil.deprecate(function writableStateBufferGetter() {\n        return this.getBuffer();\n      }, '_writableState.buffer is deprecated. Use _writableState.getBuffer ' + 'instead.', 'DEP0003')\n    });\n  } catch (_) {}\n})();\n\n// Test _writableState for inheritance to account for Duplex streams,\n// whose prototype chain only points to Readable.\nvar realHasInstance;\nif (typeof Symbol === 'function' && Symbol.hasInstance && typeof Function.prototype[Symbol.hasInstance] === 'function') {\n  realHasInstance = Function.prototype[Symbol.hasInstance];\n  Object.defineProperty(Writable, Symbol.hasInstance, {\n    value: function value(object) {\n      if (realHasInstance.call(this, object)) return true;\n      if (this !== Writable) return false;\n      return object && object._writableState instanceof WritableState;\n    }\n  });\n} else {\n  realHasInstance = function realHasInstance(object) {\n    return object instanceof this;\n  };\n}\nfunction Writable(options) {\n  Duplex = Duplex || require('./_stream_duplex');\n\n  // Writable ctor is applied to Duplexes, too.\n  // `realHasInstance` is necessary because using plain `instanceof`\n  // would return false, as no `_writableState` property is attached.\n\n  // Trying to use the custom `instanceof` for Writable here will also break the\n  // Node.js LazyTransform implementation, which has a non-trivial getter for\n  // `_writableState` that would lead to infinite recursion.\n\n  // Checking for a Stream.Duplex instance is faster here instead of inside\n  // the WritableState constructor, at least with V8 6.5\n  var isDuplex = this instanceof Duplex;\n  if (!isDuplex && !realHasInstance.call(Writable, this)) return new Writable(options);\n  this._writableState = new WritableState(options, this, isDuplex);\n\n  // legacy.\n  this.writable = true;\n  if (options) {\n    if (typeof options.write === 'function') this._write = options.write;\n    if (typeof options.writev === 'function') this._writev = options.writev;\n    if (typeof options.destroy === 'function') this._destroy = options.destroy;\n    if (typeof options.final === 'function') this._final = options.final;\n  }\n  Stream.call(this);\n}\n\n// Otherwise people can pipe Writable streams, which is just wrong.\nWritable.prototype.pipe = function () {\n  errorOrDestroy(this, new ERR_STREAM_CANNOT_PIPE());\n};\nfunction writeAfterEnd(stream, cb) {\n  var er = new ERR_STREAM_WRITE_AFTER_END();\n  // TODO: defer error events consistently everywhere, not just the cb\n  errorOrDestroy(stream, er);\n  process.nextTick(cb, er);\n}\n\n// Checks that a user-supplied chunk is valid, especially for the particular\n// mode the stream is in. Currently this means that `null` is never accepted\n// and undefined/non-string values are only allowed in object mode.\nfunction validChunk(stream, state, chunk, cb) {\n  var er;\n  if (chunk === null) {\n    er = new ERR_STREAM_NULL_VALUES();\n  } else if (typeof chunk !== 'string' && !state.objectMode) {\n    er = new ERR_INVALID_ARG_TYPE('chunk', ['string', 'Buffer'], chunk);\n  }\n  if (er) {\n    errorOrDestroy(stream, er);\n    process.nextTick(cb, er);\n    return false;\n  }\n  return true;\n}\nWritable.prototype.write = function (chunk, encoding, cb) {\n  var state = this._writableState;\n  var ret = false;\n  var isBuf = !state.objectMode && _isUint8Array(chunk);\n  if (isBuf && !Buffer.isBuffer(chunk)) {\n    chunk = _uint8ArrayToBuffer(chunk);\n  }\n  if (typeof encoding === 'function') {\n    cb = encoding;\n    encoding = null;\n  }\n  if (isBuf) encoding = 'buffer';else if (!encoding) encoding = state.defaultEncoding;\n  if (typeof cb !== 'function') cb = nop;\n  if (state.ending) writeAfterEnd(this, cb);else if (isBuf || validChunk(this, state, chunk, cb)) {\n    state.pendingcb++;\n    ret = writeOrBuffer(this, state, isBuf, chunk, encoding, cb);\n  }\n  return ret;\n};\nWritable.prototype.cork = function () {\n  this._writableState.corked++;\n};\nWritable.prototype.uncork = function () {\n  var state = this._writableState;\n  if (state.corked) {\n    state.corked--;\n    if (!state.writing && !state.corked && !state.bufferProcessing && state.bufferedRequest) clearBuffer(this, state);\n  }\n};\nWritable.prototype.setDefaultEncoding = function setDefaultEncoding(encoding) {\n  // node::ParseEncoding() requires lower case.\n  if (typeof encoding === 'string') encoding = encoding.toLowerCase();\n  if (!(['hex', 'utf8', 'utf-8', 'ascii', 'binary', 'base64', 'ucs2', 'ucs-2', 'utf16le', 'utf-16le', 'raw'].indexOf((encoding + '').toLowerCase()) > -1)) throw new ERR_UNKNOWN_ENCODING(encoding);\n  this._writableState.defaultEncoding = encoding;\n  return this;\n};\nObject.defineProperty(Writable.prototype, 'writableBuffer', {\n  // making it explicit this property is not enumerable\n  // because otherwise some prototype manipulation in\n  // userland will fail\n  enumerable: false,\n  get: function get() {\n    return this._writableState && this._writableState.getBuffer();\n  }\n});\nfunction decodeChunk(state, chunk, encoding) {\n  if (!state.objectMode && state.decodeStrings !== false && typeof chunk === 'string') {\n    chunk = Buffer.from(chunk, encoding);\n  }\n  return chunk;\n}\nObject.defineProperty(Writable.prototype, 'writableHighWaterMark', {\n  // making it explicit this property is not enumerable\n  // because otherwise some prototype manipulation in\n  // userland will fail\n  enumerable: false,\n  get: function get() {\n    return this._writableState.highWaterMark;\n  }\n});\n\n// if we're already writing something, then just put this\n// in the queue, and wait our turn.  Otherwise, call _write\n// If we return false, then we need a drain event, so set that flag.\nfunction writeOrBuffer(stream, state, isBuf, chunk, encoding, cb) {\n  if (!isBuf) {\n    var newChunk = decodeChunk(state, chunk, encoding);\n    if (chunk !== newChunk) {\n      isBuf = true;\n      encoding = 'buffer';\n      chunk = newChunk;\n    }\n  }\n  var len = state.objectMode ? 1 : chunk.length;\n  state.length += len;\n  var ret = state.length < state.highWaterMark;\n  // we must ensure that previous needDrain will not be reset to false.\n  if (!ret) state.needDrain = true;\n  if (state.writing || state.corked) {\n    var last = state.lastBufferedRequest;\n    state.lastBufferedRequest = {\n      chunk: chunk,\n      encoding: encoding,\n      isBuf: isBuf,\n      callback: cb,\n      next: null\n    };\n    if (last) {\n      last.next = state.lastBufferedRequest;\n    } else {\n      state.bufferedRequest = state.lastBufferedRequest;\n    }\n    state.bufferedRequestCount += 1;\n  } else {\n    doWrite(stream, state, false, len, chunk, encoding, cb);\n  }\n  return ret;\n}\nfunction doWrite(stream, state, writev, len, chunk, encoding, cb) {\n  state.writelen = len;\n  state.writecb = cb;\n  state.writing = true;\n  state.sync = true;\n  if (state.destroyed) state.onwrite(new ERR_STREAM_DESTROYED('write'));else if (writev) stream._writev(chunk, state.onwrite);else stream._write(chunk, encoding, state.onwrite);\n  state.sync = false;\n}\nfunction onwriteError(stream, state, sync, er, cb) {\n  --state.pendingcb;\n  if (sync) {\n    // defer the callback if we are being called synchronously\n    // to avoid piling up things on the stack\n    process.nextTick(cb, er);\n    // this can emit finish, and it will always happen\n    // after error\n    process.nextTick(finishMaybe, stream, state);\n    stream._writableState.errorEmitted = true;\n    errorOrDestroy(stream, er);\n  } else {\n    // the caller expect this to happen before if\n    // it is async\n    cb(er);\n    stream._writableState.errorEmitted = true;\n    errorOrDestroy(stream, er);\n    // this can emit finish, but finish must\n    // always follow error\n    finishMaybe(stream, state);\n  }\n}\nfunction onwriteStateUpdate(state) {\n  state.writing = false;\n  state.writecb = null;\n  state.length -= state.writelen;\n  state.writelen = 0;\n}\nfunction onwrite(stream, er) {\n  var state = stream._writableState;\n  var sync = state.sync;\n  var cb = state.writecb;\n  if (typeof cb !== 'function') throw new ERR_MULTIPLE_CALLBACK();\n  onwriteStateUpdate(state);\n  if (er) onwriteError(stream, state, sync, er, cb);else {\n    // Check if we're actually ready to finish, but don't emit yet\n    var finished = needFinish(state) || stream.destroyed;\n    if (!finished && !state.corked && !state.bufferProcessing && state.bufferedRequest) {\n      clearBuffer(stream, state);\n    }\n    if (sync) {\n      process.nextTick(afterWrite, stream, state, finished, cb);\n    } else {\n      afterWrite(stream, state, finished, cb);\n    }\n  }\n}\nfunction afterWrite(stream, state, finished, cb) {\n  if (!finished) onwriteDrain(stream, state);\n  state.pendingcb--;\n  cb();\n  finishMaybe(stream, state);\n}\n\n// Must force callback to be called on nextTick, so that we don't\n// emit 'drain' before the write() consumer gets the 'false' return\n// value, and has a chance to attach a 'drain' listener.\nfunction onwriteDrain(stream, state) {\n  if (state.length === 0 && state.needDrain) {\n    state.needDrain = false;\n    stream.emit('drain');\n  }\n}\n\n// if there's something in the buffer waiting, then process it\nfunction clearBuffer(stream, state) {\n  state.bufferProcessing = true;\n  var entry = state.bufferedRequest;\n  if (stream._writev && entry && entry.next) {\n    // Fast case, write everything using _writev()\n    var l = state.bufferedRequestCount;\n    var buffer = new Array(l);\n    var holder = state.corkedRequestsFree;\n    holder.entry = entry;\n    var count = 0;\n    var allBuffers = true;\n    while (entry) {\n      buffer[count] = entry;\n      if (!entry.isBuf) allBuffers = false;\n      entry = entry.next;\n      count += 1;\n    }\n    buffer.allBuffers = allBuffers;\n    doWrite(stream, state, true, state.length, buffer, '', holder.finish);\n\n    // doWrite is almost always async, defer these to save a bit of time\n    // as the hot path ends with doWrite\n    state.pendingcb++;\n    state.lastBufferedRequest = null;\n    if (holder.next) {\n      state.corkedRequestsFree = holder.next;\n      holder.next = null;\n    } else {\n      state.corkedRequestsFree = new CorkedRequest(state);\n    }\n    state.bufferedRequestCount = 0;\n  } else {\n    // Slow case, write chunks one-by-one\n    while (entry) {\n      var chunk = entry.chunk;\n      var encoding = entry.encoding;\n      var cb = entry.callback;\n      var len = state.objectMode ? 1 : chunk.length;\n      doWrite(stream, state, false, len, chunk, encoding, cb);\n      entry = entry.next;\n      state.bufferedRequestCount--;\n      // if we didn't call the onwrite immediately, then\n      // it means that we need to wait until it does.\n      // also, that means that the chunk and cb are currently\n      // being processed, so move the buffer counter past them.\n      if (state.writing) {\n        break;\n      }\n    }\n    if (entry === null) state.lastBufferedRequest = null;\n  }\n  state.bufferedRequest = entry;\n  state.bufferProcessing = false;\n}\nWritable.prototype._write = function (chunk, encoding, cb) {\n  cb(new ERR_METHOD_NOT_IMPLEMENTED('_write()'));\n};\nWritable.prototype._writev = null;\nWritable.prototype.end = function (chunk, encoding, cb) {\n  var state = this._writableState;\n  if (typeof chunk === 'function') {\n    cb = chunk;\n    chunk = null;\n    encoding = null;\n  } else if (typeof encoding === 'function') {\n    cb = encoding;\n    encoding = null;\n  }\n  if (chunk !== null && chunk !== undefined) this.write(chunk, encoding);\n\n  // .end() fully uncorks\n  if (state.corked) {\n    state.corked = 1;\n    this.uncork();\n  }\n\n  // ignore unnecessary end() calls.\n  if (!state.ending) endWritable(this, state, cb);\n  return this;\n};\nObject.defineProperty(Writable.prototype, 'writableLength', {\n  // making it explicit this property is not enumerable\n  // because otherwise some prototype manipulation in\n  // userland will fail\n  enumerable: false,\n  get: function get() {\n    return this._writableState.length;\n  }\n});\nfunction needFinish(state) {\n  return state.ending && state.length === 0 && state.bufferedRequest === null && !state.finished && !state.writing;\n}\nfunction callFinal(stream, state) {\n  stream._final(function (err) {\n    state.pendingcb--;\n    if (err) {\n      errorOrDestroy(stream, err);\n    }\n    state.prefinished = true;\n    stream.emit('prefinish');\n    finishMaybe(stream, state);\n  });\n}\nfunction prefinish(stream, state) {\n  if (!state.prefinished && !state.finalCalled) {\n    if (typeof stream._final === 'function' && !state.destroyed) {\n      state.pendingcb++;\n      state.finalCalled = true;\n      process.nextTick(callFinal, stream, state);\n    } else {\n      state.prefinished = true;\n      stream.emit('prefinish');\n    }\n  }\n}\nfunction finishMaybe(stream, state) {\n  var need = needFinish(state);\n  if (need) {\n    prefinish(stream, state);\n    if (state.pendingcb === 0) {\n      state.finished = true;\n      stream.emit('finish');\n      if (state.autoDestroy) {\n        // In case of duplex streams we need a way to detect\n        // if the readable side is ready for autoDestroy as well\n        var rState = stream._readableState;\n        if (!rState || rState.autoDestroy && rState.endEmitted) {\n          stream.destroy();\n        }\n      }\n    }\n  }\n  return need;\n}\nfunction endWritable(stream, state, cb) {\n  state.ending = true;\n  finishMaybe(stream, state);\n  if (cb) {\n    if (state.finished) process.nextTick(cb);else stream.once('finish', cb);\n  }\n  state.ended = true;\n  stream.writable = false;\n}\nfunction onCorkedFinish(corkReq, state, err) {\n  var entry = corkReq.entry;\n  corkReq.entry = null;\n  while (entry) {\n    var cb = entry.callback;\n    state.pendingcb--;\n    cb(err);\n    entry = entry.next;\n  }\n\n  // reuse the free corkReq.\n  state.corkedRequestsFree.next = corkReq;\n}\nObject.defineProperty(Writable.prototype, 'destroyed', {\n  // making it explicit this property is not enumerable\n  // because otherwise some prototype manipulation in\n  // userland will fail\n  enumerable: false,\n  get: function get() {\n    if (this._writableState === undefined) {\n      return false;\n    }\n    return this._writableState.destroyed;\n  },\n  set: function set(value) {\n    // we ignore the value if the stream\n    // has not been initialized yet\n    if (!this._writableState) {\n      return;\n    }\n\n    // backward compatibility, the user is explicitly\n    // managing destroyed\n    this._writableState.destroyed = value;\n  }\n});\nWritable.prototype.destroy = destroyImpl.destroy;\nWritable.prototype._undestroy = destroyImpl.undestroy;\nWritable.prototype._destroy = function (err, cb) {\n  cb(err);\n};","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n// a transform stream is a readable/writable stream where you do\n// something with the data.  Sometimes it's called a \"filter\",\n// but that's not a great name for it, since that implies a thing where\n// some bits pass through, and others are simply ignored.  (That would\n// be a valid example of a transform, of course.)\n//\n// While the output is causally related to the input, it's not a\n// necessarily symmetric or synchronous transformation.  For example,\n// a zlib stream might take multiple plain-text writes(), and then\n// emit a single compressed chunk some time in the future.\n//\n// Here's how this works:\n//\n// The Transform stream has all the aspects of the readable and writable\n// stream classes.  When you write(chunk), that calls _write(chunk,cb)\n// internally, and returns false if there's a lot of pending writes\n// buffered up.  When you call read(), that calls _read(n) until\n// there's enough pending readable data buffered up.\n//\n// In a transform stream, the written data is placed in a buffer.  When\n// _read(n) is called, it transforms the queued up data, calling the\n// buffered _write cb's as it consumes chunks.  If consuming a single\n// written chunk would result in multiple output chunks, then the first\n// outputted bit calls the readcb, and subsequent chunks just go into\n// the read buffer, and will cause it to emit 'readable' if necessary.\n//\n// This way, back-pressure is actually determined by the reading side,\n// since _read has to be called to start processing a new chunk.  However,\n// a pathological inflate type of transform can cause excessive buffering\n// here.  For example, imagine a stream where every byte of input is\n// interpreted as an integer from 0-255, and then results in that many\n// bytes of output.  Writing the 4 bytes {ff,ff,ff,ff} would result in\n// 1kb of data being output.  In this case, you could write a very small\n// amount of input, and end up with a very large amount of output.  In\n// such a pathological inflating mechanism, there'd be no way to tell\n// the system to stop doing the transform.  A single 4MB write could\n// cause the system to run out of memory.\n//\n// However, even in such a pathological case, only a single written chunk\n// would be consumed, and then the rest would wait (un-transformed) until\n// the results of the previous transformed chunk were consumed.\n\n'use strict';\n\nmodule.exports = Transform;\nvar _require$codes = require('../errors').codes,\n  ERR_METHOD_NOT_IMPLEMENTED = _require$codes.ERR_METHOD_NOT_IMPLEMENTED,\n  ERR_MULTIPLE_CALLBACK = _require$codes.ERR_MULTIPLE_CALLBACK,\n  ERR_TRANSFORM_ALREADY_TRANSFORMING = _require$codes.ERR_TRANSFORM_ALREADY_TRANSFORMING,\n  ERR_TRANSFORM_WITH_LENGTH_0 = _require$codes.ERR_TRANSFORM_WITH_LENGTH_0;\nvar Duplex = require('./_stream_duplex');\nrequire('inherits')(Transform, Duplex);\nfunction afterTransform(er, data) {\n  var ts = this._transformState;\n  ts.transforming = false;\n  var cb = ts.writecb;\n  if (cb === null) {\n    return this.emit('error', new ERR_MULTIPLE_CALLBACK());\n  }\n  ts.writechunk = null;\n  ts.writecb = null;\n  if (data != null)\n    // single equals check for both `null` and `undefined`\n    this.push(data);\n  cb(er);\n  var rs = this._readableState;\n  rs.reading = false;\n  if (rs.needReadable || rs.length < rs.highWaterMark) {\n    this._read(rs.highWaterMark);\n  }\n}\nfunction Transform(options) {\n  if (!(this instanceof Transform)) return new Transform(options);\n  Duplex.call(this, options);\n  this._transformState = {\n    afterTransform: afterTransform.bind(this),\n    needTransform: false,\n    transforming: false,\n    writecb: null,\n    writechunk: null,\n    writeencoding: null\n  };\n\n  // start out asking for a readable event once data is transformed.\n  this._readableState.needReadable = true;\n\n  // we have implemented the _read method, and done the other things\n  // that Readable wants before the first _read call, so unset the\n  // sync guard flag.\n  this._readableState.sync = false;\n  if (options) {\n    if (typeof options.transform === 'function') this._transform = options.transform;\n    if (typeof options.flush === 'function') this._flush = options.flush;\n  }\n\n  // When the writable side finishes, then flush out anything remaining.\n  this.on('prefinish', prefinish);\n}\nfunction prefinish() {\n  var _this = this;\n  if (typeof this._flush === 'function' && !this._readableState.destroyed) {\n    this._flush(function (er, data) {\n      done(_this, er, data);\n    });\n  } else {\n    done(this, null, null);\n  }\n}\nTransform.prototype.push = function (chunk, encoding) {\n  this._transformState.needTransform = false;\n  return Duplex.prototype.push.call(this, chunk, encoding);\n};\n\n// This is the part where you do stuff!\n// override this function in implementation classes.\n// 'chunk' is an input chunk.\n//\n// Call `push(newChunk)` to pass along transformed output\n// to the readable side.  You may call 'push' zero or more times.\n//\n// Call `cb(err)` when you are done with this chunk.  If you pass\n// an error, then that'll put the hurt on the whole operation.  If you\n// never call cb(), then you'll never get another chunk.\nTransform.prototype._transform = function (chunk, encoding, cb) {\n  cb(new ERR_METHOD_NOT_IMPLEMENTED('_transform()'));\n};\nTransform.prototype._write = function (chunk, encoding, cb) {\n  var ts = this._transformState;\n  ts.writecb = cb;\n  ts.writechunk = chunk;\n  ts.writeencoding = encoding;\n  if (!ts.transforming) {\n    var rs = this._readableState;\n    if (ts.needTransform || rs.needReadable || rs.length < rs.highWaterMark) this._read(rs.highWaterMark);\n  }\n};\n\n// Doesn't matter what the args are here.\n// _transform does all the work.\n// That we got here means that the readable side wants more data.\nTransform.prototype._read = function (n) {\n  var ts = this._transformState;\n  if (ts.writechunk !== null && !ts.transforming) {\n    ts.transforming = true;\n    this._transform(ts.writechunk, ts.writeencoding, ts.afterTransform);\n  } else {\n    // mark that we need a transform, so that any data that comes in\n    // will get processed, now that we've asked for it.\n    ts.needTransform = true;\n  }\n};\nTransform.prototype._destroy = function (err, cb) {\n  Duplex.prototype._destroy.call(this, err, function (err2) {\n    cb(err2);\n  });\n};\nfunction done(stream, er, data) {\n  if (er) return stream.emit('error', er);\n  if (data != null)\n    // single equals check for both `null` and `undefined`\n    stream.push(data);\n\n  // TODO(BridgeAR): Write a test for these two error cases\n  // if there's nothing in the write buffer, then that means\n  // that nothing more will ever be provided\n  if (stream._writableState.length) throw new ERR_TRANSFORM_WITH_LENGTH_0();\n  if (stream._transformState.transforming) throw new ERR_TRANSFORM_ALREADY_TRANSFORMING();\n  return stream.push(null);\n}","import _objectWithoutProperties from '@babel/runtime/helpers/objectWithoutProperties';\nimport _defineProperty from '@babel/runtime/helpers/defineProperty';\nimport { get, setAPIKey } from '@toruslabs/http-helpers';\nimport { SafeEventEmitter, ObjectMultiplex, createStreamMiddleware, JRPCEngine, createIdRemapMiddleware, BasePostMessageStream, setupMultiplex } from '@toruslabs/openlogin-jrpc';\nimport deepmerge from 'lodash.merge';\nimport { ObservableStore, storeAsStream } from '@metamask/obs-store';\nimport { ethErrors, EthereumRpcError } from 'eth-rpc-errors';\nimport dequal from 'fast-deep-equal';\nimport { duplex } from 'is-stream';\nimport pump from 'pump';\nimport loglevel from 'loglevel';\nimport createHash from 'create-hash';\nimport { EventEmitter } from 'events';\n\nconst LOGIN_PROVIDER = {\n  GOOGLE: \"google\",\n  FACEBOOK: \"facebook\",\n  TWITCH: \"twitch\",\n  REDDIT: \"reddit\",\n  DISCORD: \"discord\"\n};\nconst WALLET_VERIFIERS = {\n  GOOGLE: \"google\",\n  FACEBOOK: \"facebook\",\n  TWITCH: \"twitch\",\n  REDDIT: \"reddit\",\n  DISCORD: \"discord\",\n  EMAIL_PASSWORDLESS: \"torus-auth0-email-passwordless\"\n};\nconst WALLET_OPENLOGIN_VERIFIER_MAP = {\n  [WALLET_VERIFIERS.GOOGLE]: \"tkey-google\",\n  [WALLET_VERIFIERS.FACEBOOK]: \"tkey-facebook\",\n  [WALLET_VERIFIERS.TWITCH]: \"tkey-twitch\",\n  [WALLET_VERIFIERS.REDDIT]: \"tkey-reddit\",\n  [WALLET_VERIFIERS.DISCORD]: \"tkey-discord\",\n  [WALLET_VERIFIERS.EMAIL_PASSWORDLESS]: \"tkey-auth0-email-passwordless\"\n};\nconst PAYMENT_PROVIDER = {\n  MOONPAY: \"moonpay\",\n  WYRE: \"wyre\",\n  RAMPNETWORK: \"rampnetwork\",\n  XANPOOL: \"xanpool\",\n  MERCURYO: \"mercuryo\",\n  TRANSAK: \"transak\",\n  BANXA: \"banxa\"\n};\nconst SUPPORTED_PAYMENT_NETWORK = {\n  MAINNET: \"mainnet\",\n  MATIC: \"matic\",\n  BSC_MAINNET: \"bsc_mainnet\",\n  AVALANCHE_MAINNET: \"avalanche_mainnet\",\n  XDAI: \"xdai\"\n};\nconst TORUS_BUILD_ENV = {\n  PRODUCTION: \"production\",\n  DEVELOPMENT: \"development\",\n  BINANCE: \"binance\",\n  TESTING: \"testing\",\n  LRC: \"lrc\",\n  BETA: \"beta\",\n  BNB: \"bnb\",\n  POLYGON: \"polygon\"\n};\nconst BUTTON_POSITION = {\n  BOTTOM_LEFT: \"bottom-left\",\n  TOP_LEFT: \"top-left\",\n  BOTTOM_RIGHT: \"bottom-right\",\n  TOP_RIGHT: \"top-right\"\n};\n\n/**\n * From https://min-api.cryptocompare.com/data/v2/pair/mapping/fsym?fsym=BTC&extraParams=YourSite\n * GET https://min-api.cryptocompare.com/data/v2/pair/mapping/fsym?fsym=BTC\n * Then map over returned entries, picking tsym\n *\n * Last updated: Date of commit\n */\nconst CRYPTO_COMPARE_CURRENCIES = [\"ETH\", \"USDT\", \"USDC\", \"TUSD\", \"EOSDT\", \"USD\", \"DAI\", \"GUSD\", \"DKKT\", \"PAX\", \"ILS\", \"RUB\", \"BYN\", \"EUR\", \"GBP\", \"JPY\", \"KRW\", \"PLN\", \"MXN\", \"AUD\", \"BRL\", \"CAD\", \"CHF\", \"KPW\", \"LAK\", \"LBP\", \"LKR\", \"XOF\", \"CNHT\", \"DOGE\", \"UAH\", \"TRY\", \"HKD\", \"XJP\", \"SGD\", \"USC\", \"NZD\", \"NGN\", \"RUR\", \"COP\", \"GHS\", \"EGP\", \"IDR\", \"BHD\", \"CRC\", \"PEN\", \"AED\", \"DOP\", \"PKR\", \"HUF\", \"VND\", \"XAR\", \"LTC\", \"RON\", \"OMR\", \"MYR\", \"DKK\", \"UGX\", \"ZMW\", \"SAR\", \"SEK\", \"GEL\", \"RWF\", \"IRR\", \"TZS\", \"CNY\", \"VEF\", \"BDT\", \"HRK\", \"CLP\", \"THB\", \"XAF\", \"ARS\", \"UYU\", \"SZL\", \"KZT\", \"NOK\", \"KES\", \"PAB\", \"INR\", \"CZK\", \"MAD\", \"TWD\", \"PHP\", \"ZAR\", \"BOB\", \"CDF\", \"DASH\", \"VES\", \"ISK\", \"MWK\", \"BAM\", \"TTD\", \"XRP\", \"JOD\", \"RSD\", \"HNL\", \"BGN\", \"GTQ\", \"BWP\", \"XMR\", \"MMK\", \"QAR\", \"AOA\", \"KWD\", \"MUR\", \"WUSD\", \"WEUR\", \"WAVES\", \"WTRY\", \"LRD\", \"LSL\", \"LYD\", \"AWG\", \"MDL\", \"BTO\", \"EURS\", \"CHFT\", \"MKD\", \"MNT\", \"MOP\", \"MRO\", \"MVR\", \"VOLLAR\", \"CKUSD\", \"KHR\", \"VUV\", \"BITCNY\", \"QC\", \"BBD\", \"NAD\", \"NPR\", \"PGK\", \"PYG\", \"BIF\", \"BMD\", \"BND\", \"XLM\", \"BNB\", \"SCR\", \"BAT\", \"CRO\", \"HT\", \"KCS\", \"LEO\", \"LINK\", \"MKR\", \"NPXS\", \"OMG\", \"REP\", \"ZB\", \"ZIL\", \"ZRX\", \"BCH\", \"BZD\", \"CUP\", \"CVE\", \"DJF\", \"DZD\", \"ERN\", \"ETB\", \"FJD\", \"FKP\", \"BUSD\", \"ANCT\", \"ALL\", \"AMD\", \"ANG\", \"CNYX\", \"IQD\", \"UZS\", \"TND\", \"GGP\", \"XAU\", \"KGS\", \"GIP\", \"JMD\", \"ZEC\", \"USDP\", \"BSV\", \"EMC2\", \"SNT\", \"GTO\", \"POWR\", \"EUSD\", \"EURT\", \"BCY\", \"BTS\", \"ATM\", \"BLOCKPAY\", \"ARDR\", \"AMP\", \"B2X\", \"BITGOLD\", \"BITEUR\", \"ATB\", \"BITUSD\", \"AGRS\", \"DFXT\", \"HIKEN\", \"BIX\", \"KNC\", \"EOS\", \"COB\", \"COSS\", \"BMH\", \"NANO\", \"BDG\", \"BNT\", \"XVG\", \"LKK1Y\", \"LKK\", \"USDK\", \"EURN\", \"NZDT\", \"JSE\", \"GMD\", \"GNF\", \"GYD\", \"YER\", \"XPF\", \"HTG\", \"SLL\", \"SOS\", \"WST\", \"SVC\", \"SYP\", \"NEO\", \"KMF\", \"JUMP\", \"AYA\", \"BLAST\", \"WGR\", \"BCN\", \"BTG\", \"URALS\", \"INN\", \"USDQ\", \"CNH\", \"HUSD\", \"BKRW\", \"NZDX\", \"EURX\", \"CADX\", \"USDEX\", \"JPYX\", \"AUDX\", \"VNDC\", \"EON\", \"GBPX\", \"CHFX\", \"USDJ\", \"IDRT\", \"USDS\", \"USDN\", \"BIDR\", \"IDK\", \"BSD\", \"BTN\", \"KYD\", \"NIO\", \"SBD\", \"SDG\", \"SHP\", \"TOP\", \"XCD\", \"XCHF\", \"CNYT\", \"GYEN\", \"ZUSD\", \"GOLD\", \"TRX\", \"TRYB\", \"PLATC\", \"STRAX\", \"UST\", \"GLM\", \"VAI\", \"BRZ\", \"DDRST\", \"XAUT\", \"MIM\"];\n/**\n * currencies supported by the payment provider\n * Last updated: Date of commit\n */\nconst PROVIDER_SUPPORTED_FIAT_CURRENCIES = {\n  // https://integrations.simplex.com/supported_currencies\n  // https://support.moonpay.com/hc/en-gb/articles/360011931457-Which-fiat-currencies-are-supported-\n  [PAYMENT_PROVIDER.MOONPAY]: [\"AUD\", \"BGN\", \"BRL\", \"CAD\", \"CHF\", \"CNY\", \"COP\", \"CZK\", \"DKK\", \"DOP\", \"EGP\", \"EUR\", \"GBP\", \"HKD\", \"HRK\", \"IDR\", \"ILS\", \"JPY\", \"JOD\", \"KES\", \"KRW\", \"KWD\", \"LKR\", \"MAD\", \"MXN\", \"MYR\", \"NGN\", \"NOK\", \"NZD\", \"OMR\", \"PEN\", \"PKR\", \"PLN\", \"RON\", \"RUB\", \"SEK\", \"SGD\", \"THB\", \"TRY\", \"TWD\", \"USD\", \"VND\", \"ZAR\"],\n  /**\n   * https://docs.sendwyre.com/docs/supported-currencies#fiat\n   * The ones where credit card is supported\n   */\n  [PAYMENT_PROVIDER.WYRE]: [\"USD\", \"EUR\", \"GBP\", \"AUD\", \"CAD\", \"NZD\", \"ARS\", \"BRL\", \"CHF\", \"CLP\", \"COP\", \"CZK\", \"DKK\", \"HKD\", \"ILS\", \"INR\", \"ISK\", \"JPY\", \"KRW\", \"MXN\", \"MYR\", \"NOK\", \"PHP\", \"PLN\", \"SEK\", \"THB\", \"VND\", \"ZAR\"],\n  // https://support.ramp.network/en/articles/471-why-am-i-paying-in-usd-eur-gbp\n  [PAYMENT_PROVIDER.RAMPNETWORK]: [\"USD\", \"EUR\", \"GBP\"],\n  // From https://xanpool.com/ fiat select dropdown\n  [PAYMENT_PROVIDER.XANPOOL]: [\"SGD\", \"HKD\", \"THB\", \"PHP\", \"INR\", \"IDR\", \"MYR\", \"AUD\", \"NZD\", \"KRW\"],\n  // https://support.aax.com/en/articles/5295762-mercuryo\n  // RUB / UAH currently not supported\n  [PAYMENT_PROVIDER.MERCURYO]: [\"EUR\", \"USD\", \"GBP\", \"TRY\", \"JPY\", \"BRL\", \"NGN\", \"VND\", \"MXN\", \"KRW\"],\n  /**\n   * https://support.transak.com/hc/en-us/articles/360020615578-Credit-and-Debit-Card-Payments-through-Transak\n   * or\n   * https://transak.stoplight.io/docs/transak-docs/b3A6OTk1ODQ0-2-get-fiat-currencies\n   */\n  [PAYMENT_PROVIDER.TRANSAK]: [\"ARS\", \"AUD\", \"BBD\", \"BGN\", \"BMD\", \"BRL\", \"CAD\", \"CHF\", \"CLP\", \"CRC\", \"CZK\", \"DKK\", \"DOP\", \"EUR\", \"FJD\", \"FKP\", \"GBP\", \"GIP\", \"HRK\", \"HUF\", \"IDR\", \"ILS\", \"ISK\", \"JMD\", \"JPY\", \"KES\", \"KRW\", \"MDL\", \"MXN\", \"MYR\", \"NOK\", \"NZD\", \"PEN\", \"PHP\", \"PLN\", \"PYG\", \"RON\", \"SEK\", \"SGD\", \"THB\", \"TRY\", \"TZS\", \"USD\", \"ZAR\"],\n  [PAYMENT_PROVIDER.BANXA]: [\"EUR\", \"GBP\", \"USD\"]\n};\nconst cryptoCompareCurrenciesSet = new Set(CRYPTO_COMPARE_CURRENCIES);\n/**\n * Fiat currencies that we support\n */\nfunction supportedFiatCurrencies(provider) {\n  const providerSupportedFiatCurrencies = PROVIDER_SUPPORTED_FIAT_CURRENCIES[provider];\n  return providerSupportedFiatCurrencies.filter(currency => cryptoCompareCurrenciesSet.has(currency));\n}\n\nconst paymentProviders$1 = {\n  [PAYMENT_PROVIDER.MOONPAY]: {\n    line1: \"Credit/ Debit Card/ Apple Pay\",\n    line2: \"4.5% or 5 USD\",\n    line3: \"2,000/day, 10,000/mo\",\n    supportPage: \"https://help.moonpay.io/en/\",\n    minOrderValue: 24.99,\n    maxOrderValue: 50000,\n    validCurrencies: supportedFiatCurrencies(PAYMENT_PROVIDER.MOONPAY),\n    validCryptoCurrenciesByChain: {\n      [SUPPORTED_PAYMENT_NETWORK.MAINNET]: [{\n        value: \"aave\",\n        display: \"AAVE\"\n      }, {\n        value: \"bat\",\n        display: \"BAT\"\n      }, {\n        value: \"dai\",\n        display: \"DAI\"\n      }, {\n        value: \"eth\",\n        display: \"ETH\"\n      }, {\n        value: \"mkr\",\n        display: \"MKR\"\n      }, {\n        value: \"matic\",\n        display: \"MATIC\"\n      }, {\n        value: \"usdt\",\n        display: \"USDT\"\n      }, {\n        value: \"usdc\",\n        display: \"USDC\"\n      }],\n      [SUPPORTED_PAYMENT_NETWORK.MATIC]: [{\n        value: \"eth_polygon\",\n        display: \"ETH\"\n      }, {\n        value: \"matic_polygon\",\n        display: \"MATIC\"\n      }, {\n        value: \"usdc_polygon\",\n        display: \"USDC\"\n      }],\n      [SUPPORTED_PAYMENT_NETWORK.BSC_MAINNET]: [{\n        value: \"bnb_bsc\",\n        display: \"BNB\"\n      }, {\n        value: \"busd_bsc\",\n        display: \"BUSD\"\n      }],\n      [SUPPORTED_PAYMENT_NETWORK.AVALANCHE_MAINNET]: [{\n        value: \"avax_cchain\",\n        display: \"AVAX\"\n      }]\n    },\n    includeFees: true,\n    api: true,\n    enforceMax: false\n  },\n  [PAYMENT_PROVIDER.WYRE]: {\n    line1: \"Apple Pay/ Debit/ Credit Card\",\n    line2: \"4.9% + 30 or 5 USD\",\n    line3: \"$250/day\",\n    supportPage: \"https://support.sendwyre.com/en/\",\n    minOrderValue: 5,\n    maxOrderValue: 500,\n    validCurrencies: supportedFiatCurrencies(PAYMENT_PROVIDER.WYRE),\n    validCryptoCurrenciesByChain: {\n      [SUPPORTED_PAYMENT_NETWORK.MAINNET]: [{\n        value: \"AAVE\",\n        display: \"AAVE\"\n      }, {\n        value: \"BAT\",\n        display: \"BAT\"\n      }, {\n        value: \"BUSD\",\n        display: \"BUSD\"\n      }, {\n        value: \"DAI\",\n        display: \"DAI\"\n      }, {\n        value: \"ETH\",\n        display: \"ETH\"\n      }, {\n        value: \"MKR\",\n        display: \"MKR\"\n      }, {\n        value: \"UNI\",\n        display: \"UNI\"\n      }, {\n        value: \"USDC\",\n        display: \"USDC\"\n      }, {\n        value: \"USDT\",\n        display: \"USDT\"\n      }],\n      [SUPPORTED_PAYMENT_NETWORK.MATIC]: [{\n        value: \"MUSDC\",\n        display: \"USDC\"\n      }],\n      // AVAXC? or AVAX?\n      [SUPPORTED_PAYMENT_NETWORK.AVALANCHE_MAINNET]: [{\n        value: \"AVAXC\",\n        display: \"AVAXC\"\n      }]\n    },\n    includeFees: false,\n    api: true,\n    enforceMax: false\n  },\n  [PAYMENT_PROVIDER.RAMPNETWORK]: {\n    line1: \"Debit Card/ <br>Apple Pay/ Bank transfer\",\n    line2: \"0.49% - 2.9%\",\n    line3: \"5,000/purchase, 20,000/mo\",\n    supportPage: \"https://instant.ramp.network/\",\n    minOrderValue: 50,\n    maxOrderValue: 20000,\n    validCurrencies: supportedFiatCurrencies(PAYMENT_PROVIDER.RAMPNETWORK),\n    validCryptoCurrenciesByChain: {\n      [SUPPORTED_PAYMENT_NETWORK.MAINNET]: [{\n        value: \"ETH\",\n        display: \"ETH\"\n      }, {\n        value: \"DAI\",\n        display: \"DAI\"\n      }, {\n        value: \"USDC\",\n        display: \"USDC\"\n      }, {\n        value: \"USDT\",\n        display: \"USDT\"\n      }],\n      [SUPPORTED_PAYMENT_NETWORK.MATIC]: [{\n        value: \"MATIC_DAI\",\n        display: \"DAI\"\n      }, {\n        value: \"MATIC_MATIC\",\n        display: \"MATIC\"\n      }, {\n        value: \"MATIC_USDC\",\n        display: \"USDC\"\n      }],\n      // what about AVAXC?\n      [SUPPORTED_PAYMENT_NETWORK.AVALANCHE_MAINNET]: [{\n        value: \"AVAX\",\n        display: \"AVAX\"\n      }]\n      // Temporary unavailable\n      // [SUPPORTED_PAYMENT_NETWORK.XDAI]: [{ value: 'XDAI_XDAI', display: 'XDAI' }],\n    },\n\n    includeFees: true,\n    api: true,\n    receiveHint: \"walletTopUp.receiveHintRamp\",\n    enforceMax: false\n  },\n  [PAYMENT_PROVIDER.XANPOOL]: {\n    line1: \"PayNow/ InstaPay/ FPS/ GoJekPay/ UPI/ PromptPay/ <br>ViettelPay/ DuitNow\",\n    line2: \"2.5% buying, 3% selling\",\n    line3: \"$2,500 / day\",\n    supportPage: \"mailto:support@xanpool.com\",\n    minOrderValue: 100,\n    maxOrderValue: 2500,\n    validCurrencies: supportedFiatCurrencies(PAYMENT_PROVIDER.XANPOOL),\n    validCryptoCurrenciesByChain: {\n      [SUPPORTED_PAYMENT_NETWORK.MAINNET]: [{\n        value: \"ETH\",\n        display: \"ETH\"\n      }, {\n        value: \"USDT\",\n        display: \"USDT\"\n      }]\n    },\n    includeFees: true,\n    api: true,\n    sell: true,\n    enforceMax: false\n  },\n  [PAYMENT_PROVIDER.MERCURYO]: {\n    line1: \"Credit/ Debit Card/ Apple Pay\",\n    line2: \"3.95% or 4 USD\",\n    line3: \"10,000/day, 25,000/mo\",\n    supportPage: \"mailto:support@mercuryo.io\",\n    minOrderValue: 30,\n    maxOrderValue: 5000,\n    validCurrencies: supportedFiatCurrencies(PAYMENT_PROVIDER.MERCURYO),\n    validCryptoCurrenciesByChain: {\n      [SUPPORTED_PAYMENT_NETWORK.MAINNET]: [{\n        value: \"ETH\",\n        display: \"ETH\"\n      }, {\n        value: \"BAT\",\n        display: \"BAT\"\n      }, {\n        value: \"USDT\",\n        display: \"USDT\"\n      }, {\n        value: \"DAI\",\n        display: \"DAI\"\n      }],\n      [SUPPORTED_PAYMENT_NETWORK.BSC_MAINNET]: [{\n        value: \"BNB\",\n        display: \"BNB\"\n      }, {\n        value: \"BUSD\",\n        display: \"BUSD\"\n      }, {\n        value: \"1INCH\",\n        display: \"1INCH\"\n      }]\n    },\n    includeFees: true,\n    api: true,\n    enforceMax: false\n  },\n  [PAYMENT_PROVIDER.TRANSAK]: {\n    line1: \"Apple & Google Pay / Credit/Debit Card<br/>Bangkok Bank Mobile & iPay<br/>Bank Transfer (sepa/gbp) / SCB Mobile & Easy\",\n    line2: \"0.99% - 5.5% or 5 USD\",\n    line3: \"$5,000/day, $28,000/mo\",\n    supportPage: \"https://support.transak.com/hc/en-US\",\n    minOrderValue: 30,\n    maxOrderValue: 500,\n    validCurrencies: supportedFiatCurrencies(PAYMENT_PROVIDER.TRANSAK),\n    validCryptoCurrenciesByChain: {\n      [SUPPORTED_PAYMENT_NETWORK.MAINNET]: [{\n        value: \"AAVE\",\n        display: \"AAVE\"\n      }, {\n        value: \"DAI\",\n        display: \"DAI\"\n      }, {\n        value: \"ETH\",\n        display: \"ETH\"\n      }, {\n        value: \"USDC\",\n        display: \"USDC\"\n      }, {\n        value: \"USDT\",\n        display: \"USDT\"\n      }],\n      [SUPPORTED_PAYMENT_NETWORK.MATIC]: [{\n        value: \"AAVE\",\n        display: \"AAVE\"\n      }, {\n        value: \"DAI\",\n        display: \"DAI\"\n      }, {\n        value: \"MATIC\",\n        display: \"MATIC\"\n      }, {\n        value: \"USDC\",\n        display: \"USDC\"\n      }, {\n        value: \"USDT\",\n        display: \"USDT\"\n      }, {\n        value: \"WETH\",\n        display: \"WETH\"\n      }],\n      [SUPPORTED_PAYMENT_NETWORK.BSC_MAINNET]: [{\n        value: \"BNB\",\n        display: \"BNB\"\n      }, {\n        value: \"BUSD\",\n        display: \"BUSD\"\n      }],\n      [SUPPORTED_PAYMENT_NETWORK.AVALANCHE_MAINNET]: [{\n        value: \"AVAX\",\n        display: \"AVAX\"\n      }]\n    },\n    includeFees: true,\n    enforceMax: true\n  },\n  [PAYMENT_PROVIDER.BANXA]: {\n    line1: \"Debit Card/ <br>Apple Pay/ Bank transfer\",\n    line2: \"0.49% - 2.9%\",\n    line3: \"5,000/purchase, 20,000/mo\",\n    supportPage: \"https://support.banxa.com\",\n    minOrderValue: 20,\n    maxOrderValue: 15000,\n    validCurrencies: supportedFiatCurrencies(PAYMENT_PROVIDER.BANXA),\n    validCryptoCurrenciesByChain: {\n      [SUPPORTED_PAYMENT_NETWORK.MAINNET]: [{\n        value: \"ETH\",\n        display: \"ETH\"\n      }, {\n        value: \"USDT\",\n        display: \"USDT\"\n      }, {\n        value: \"BUSD\",\n        display: \"BUSD\"\n      }, {\n        value: \"LINK\",\n        display: \"LINK\"\n      }, {\n        value: \"USDC\",\n        display: \"USDC\"\n      }, {\n        value: \"CHZ\",\n        display: \"CHZ\"\n      }, {\n        value: \"BAT\",\n        display: \"BAT\"\n      }, {\n        value: \"MANA\",\n        display: \"MANA\"\n      }, {\n        value: \"AAVE\",\n        display: \"AAVE\"\n      }, {\n        value: \"COMP\",\n        display: \"COMP\"\n      }, {\n        value: \"ENJ\",\n        display: \"ENJ\"\n      }],\n      [SUPPORTED_PAYMENT_NETWORK.MATIC]: [{\n        value: \"MATIC\",\n        display: \"MATIC\"\n      }]\n      // [SUPPORTED_PAYMENT_NETWORK.BSC_MAINNET]: [{ value: \"BNB\", display: \"BNB\" }],\n    },\n\n    includeFees: true,\n    enforceMax: true\n  }\n};\nconst translations = {\n  en: {\n    embed: {\n      continue: \"Continue\",\n      actionRequired: \"Authorization required\",\n      pendingAction: \"Click continue to proceed with your request in a popup\",\n      cookiesRequired: \"Cookies Required\",\n      enableCookies: \"Please enable cookies in your browser preferences to access Torus\",\n      clickHere: \"More Info\"\n    }\n  },\n  de: {\n    embed: {\n      continue: \"Fortsetzen\",\n      actionRequired: \"Autorisierung erforderlich\",\n      pendingAction: \"Klicken Sie in einem Popup auf Weiter, um mit Ihrer Anfrage fortzufahren\",\n      cookiesRequired: \"Cookies bentigt\",\n      enableCookies: \"Bitte aktivieren Sie Cookies in Ihren Browsereinstellungen, um auf Torus zuzugreifen\",\n      clickHere: \"Mehr Info\"\n    }\n  },\n  ja: {\n    embed: {\n      continue: \"\",\n      actionRequired: \"\",\n      pendingAction: \"\",\n      cookiesRequired: \"\",\n      enableCookies: \"TorusCookie\",\n      clickHere: \"\"\n    }\n  },\n  ko: {\n    embed: {\n      continue: \"\",\n      actionRequired: \" \",\n      pendingAction: \"    .\",\n      cookiesRequired: \" \",\n      enableCookies: \"     Torus .\",\n      clickHere: \"  \"\n    }\n  },\n  zh: {\n    embed: {\n      continue: \"\",\n      actionRequired: \"\",\n      pendingAction: \"\",\n      cookiesRequired: \"Cookie\",\n      enableCookies: \"cookieTorus\",\n      clickHere: \"\"\n    }\n  }\n};\nvar configuration = {\n  supportedVerifierList: Object.values(WALLET_VERIFIERS),\n  paymentProviders: paymentProviders$1,\n  api: \"https://api.tor.us\",\n  translations,\n  prodTorusUrl: \"\",\n  localStorageKeyPrefix: `torus-`\n};\n\nconst runOnLoad = fn => new Promise((resolve, reject) => {\n  if (window.document.body != null) {\n    Promise.resolve(fn()).then(resolve).catch(reject);\n  } else {\n    window.document.addEventListener(\"DOMContentLoaded\", () => {\n      Promise.resolve(fn()).then(resolve).catch(reject);\n    });\n  }\n});\nconst htmlToElement = html => {\n  const template = window.document.createElement(\"template\");\n  const trimmedHtml = html.trim(); // Never return a text node of whitespace as the result\n  template.innerHTML = trimmedHtml;\n  return template.content.firstChild;\n};\nconst handleEvent = function (handle, eventName, handler) {\n  for (var _len = arguments.length, handlerArgs = new Array(_len > 3 ? _len - 3 : 0), _key = 3; _key < _len; _key++) {\n    handlerArgs[_key - 3] = arguments[_key];\n  }\n  const handlerWrapper = () => {\n    handler(...handlerArgs);\n    handle.removeEventListener(eventName, handlerWrapper);\n  };\n  handle.addEventListener(eventName, handlerWrapper);\n};\nconst handleStream = (handle, eventName, handler) => {\n  const handlerWrapper = chunk => {\n    handler(chunk);\n    handle.removeListener(eventName, handlerWrapper);\n  };\n  handle.on(eventName, handlerWrapper);\n};\nasync function documentReady() {\n  return new Promise(resolve => {\n    if (document.readyState !== \"loading\") {\n      resolve();\n    } else {\n      handleEvent(document, \"DOMContentLoaded\", resolve);\n    }\n  });\n}\n\nvar log = loglevel.getLogger(\"torus-embed\");\n\nvar messages = {\n  errors: {\n    disconnected: () => \"Torus: Lost connection to Torus.\",\n    permanentlyDisconnected: () => \"Torus: Disconnected from iframe. Page reload required.\",\n    sendSiteMetadata: () => \"Torus: Failed to send site metadata. This is an internal error, please report this bug.\",\n    unsupportedSync: method => `Torus: The Torus Ethereum provider does not support synchronous methods like ${method} without a callback parameter.`,\n    invalidDuplexStream: () => \"Must provide a Node.js-style duplex stream.\",\n    invalidOptions: (maxEventListeners, shouldSendMetadata) => `Invalid options. Received: { maxEventListeners: ${maxEventListeners}, shouldSendMetadata: ${shouldSendMetadata} }`,\n    invalidRequestArgs: () => `Expected a single, non-array, object argument.`,\n    invalidRequestMethod: () => `'args.method' must be a non-empty string.`,\n    invalidRequestParams: () => `'args.params' must be an object or array if provided.`,\n    invalidLoggerObject: () => `'args.logger' must be an object if provided.`,\n    invalidLoggerMethod: method => `'args.logger' must include required method '${method}'.`\n  },\n  info: {\n    connected: chainId => `Torus: Connected to chain with ID \"${chainId}\".`\n  },\n  warnings: {\n    // deprecated methods\n    enableDeprecation: 'Torus: \"\"ethereum.enable()\" is deprecated and may be removed in the future. ' + 'Please use \"ethereum.send(\"eth_requestAccounts\")\" instead. For more information, see: https://eips.ethereum.org/EIPS/eip-1102',\n    sendDeprecation: 'Torus: \"ethereum.send(...)\" is deprecated and may be removed in the future.' + ' Please use \"ethereum.sendAsync(...)\" or \"ethereum.request(...)\" instead.\\nFor more information, see: https://eips.ethereum.org/EIPS/eip-1193',\n    events: {\n      close: 'Torus: The event \"close\" is deprecated and may be removed in the future. Please use \"disconnect\" instead.' + \"\\nFor more information, see: https://eips.ethereum.org/EIPS/eip-1193\",\n      data: 'Torus: The event \"data\" is deprecated and will be removed in the future.' + 'Use \"message\" instead.\\nFor more information, see: https://eips.ethereum.org/EIPS/eip-1193#message',\n      networkChanged: 'Torus: The event \"networkChanged\" is deprecated and may be removed in the future.' + ' Please use \"chainChanged\" instead.\\nFor more information, see: https://eips.ethereum.org/EIPS/eip-1193',\n      notification: 'Torus: The event \"notification\" is deprecated and may be removed in the future. ' + 'Please use \"message\" instead.\\nFor more information, see: https://eips.ethereum.org/EIPS/eip-1193'\n    },\n    publicConfigStore: 'Torus: The property \"publicConfigStore\" is deprecated and WILL be removed in the future.'\n  }\n};\n\nconst {\n  paymentProviders\n} = configuration;\nconst validatePaymentProvider = (provider, params) => {\n  const errors = {};\n  if (!provider) {\n    return {\n      errors,\n      isValid: true\n    };\n  }\n  if (provider && !paymentProviders[provider]) {\n    errors.provider = \"Invalid Provider\";\n    return {\n      errors,\n      isValid: Object.keys(errors).length === 0\n    };\n  }\n  const selectedProvider = paymentProviders[provider];\n  const selectedParams = params || {};\n  // set default values\n  // if (!selectedParams.selectedCurrency) [selectedParams.selectedCurrency] = selectedProvider.validCurrencies\n  // if (!selectedParams.fiatValue) selectedParams.fiatValue = selectedProvider.minOrderValue\n  // if (!selectedParams.selectedCryptoCurrency) [selectedParams.selectedCryptoCurrency] = selectedProvider.validCryptoCurrencies\n  // validations\n  if (selectedParams.fiatValue) {\n    const requestedOrderAmount = +parseFloat(selectedParams.fiatValue.toString()) || 0;\n    if (requestedOrderAmount < selectedProvider.minOrderValue) errors.fiatValue = \"Requested amount is lower than supported\";\n    if (requestedOrderAmount > selectedProvider.maxOrderValue && selectedProvider.enforceMax) errors.fiatValue = \"Requested amount is higher than supported\";\n  }\n  if (selectedParams.selectedCurrency && !selectedProvider.validCurrencies.includes(selectedParams.selectedCurrency)) {\n    errors.selectedCurrency = \"Unsupported currency\";\n  }\n  if (selectedParams.selectedCryptoCurrency) {\n    const validCryptoCurrenciesByChain = Object.values(selectedProvider.validCryptoCurrenciesByChain).flat().map(currency => currency.value);\n    const finalCryptoCurrency = provider === PAYMENT_PROVIDER.MOONPAY ? selectedParams.selectedCryptoCurrency.toLowerCase() : selectedParams.selectedCryptoCurrency;\n    if (validCryptoCurrenciesByChain && !validCryptoCurrenciesByChain.includes(finalCryptoCurrency)) errors.selectedCryptoCurrency = \"Unsupported cryptoCurrency\";\n  }\n  return {\n    errors,\n    isValid: Object.keys(errors).length === 0\n  };\n};\n// utility functions\n/**\n * json-rpc-engine middleware that logs RPC errors and and validates req.method.\n *\n * @param log - The logging API to use.\n * @returns  json-rpc-engine middleware function\n */\nfunction createErrorMiddleware() {\n  return (req, res, next) => {\n    // json-rpc-engine will terminate the request when it notices this error\n    if (typeof req.method !== \"string\" || !req.method) {\n      res.error = ethErrors.rpc.invalidRequest({\n        message: `The request 'method' must be a non-empty string.`,\n        data: req\n      });\n    }\n    next(done => {\n      const {\n        error\n      } = res;\n      if (!error) {\n        return done();\n      }\n      log.error(`MetaMask - RPC Error: ${error.message}`, error);\n      return done();\n    });\n  };\n}\n/**\n * Logs a stream disconnection error. Emits an 'error' if given an\n * EventEmitter that has listeners for the 'error' event.\n *\n * @param log - The logging API to use.\n * @param remoteLabel - The label of the disconnected stream.\n * @param error - The associated error to log.\n * @param emitter - The logging API to use.\n */\nfunction logStreamDisconnectWarning(remoteLabel, error, emitter) {\n  let warningMsg = `MetaMask: Lost connection to \"${remoteLabel}\".`;\n  if (error?.stack) {\n    warningMsg += `\\n${error.stack}`;\n  }\n  log.warn(warningMsg);\n  if (emitter && emitter.listenerCount(\"error\") > 0) {\n    emitter.emit(\"error\", warningMsg);\n  }\n}\nconst getPreopenInstanceId = () => Math.random().toString(36).slice(2);\nconst getTorusUrl = async (buildEnv, integrity) => {\n  let torusUrl;\n  let logLevel;\n  // Do not change this line\n  const version = \"1.41.3\";\n  let versionUsed = integrity.version || version;\n  try {\n    if ((buildEnv === \"binance\" || buildEnv === \"production\") && !integrity.version) {\n      let response;\n      if (!configuration.prodTorusUrl) response = await get(`${configuration.api}/latestversion?name=@toruslabs/torus-embed&version=${version}`, {}, {\n        useAPIKey: true\n      });else response = {\n        data: configuration.prodTorusUrl\n      };\n      versionUsed = response.data;\n      // eslint-disable-next-line require-atomic-updates\n      configuration.prodTorusUrl = response.data;\n    }\n  } catch (error) {\n    log.error(error, \"unable to fetch latest version\");\n  }\n  log.info(\"version used: \", versionUsed);\n  switch (buildEnv) {\n    case \"binance\":\n      torusUrl = `https://binance.tor.us/v${versionUsed}`;\n      logLevel = \"info\";\n      break;\n    case \"testing\":\n      torusUrl = \"https://testing.tor.us\";\n      logLevel = \"debug\";\n      break;\n    case \"bnb\":\n      torusUrl = \"https://bnb.tor.us\";\n      logLevel = \"error\";\n      break;\n    case \"polygon\":\n      torusUrl = \"https://polygon.tor.us\";\n      logLevel = \"error\";\n      break;\n    case \"lrc\":\n      torusUrl = \"https://lrc.tor.us\";\n      logLevel = \"debug\";\n      break;\n    case \"beta\":\n      torusUrl = \"https://beta.tor.us\";\n      logLevel = \"debug\";\n      break;\n    case \"development\":\n      torusUrl = \"http://localhost:4050\";\n      logLevel = \"debug\";\n      break;\n    default:\n      torusUrl = `https://app.tor.us/v${versionUsed}`;\n      logLevel = \"error\";\n      break;\n  }\n  return {\n    torusUrl,\n    logLevel\n  };\n};\nconst getUserLanguage = () => {\n  let userLanguage = window.navigator.language || \"en-US\";\n  const userLanguages = userLanguage.split(\"-\");\n  userLanguage = Object.prototype.hasOwnProperty.call(configuration.translations, userLanguages[0]) ? userLanguages[0] : \"en\";\n  return userLanguage;\n};\nconst EMITTED_NOTIFICATIONS = [\"eth_subscription\" // per eth-json-rpc-filters/subscriptionManager\n];\n\nconst NOOP = () => {\n  // empty function\n};\nconst FEATURES_PROVIDER_CHANGE_WINDOW = \"directories=0,titlebar=0,toolbar=0,status=0,location=0,menubar=0,height=660,width=375\";\nconst FEATURES_DEFAULT_WALLET_WINDOW = \"directories=0,titlebar=0,toolbar=0,status=0,location=0,menubar=0,height=740,width=1315\";\nconst FEATURES_CONFIRM_WINDOW = \"directories=0,titlebar=0,toolbar=0,status=0,location=0,menubar=0,height=700,width=450\";\nfunction getPopupFeatures() {\n  // Fixes dual-screen position                             Most browsers      Firefox\n  const dualScreenLeft = window.screenLeft !== undefined ? window.screenLeft : window.screenX;\n  const dualScreenTop = window.screenTop !== undefined ? window.screenTop : window.screenY;\n  const w = 1200;\n  const h = 700;\n  const width = window.innerWidth ? window.innerWidth : document.documentElement.clientWidth ? document.documentElement.clientWidth : window.screen.width;\n  const height = window.innerHeight ? window.innerHeight : document.documentElement.clientHeight ? document.documentElement.clientHeight : window.screen.height;\n  const systemZoom = 1; // No reliable estimate\n  const left = Math.abs((width - w) / 2 / systemZoom + dualScreenLeft);\n  const top = Math.abs((height - h) / 2 / systemZoom + dualScreenTop);\n  const features = `titlebar=0,toolbar=0,status=0,location=0,menubar=0,height=${h / systemZoom},width=${w / systemZoom},top=${top},left=${left}`;\n  return features;\n}\n\nfunction ownKeys$1(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\nfunction _objectSpread$1(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys$1(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys$1(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\nSafeEventEmitter.defaultMaxListeners = 100;\n// resolve response.result, reject errors\nconst getRpcPromiseCallback = function (resolve, reject) {\n  let unwrapResult = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;\n  return (error, response) => {\n    if (error || response.error) {\n      return reject(error || response.error);\n    }\n    return !unwrapResult || Array.isArray(response) ? resolve(response) : resolve(response.result);\n  };\n};\nclass TorusInpageProvider extends SafeEventEmitter {\n  /**\n   * The chain ID of the currently connected Ethereum chain.\n   * See [chainId.network]{@link https://chainid.network} for more information.\n   */\n\n  /**\n   * The user's currently selected Ethereum address.\n   * If null, MetaMask is either locked or the user has not permitted any\n   * addresses to be viewed.\n   */\n\n  /**\n   * Indicating that this provider is a MetaMask provider.\n   */\n\n  constructor(connectionStream) {\n    let {\n      maxEventListeners = 100,\n      shouldSendMetadata = true,\n      jsonRpcStreamName = \"provider\"\n    } = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    super();\n    _defineProperty(this, \"chainId\", void 0);\n    _defineProperty(this, \"selectedAddress\", void 0);\n    _defineProperty(this, \"_rpcEngine\", void 0);\n    _defineProperty(this, \"networkVersion\", void 0);\n    _defineProperty(this, \"shouldSendMetadata\", void 0);\n    _defineProperty(this, \"isTorus\", void 0);\n    _defineProperty(this, \"_publicConfigStore\", void 0);\n    _defineProperty(this, \"tryPreopenHandle\", void 0);\n    _defineProperty(this, \"enable\", void 0);\n    _defineProperty(this, \"_state\", void 0);\n    _defineProperty(this, \"_jsonRpcConnection\", void 0);\n    _defineProperty(this, \"_sentWarnings\", {\n      // methods\n      enable: false,\n      experimentalMethods: false,\n      send: false,\n      publicConfigStore: false,\n      // events\n      events: {\n        close: false,\n        data: false,\n        networkChanged: false,\n        notification: false\n      }\n    });\n    if (!duplex(connectionStream)) {\n      throw new Error(messages.errors.invalidDuplexStream());\n    }\n    this.isTorus = true;\n    this.setMaxListeners(maxEventListeners);\n    // private state\n    this._state = _objectSpread$1({}, TorusInpageProvider._defaultState);\n    // public state\n    this.selectedAddress = null;\n    this.networkVersion = null;\n    this.chainId = null;\n    this.shouldSendMetadata = shouldSendMetadata;\n    // bind functions (to prevent e.g. web3@1.x from making unbound calls)\n    this._handleAccountsChanged = this._handleAccountsChanged.bind(this);\n    this._handleChainChanged = this._handleChainChanged.bind(this);\n    this._handleUnlockStateChanged = this._handleUnlockStateChanged.bind(this);\n    this._handleConnect = this._handleConnect.bind(this);\n    this._handleDisconnect = this._handleDisconnect.bind(this);\n    this._handleStreamDisconnect = this._handleStreamDisconnect.bind(this);\n    this._sendSync = this._sendSync.bind(this);\n    this._rpcRequest = this._rpcRequest.bind(this);\n    this._warnOfDeprecation = this._warnOfDeprecation.bind(this);\n    this._initializeState = this._initializeState.bind(this);\n    this.request = this.request.bind(this);\n    this.send = this.send.bind(this);\n    this.sendAsync = this.sendAsync.bind(this);\n    // this.enable = this.enable.bind(this);\n    // setup connectionStream multiplexing\n    const mux = new ObjectMultiplex();\n    pump(connectionStream, mux, connectionStream, this._handleStreamDisconnect.bind(this, \"MetaMask\"));\n    // subscribe to metamask public config (one-way)\n    this._publicConfigStore = new ObservableStore({\n      storageKey: \"Metamask-Config\"\n    });\n    // handle isUnlocked changes, and chainChanged and networkChanged events\n    // this._publicConfigStore.subscribe((stringifiedState) => {\n    //   // This is because we are using store as string\n    //   const state = JSON.parse(stringifiedState as unknown as string);\n    //   if (\"isUnlocked\" in state && state.isUnlocked !== this._state.isUnlocked) {\n    //     this._state.isUnlocked = state.isUnlocked;\n    //     if (!this._state.isUnlocked) {\n    //       // accounts are never exposed when the extension is locked\n    //       this._handleAccountsChanged([]);\n    //     } else {\n    //       // this will get the exposed accounts, if any\n    //       try {\n    //         this._rpcRequest(\n    //           { method: \"eth_accounts\", params: [] },\n    //           NOOP,\n    //           true // indicating that eth_accounts _should_ update accounts\n    //         );\n    //       } catch (_) {\n    //         // Swallow error\n    //       }\n    //     }\n    //   }\n    //   if (\"selectedAddress\" in state && this.selectedAddress !== state.selectedAddress) {\n    //     try {\n    //       this._rpcRequest(\n    //         { method: \"eth_accounts\", params: [] },\n    //         NOOP,\n    //         true // indicating that eth_accounts _should_ update accounts\n    //       );\n    //     } catch (_) {\n    //       // Swallow error\n    //     }\n    //   }\n    //   // Emit chainChanged event on chain change\n    //   if (\"chainId\" in state && state.chainId !== this.chainId) {\n    //     this.chainId = state.chainId || null;\n    //     this.emit(\"chainChanged\", this.chainId);\n    //     // indicate that we've connected, for EIP-1193 compliance\n    //     // we do this here so that iframe can initialize\n    //     if (!this._state.hasEmittedConnection) {\n    //       this._handleConnect(this.chainId);\n    //       this._state.hasEmittedConnection = true;\n    //     }\n    //   }\n    //   // Emit networkChanged event on network change\n    //   if (\"networkVersion\" in state && state.networkVersion !== this.networkVersion) {\n    //     this.networkVersion = state.networkVersion || null;\n    //     this.emit(\"networkChanged\", this.networkVersion);\n    //   }\n    // });\n    pump(mux.createStream(\"publicConfig\"), storeAsStream(this._publicConfigStore),\n    // RPC requests should still work if only this stream fails\n    logStreamDisconnectWarning.bind(this, \"MetaMask PublicConfigStore\"));\n    // ignore phishing warning message (handled elsewhere)\n    mux.ignoreStream(\"phishing\");\n    // setup own event listeners\n    // EIP-1193 connect\n    this.on(\"connect\", () => {\n      this._state.isConnected = true;\n    });\n    // connect to async provider\n    const jsonRpcConnection = createStreamMiddleware();\n    pump(jsonRpcConnection.stream, mux.createStream(jsonRpcStreamName), jsonRpcConnection.stream, this._handleStreamDisconnect.bind(this, \"MetaMask RpcProvider\"));\n    // handle RPC requests via dapp-side rpc engine\n    const rpcEngine = new JRPCEngine();\n    rpcEngine.push(createIdRemapMiddleware());\n    rpcEngine.push(createErrorMiddleware());\n    rpcEngine.push(jsonRpcConnection.middleware);\n    this._rpcEngine = rpcEngine;\n    // json rpc notification listener\n    jsonRpcConnection.events.on(\"notification\", payload => {\n      const {\n        method,\n        params\n      } = payload;\n      if (method === \"wallet_accountsChanged\") {\n        this._handleAccountsChanged(params);\n      } else if (method === \"wallet_unlockStateChanged\") {\n        this._handleUnlockStateChanged(params);\n      } else if (method === \"wallet_chainChanged\") {\n        this._handleChainChanged(params);\n      } else if (EMITTED_NOTIFICATIONS.includes(payload.method)) {\n        // EIP 1193 subscriptions, per eth-json-rpc-filters/subscriptionManager\n        this.emit(\"data\", payload); // deprecated\n        this.emit(\"notification\", params.result);\n        this.emit(\"message\", {\n          type: method,\n          data: params\n        });\n      }\n      // Backward compatibility for older non EIP 1193 subscriptions\n      // this.emit('data', null, payload)\n    });\n  }\n\n  get publicConfigStore() {\n    if (!this._sentWarnings.publicConfigStore) {\n      log.warn(messages.warnings.publicConfigStore);\n      this._sentWarnings.publicConfigStore = true;\n    }\n    return this._publicConfigStore;\n  }\n  /**\n   * Returns whether the inpage provider is connected to Torus.\n   */\n  isConnected() {\n    return this._state.isConnected;\n  }\n  /**\n   * Submits an RPC request for the given method, with the given params.\n   * Resolves with the result of the method call, or rejects on error.\n   *\n   * @param args - The RPC request arguments.\n   * @returns A Promise that resolves with the result of the RPC method,\n   * or rejects if an error is encountered.\n   */\n  async request(args) {\n    if (!args || typeof args !== \"object\" || Array.isArray(args)) {\n      throw ethErrors.rpc.invalidRequest({\n        message: messages.errors.invalidRequestArgs(),\n        data: args\n      });\n    }\n    const {\n      method,\n      params\n    } = args;\n    if (typeof method !== \"string\" || method.length === 0) {\n      throw ethErrors.rpc.invalidRequest({\n        message: messages.errors.invalidRequestMethod(),\n        data: args\n      });\n    }\n    if (params !== undefined && !Array.isArray(params) && (typeof params !== \"object\" || params === null)) {\n      throw ethErrors.rpc.invalidRequest({\n        message: messages.errors.invalidRequestParams(),\n        data: args\n      });\n    }\n    return new Promise((resolve, reject) => {\n      this._rpcRequest({\n        method,\n        params\n      }, getRpcPromiseCallback(resolve, reject));\n    });\n  }\n  /**\n   * Submits an RPC request per the given JSON-RPC request object.\n   *\n   * @param payload - The RPC request object.\n   * @param cb - The callback function.\n   */\n  sendAsync(payload, callback) {\n    this._rpcRequest(payload, callback);\n  }\n  /**\n   * We override the following event methods so that we can warn consumers\n   * about deprecated events:\n   *   addListener, on, once, prependListener, prependOnceListener\n   */\n  addListener(eventName, listener) {\n    this._warnOfDeprecation(eventName);\n    return super.addListener(eventName, listener);\n  }\n  on(eventName, listener) {\n    this._warnOfDeprecation(eventName);\n    return super.on(eventName, listener);\n  }\n  once(eventName, listener) {\n    this._warnOfDeprecation(eventName);\n    return super.once(eventName, listener);\n  }\n  prependListener(eventName, listener) {\n    this._warnOfDeprecation(eventName);\n    return super.prependListener(eventName, listener);\n  }\n  prependOnceListener(eventName, listener) {\n    this._warnOfDeprecation(eventName);\n    return super.prependOnceListener(eventName, listener);\n  }\n  // Private Methods\n  //= ===================\n  /**\n   * Constructor helper.\n   * Populates initial state by calling 'wallet_getProviderState' and emits\n   * necessary events.\n   */\n  async _initializeState() {\n    try {\n      const {\n        accounts,\n        chainId,\n        isUnlocked,\n        networkVersion\n      } = await this.request({\n        method: \"wallet_getProviderState\"\n      });\n      // indicate that we've connected, for EIP-1193 compliance\n      this.emit(\"connect\", {\n        chainId\n      });\n      this._handleChainChanged({\n        chainId,\n        networkVersion\n      });\n      this._handleUnlockStateChanged({\n        accounts,\n        isUnlocked\n      });\n      this._handleAccountsChanged(accounts);\n    } catch (error) {\n      log.error(\"MetaMask: Failed to get initial state. Please report this bug.\", error);\n    } finally {\n      log.info(\"initialized state\");\n      this._state.initialized = true;\n      this.emit(\"_initialized\");\n    }\n  }\n  /**\n   * Internal RPC method. Forwards requests to background via the RPC engine.\n   * Also remap ids inbound and outbound.\n   *\n   * @param payload - The RPC request object.\n   * @param callback - The consumer's callback.\n   * @param isInternal - false - Whether the request is internal.\n   */\n  _rpcRequest(payload, callback) {\n    let isInternal = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n    let cb = callback;\n    const _payload = payload;\n    if (!Array.isArray(_payload)) {\n      if (!_payload.jsonrpc) {\n        _payload.jsonrpc = \"2.0\";\n      }\n      if (_payload.method === \"eth_accounts\" || _payload.method === \"eth_requestAccounts\") {\n        // handle accounts changing\n        cb = (err, res) => {\n          this._handleAccountsChanged(res.result || [], _payload.method === \"eth_accounts\", isInternal);\n          callback(err, res);\n        };\n      } else if (_payload.method === \"wallet_getProviderState\") {\n        this._rpcEngine.handle(payload, cb);\n        return;\n      }\n    }\n    this.tryPreopenHandle(_payload, cb);\n  }\n  send(methodOrPayload, callbackOrArgs) {\n    if (!this._sentWarnings.send) {\n      log.warn(messages.warnings.sendDeprecation);\n      this._sentWarnings.send = true;\n    }\n    if (typeof methodOrPayload === \"string\" && (!callbackOrArgs || Array.isArray(callbackOrArgs))) {\n      return new Promise((resolve, reject) => {\n        try {\n          this._rpcRequest({\n            method: methodOrPayload,\n            params: callbackOrArgs\n          }, getRpcPromiseCallback(resolve, reject, false));\n        } catch (error) {\n          reject(error);\n        }\n      });\n    }\n    if (methodOrPayload && typeof methodOrPayload === \"object\" && typeof callbackOrArgs === \"function\") {\n      return this._rpcRequest(methodOrPayload, callbackOrArgs);\n    }\n    return this._sendSync(methodOrPayload);\n  }\n  /**\n   * DEPRECATED.\n   * Internal backwards compatibility method, used in send.\n   */\n  _sendSync(payload) {\n    let result;\n    switch (payload.method) {\n      case \"eth_accounts\":\n        result = this.selectedAddress ? [this.selectedAddress] : [];\n        break;\n      case \"eth_coinbase\":\n        result = this.selectedAddress || null;\n        break;\n      case \"eth_uninstallFilter\":\n        this._rpcRequest(payload, NOOP);\n        result = true;\n        break;\n      case \"net_version\":\n        result = this.networkVersion || null;\n        break;\n      default:\n        throw new Error(messages.errors.unsupportedSync(payload.method));\n    }\n    return {\n      id: payload.id,\n      jsonrpc: payload.jsonrpc,\n      result\n    };\n  }\n  /**\n   * When the provider becomes connected, updates internal state and emits\n   * required events. Idempotent.\n   *\n   * @param chainId - The ID of the newly connected chain.\n   * emits MetaMaskInpageProvider#connect\n   */\n  _handleConnect(chainId) {\n    if (!this._state.isConnected) {\n      this._state.isConnected = true;\n      this.emit(\"connect\", {\n        chainId\n      });\n      log.debug(messages.info.connected(chainId));\n    }\n  }\n  /**\n   * When the provider becomes disconnected, updates internal state and emits\n   * required events. Idempotent with respect to the isRecoverable parameter.\n   *\n   * Error codes per the CloseEvent status codes as required by EIP-1193:\n   * https://developer.mozilla.org/en-US/docs/Web/API/CloseEvent#Status_codes\n   *\n   * @param isRecoverable - Whether the disconnection is recoverable.\n   * @param errorMessage - A custom error message.\n   * emits MetaMaskInpageProvider#disconnect\n   */\n  _handleDisconnect(isRecoverable, errorMessage) {\n    if (this._state.isConnected || !this._state.isPermanentlyDisconnected && !isRecoverable) {\n      this._state.isConnected = false;\n      let error;\n      if (isRecoverable) {\n        error = new EthereumRpcError(1013,\n        // Try again later\n        errorMessage || messages.errors.disconnected());\n        log.debug(error);\n      } else {\n        error = new EthereumRpcError(1011,\n        // Internal error\n        errorMessage || messages.errors.permanentlyDisconnected());\n        log.error(error);\n        this.chainId = null;\n        this._state.accounts = null;\n        this.selectedAddress = null;\n        this._state.isUnlocked = false;\n        this._state.isPermanentlyDisconnected = true;\n      }\n      this.emit(\"disconnect\", error);\n    }\n  }\n  /**\n   * Called when connection is lost to critical streams.\n   *\n   * emits MetamaskInpageProvider#disconnect\n   */\n  _handleStreamDisconnect(streamName, error) {\n    logStreamDisconnectWarning(streamName, error, this);\n    this._handleDisconnect(false, error ? error.message : undefined);\n  }\n  /**\n   * Called when accounts may have changed.\n   */\n  _handleAccountsChanged(accounts) {\n    let isEthAccounts = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n    let isInternal = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n    // defensive programming\n    let finalAccounts = accounts;\n    if (!Array.isArray(finalAccounts)) {\n      log.error(\"MetaMask: Received non-array accounts parameter. Please report this bug.\", finalAccounts);\n      finalAccounts = [];\n    }\n    for (const account of accounts) {\n      if (typeof account !== \"string\") {\n        log.error(\"MetaMask: Received non-string account. Please report this bug.\", accounts);\n        finalAccounts = [];\n        break;\n      }\n    }\n    // emit accountsChanged if anything about the accounts array has changed\n    if (!dequal(this._state.accounts, finalAccounts)) {\n      // we should always have the correct accounts even before eth_accounts\n      // returns, except in cases where isInternal is true\n      if (isEthAccounts && Array.isArray(this._state.accounts) && this._state.accounts.length > 0 && !isInternal) {\n        log.error('MetaMask: \"eth_accounts\" unexpectedly updated accounts. Please report this bug.', finalAccounts);\n      }\n      this._state.accounts = finalAccounts;\n      this.emit(\"accountsChanged\", finalAccounts);\n    }\n    // handle selectedAddress\n    if (this.selectedAddress !== finalAccounts[0]) {\n      this.selectedAddress = finalAccounts[0] || null;\n    }\n  }\n  /**\n   * Upon receipt of a new chainId and networkVersion, emits corresponding\n   * events and sets relevant public state.\n   * Does nothing if neither the chainId nor the networkVersion are different\n   * from existing values.\n   *\n   * emits MetamaskInpageProvider#chainChanged\n   * @param networkInfo - An object with network info.\n   */\n  _handleChainChanged() {\n    let {\n      chainId,\n      networkVersion\n    } = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    if (!chainId || !networkVersion) {\n      log.error(\"MetaMask: Received invalid network parameters. Please report this bug.\", {\n        chainId,\n        networkVersion\n      });\n      return;\n    }\n    if (networkVersion === \"loading\") {\n      this._handleDisconnect(true);\n    } else {\n      this._handleConnect(chainId);\n      if (chainId !== this.chainId) {\n        this.chainId = chainId;\n        if (this._state.initialized) {\n          this.emit(\"chainChanged\", this.chainId);\n        }\n      }\n    }\n  }\n  /**\n   * Upon receipt of a new isUnlocked state, sets relevant public state.\n   * Calls the accounts changed handler with the received accounts, or an empty\n   * array.\n   *\n   * Does nothing if the received value is equal to the existing value.\n   * There are no lock/unlock events.\n   *\n   * @param opts - Options bag.\n   */\n  _handleUnlockStateChanged() {\n    let {\n      accounts,\n      isUnlocked\n    } = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    if (typeof isUnlocked !== \"boolean\") {\n      log.error(\"MetaMask: Received invalid isUnlocked parameter. Please report this bug.\", {\n        isUnlocked\n      });\n      return;\n    }\n    if (isUnlocked !== this._state.isUnlocked) {\n      this._state.isUnlocked = isUnlocked;\n      this._handleAccountsChanged(accounts || []);\n    }\n  }\n  /**\n   * Warns of deprecation for the given event, if applicable.\n   */\n  _warnOfDeprecation(eventName) {\n    if (this._sentWarnings.events[eventName] === false) {\n      log.warn(messages.warnings.events[eventName]);\n      this._sentWarnings.events[eventName] = true;\n    }\n  }\n}\n_defineProperty(TorusInpageProvider, \"_defaultState\", {\n  accounts: null,\n  isConnected: false,\n  isUnlocked: false,\n  initialized: false,\n  isPermanentlyDisconnected: false,\n  hasEmittedConnection: false\n});\n\nconst defaults = options => ({\n  algorithms: options.algorithms || [\"sha256\"],\n  delimiter: options.delimiter || \" \",\n  full: options.full || false\n});\n// Generate list of hashes\nconst hashes = (options, data) => {\n  const internalHashes = {};\n  options.algorithms.forEach(algorithm => {\n    internalHashes[algorithm] = createHash(algorithm).update(data, \"utf8\").digest(\"base64\");\n  });\n  return internalHashes;\n};\n// Build an integrity string\nconst integrity = (options, sri) => {\n  let output = \"\";\n  // Hash list\n  output += Object.keys(sri.hashes).map(algorithm => `${algorithm}-${sri.hashes[algorithm]}`).join(options.delimiter);\n  return output;\n};\nconst main = (options, data) => {\n  // Defaults\n  const finalOptions = defaults(options);\n  const sri = {\n    hashes: hashes(finalOptions, data),\n    integrity: undefined\n  };\n  sri.integrity = integrity(finalOptions, sri);\n  return finalOptions.full ? sri : sri.integrity;\n};\n\nclass PopupHandler extends EventEmitter {\n  constructor(_ref) {\n    let {\n      url,\n      target,\n      features\n    } = _ref;\n    super();\n    _defineProperty(this, \"url\", void 0);\n    _defineProperty(this, \"target\", void 0);\n    _defineProperty(this, \"features\", void 0);\n    _defineProperty(this, \"window\", void 0);\n    _defineProperty(this, \"windowTimer\", void 0);\n    _defineProperty(this, \"iClosedWindow\", void 0);\n    this.url = url;\n    this.target = target || \"_blank\";\n    this.features = features || getPopupFeatures();\n    this.window = undefined;\n    this.windowTimer = undefined;\n    this.iClosedWindow = false;\n    this._setupTimer();\n  }\n  _setupTimer() {\n    this.windowTimer = Number(setInterval(() => {\n      if (this.window && this.window.closed) {\n        clearInterval(this.windowTimer);\n        if (!this.iClosedWindow) {\n          this.emit(\"close\");\n        }\n        this.iClosedWindow = false;\n        this.window = undefined;\n      }\n      if (this.window === undefined) clearInterval(this.windowTimer);\n    }, 500));\n  }\n  open() {\n    this.window = window.open(this.url.href, this.target, this.features);\n    if (this.window?.focus) this.window.focus();\n  }\n  close() {\n    this.iClosedWindow = true;\n    if (this.window) this.window.close();\n  }\n  redirect(locationReplaceOnRedirect) {\n    if (locationReplaceOnRedirect) {\n      window.location.replace(this.url.href);\n    } else {\n      window.location.href = this.url.href;\n    }\n  }\n}\n\n/**\n * Returns whether the given image URL exists\n * @param url - the url of the image\n * @returns - whether the image exists\n */\nfunction imgExists(url) {\n  return new Promise((resolve, reject) => {\n    try {\n      const img = document.createElement(\"img\");\n      img.onload = () => resolve(true);\n      img.onerror = () => resolve(false);\n      img.src = url;\n    } catch (e) {\n      reject(e);\n    }\n  });\n}\n/**\n * Extracts a name for the site from the DOM\n */\nconst getSiteName = window => {\n  const {\n    document\n  } = window;\n  const siteName = document.querySelector('head > meta[property=\"og:site_name\"]');\n  if (siteName) {\n    return siteName.content;\n  }\n  const metaTitle = document.querySelector('head > meta[name=\"title\"]');\n  if (metaTitle) {\n    return metaTitle.content;\n  }\n  if (document.title && document.title.length > 0) {\n    return document.title;\n  }\n  return window.location.hostname;\n};\n/**\n * Extracts an icon for the site from the DOM\n */\nasync function getSiteIcon(window) {\n  const {\n    document\n  } = window;\n  // Use the site's favicon if it exists\n  let icon = document.querySelector('head > link[rel=\"shortcut icon\"]');\n  if (icon && (await imgExists(icon.href))) {\n    return icon.href;\n  }\n  // Search through available icons in no particular order\n  icon = Array.from(document.querySelectorAll('head > link[rel=\"icon\"]')).find(_icon => Boolean(_icon.href));\n  if (icon && (await imgExists(icon.href))) {\n    return icon.href;\n  }\n  return null;\n}\n/**\n * Gets site metadata and returns it\n *\n */\nconst getSiteMetadata = async () => ({\n  name: getSiteName(window),\n  icon: await getSiteIcon(window)\n});\n/**\n * Sends site metadata over an RPC request.\n */\nasync function sendSiteMetadata(engine) {\n  try {\n    const domainMetadata = await getSiteMetadata();\n    // call engine.handle directly to avoid normal RPC request handling\n    engine.handle({\n      jsonrpc: \"2.0\",\n      id: getPreopenInstanceId(),\n      method: \"wallet_sendDomainMetadata\",\n      params: domainMetadata\n    }, NOOP);\n  } catch (error) {\n    log.error({\n      message: messages.errors.sendSiteMetadata(),\n      originalError: error\n    });\n  }\n}\n\nconst _excluded = [\"host\", \"chainId\", \"networkName\"];\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\nconst defaultVerifiers = {\n  [LOGIN_PROVIDER.GOOGLE]: true,\n  [LOGIN_PROVIDER.FACEBOOK]: true,\n  [LOGIN_PROVIDER.REDDIT]: true,\n  [LOGIN_PROVIDER.TWITCH]: true,\n  [LOGIN_PROVIDER.DISCORD]: true\n};\nconst iframeIntegrity = \"sha384-QwEWmiPwBSE0zoVFrfYw+zFNBRwBhOo6NucsqlJnGOqpUEVaRo1UOMrAKDykq2WP\";\nconst expectedCacheControlHeader = \"max-age=3600\";\nconst UNSAFE_METHODS = [\"eth_sendTransaction\", \"eth_signTypedData\", \"eth_signTypedData_v3\", \"eth_signTypedData_v4\", \"personal_sign\", \"eth_getEncryptionPublicKey\", \"eth_decrypt\", \"wallet_addEthereumChain\", \"wallet_switchEthereumChain\"];\n// preload for iframe doesn't work https://bugs.chromium.org/p/chromium/issues/detail?id=593267\n(async function preLoadIframe() {\n  try {\n    if (typeof document === \"undefined\") return;\n    const torusIframeHtml = document.createElement(\"link\");\n    const {\n      torusUrl\n    } = await getTorusUrl(\"production\", {\n      check: false,\n      hash: iframeIntegrity,\n      version: \"\"\n    });\n    torusIframeHtml.href = `${torusUrl}/popup`;\n    torusIframeHtml.crossOrigin = \"anonymous\";\n    torusIframeHtml.type = \"text/html\";\n    torusIframeHtml.rel = \"prefetch\";\n    if (torusIframeHtml.relList && torusIframeHtml.relList.supports) {\n      if (torusIframeHtml.relList.supports(\"prefetch\")) {\n        document.head.appendChild(torusIframeHtml);\n      }\n    }\n  } catch (error) {\n    log.warn(error);\n  }\n})();\nclass Torus {\n  constructor() {\n    let {\n      buttonPosition = BUTTON_POSITION.BOTTOM_LEFT,\n      buttonSize = 56,\n      modalZIndex = 99999,\n      apiKey = \"torus-default\"\n    } = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    _defineProperty(this, \"buttonPosition\", BUTTON_POSITION.BOTTOM_LEFT);\n    _defineProperty(this, \"buttonSize\", void 0);\n    _defineProperty(this, \"torusUrl\", void 0);\n    _defineProperty(this, \"torusIframe\", void 0);\n    _defineProperty(this, \"styleLink\", void 0);\n    _defineProperty(this, \"isLoggedIn\", void 0);\n    _defineProperty(this, \"isInitialized\", void 0);\n    _defineProperty(this, \"torusWidgetVisibility\", void 0);\n    _defineProperty(this, \"torusAlert\", void 0);\n    _defineProperty(this, \"apiKey\", void 0);\n    _defineProperty(this, \"modalZIndex\", void 0);\n    _defineProperty(this, \"alertZIndex\", void 0);\n    _defineProperty(this, \"torusAlertContainer\", void 0);\n    _defineProperty(this, \"isIframeFullScreen\", void 0);\n    _defineProperty(this, \"whiteLabel\", void 0);\n    _defineProperty(this, \"requestedVerifier\", void 0);\n    _defineProperty(this, \"currentVerifier\", void 0);\n    _defineProperty(this, \"embedTranslations\", void 0);\n    _defineProperty(this, \"ethereum\", void 0);\n    _defineProperty(this, \"provider\", void 0);\n    _defineProperty(this, \"communicationMux\", void 0);\n    _defineProperty(this, \"isLoginCallback\", void 0);\n    _defineProperty(this, \"paymentProviders\", configuration.paymentProviders);\n    _defineProperty(this, \"loginHint\", \"\");\n    _defineProperty(this, \"useWalletConnect\", void 0);\n    _defineProperty(this, \"isCustomLogin\", false);\n    this.buttonPosition = buttonPosition;\n    this.buttonSize = buttonSize;\n    this.torusUrl = \"\";\n    this.isLoggedIn = false; // ethereum.enable working\n    this.isInitialized = false; // init done\n    this.torusWidgetVisibility = true;\n    this.requestedVerifier = \"\";\n    this.currentVerifier = \"\";\n    // this.nodeDetailManager = new NodeDetailManager();\n    // this.torusJs = new TorusJs({\n    //   metadataHost: \"https://metadata.tor.us\",\n    //   allowHost: \"https://signer.tor.us/api/allow\",\n    //   network: \"mainnet\",\n    // });\n    this.apiKey = apiKey;\n    setAPIKey(apiKey);\n    this.modalZIndex = modalZIndex;\n    this.alertZIndex = modalZIndex + 1000;\n    this.isIframeFullScreen = false;\n  }\n  async init() {\n    let {\n      buildEnv = TORUS_BUILD_ENV.PRODUCTION,\n      enableLogging = false,\n      // deprecated: use loginConfig instead\n      enabledVerifiers = defaultVerifiers,\n      network = {\n        host: \"mainnet\",\n        chainId: null,\n        networkName: \"\",\n        blockExplorer: \"\",\n        ticker: \"\",\n        tickerName: \"\"\n      },\n      loginConfig = {},\n      showTorusButton = true,\n      integrity = {\n        check: false,\n        hash: iframeIntegrity,\n        version: \"\"\n      },\n      whiteLabel,\n      skipTKey = false,\n      useWalletConnect = false,\n      mfaLevel = \"default\"\n    } = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    if (this.isInitialized) throw new Error(\"Already initialized\");\n    const {\n      torusUrl,\n      logLevel\n    } = await getTorusUrl(buildEnv, integrity);\n    log.info(torusUrl, \"url loaded\");\n    this.torusUrl = torusUrl;\n    this.whiteLabel = whiteLabel;\n    this.useWalletConnect = useWalletConnect;\n    this.isCustomLogin = !!(loginConfig && Object.keys(loginConfig).length > 0) || !!(whiteLabel && Object.keys(whiteLabel).length > 0);\n    log.setDefaultLevel(logLevel);\n    if (enableLogging) log.enableAll();else log.disableAll();\n    this.torusWidgetVisibility = showTorusButton;\n    const torusIframeUrl = new URL(torusUrl);\n    if (torusIframeUrl.pathname.endsWith(\"/\")) torusIframeUrl.pathname += \"popup\";else torusIframeUrl.pathname += \"/popup\";\n    torusIframeUrl.hash = `#isCustomLogin=${this.isCustomLogin}`;\n    // Iframe code\n    this.torusIframe = htmlToElement(`<iframe\n        id=\"torusIframe\"\n        allow=${useWalletConnect ? \"camera\" : \"\"}\n        class=\"torusIframe\"\n        src=\"${torusIframeUrl.href}\"\n        style=\"display: none; position: fixed; top: 0; right: 0; width: 100%; color-scheme: none;\n        height: 100%; border: none; border-radius: 0; z-index: ${this.modalZIndex}\"\n      ></iframe>`);\n    this.torusAlertContainer = htmlToElement('<div id=\"torusAlertContainer\"></div>');\n    this.torusAlertContainer.style.display = \"none\";\n    this.torusAlertContainer.style.setProperty(\"z-index\", this.alertZIndex.toString());\n    const link = window.document.createElement(\"link\");\n    link.setAttribute(\"rel\", \"stylesheet\");\n    link.setAttribute(\"type\", \"text/css\");\n    link.setAttribute(\"href\", `${torusUrl}/css/widget.css`);\n    this.styleLink = link;\n    const {\n      defaultLanguage = getUserLanguage(),\n      customTranslations = {}\n    } = this.whiteLabel || {};\n    const mergedTranslations = deepmerge(configuration.translations, customTranslations);\n    const languageTranslations = mergedTranslations[defaultLanguage] || configuration.translations[getUserLanguage()];\n    this.embedTranslations = languageTranslations.embed;\n    const handleSetup = async () => {\n      await documentReady();\n      return new Promise((resolve, reject) => {\n        this.torusIframe.onload = async () => {\n          // only do this if iframe is not full screen\n          this._setupWeb3();\n          const initStream = this.communicationMux.getStream(\"init_stream\");\n          initStream.on(\"data\", chunk => {\n            const {\n              name,\n              data,\n              error\n            } = chunk;\n            if (name === \"init_complete\" && data.success) {\n              // resolve promise\n              this.isInitialized = true;\n              this._displayIframe(this.isIframeFullScreen);\n              resolve(undefined);\n            } else if (error) {\n              reject(new Error(error));\n            }\n          });\n          initStream.write({\n            name: \"init_stream\",\n            data: {\n              enabledVerifiers,\n              loginConfig,\n              whiteLabel: this.whiteLabel,\n              buttonPosition: this.buttonPosition,\n              buttonSize: this.buttonSize,\n              torusWidgetVisibility: this.torusWidgetVisibility,\n              apiKey: this.apiKey,\n              skipTKey,\n              network,\n              mfaLevel\n            }\n          });\n        };\n        window.document.head.appendChild(this.styleLink);\n        window.document.body.appendChild(this.torusIframe);\n        window.document.body.appendChild(this.torusAlertContainer);\n      });\n    };\n    if (buildEnv === \"production\" && integrity.check) {\n      // hacky solution to check for iframe integrity\n      const fetchUrl = `${torusUrl}/popup`;\n      const resp = await fetch(fetchUrl, {\n        cache: \"reload\"\n      });\n      if (resp.headers.get(\"Cache-Control\") !== expectedCacheControlHeader) {\n        throw new Error(`Unexpected Cache-Control headers, got ${resp.headers.get(\"Cache-Control\")}`);\n      }\n      const response = await resp.text();\n      const calculatedIntegrity = main({\n        algorithms: [\"sha384\"]\n      }, response);\n      log.info(calculatedIntegrity, \"integrity\");\n      if (calculatedIntegrity === integrity.hash) {\n        await handleSetup();\n      } else {\n        this.clearInit();\n        throw new Error(\"Integrity check failed\");\n      }\n    } else {\n      await handleSetup();\n    }\n    return undefined;\n  }\n  login() {\n    let {\n      verifier = \"\",\n      login_hint: loginHint = \"\"\n    } = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    if (!this.isInitialized) throw new Error(\"Call init() first\");\n    this.requestedVerifier = verifier;\n    this.loginHint = loginHint;\n    return this.ethereum.enable();\n  }\n  logout() {\n    return new Promise((resolve, reject) => {\n      if (!this.isLoggedIn) {\n        reject(new Error(\"User has not logged in yet\"));\n        return;\n      }\n      const logOutStream = this.communicationMux.getStream(\"logout\");\n      logOutStream.write({\n        name: \"logOut\"\n      });\n      const statusStream = this.communicationMux.getStream(\"status\");\n      const statusStreamHandler = status => {\n        if (!status.loggedIn) {\n          this.isLoggedIn = false;\n          this.currentVerifier = \"\";\n          this.requestedVerifier = \"\";\n          resolve();\n        } else reject(new Error(\"Some Error Occured\"));\n      };\n      handleStream(statusStream, \"data\", statusStreamHandler);\n    });\n  }\n  async cleanUp() {\n    if (this.isLoggedIn) {\n      await this.logout();\n    }\n    this.clearInit();\n  }\n  clearInit() {\n    function isElement(element) {\n      return element instanceof Element || element instanceof HTMLDocument;\n    }\n    if (isElement(this.styleLink) && window.document.body.contains(this.styleLink)) {\n      this.styleLink.remove();\n      this.styleLink = undefined;\n    }\n    if (isElement(this.torusIframe) && window.document.body.contains(this.torusIframe)) {\n      this.torusIframe.remove();\n      this.torusIframe = undefined;\n    }\n    if (isElement(this.torusAlertContainer) && window.document.body.contains(this.torusAlertContainer)) {\n      this.torusAlert = undefined;\n      this.torusAlertContainer.remove();\n      this.torusAlertContainer = undefined;\n    }\n    this.isInitialized = false;\n  }\n  hideTorusButton() {\n    this.torusWidgetVisibility = false;\n    this._sendWidgetVisibilityStatus(false);\n    this._displayIframe();\n  }\n  showTorusButton() {\n    this.torusWidgetVisibility = true;\n    this._sendWidgetVisibilityStatus(true);\n    this._displayIframe();\n  }\n  setProvider(_ref) {\n    let {\n        host = \"mainnet\",\n        chainId = null,\n        networkName = \"\"\n      } = _ref,\n      rest = _objectWithoutProperties(_ref, _excluded);\n    return new Promise((resolve, reject) => {\n      const providerChangeStream = this.communicationMux.getStream(\"provider_change\");\n      const handler = chunk => {\n        const {\n          err,\n          success\n        } = chunk.data;\n        log.info(chunk);\n        if (err) {\n          reject(err);\n        } else if (success) {\n          resolve();\n        } else reject(new Error(\"some error occured\"));\n      };\n      handleStream(providerChangeStream, \"data\", handler);\n      const preopenInstanceId = getPreopenInstanceId();\n      this._handleWindow(preopenInstanceId, {\n        target: \"_blank\",\n        features: FEATURES_PROVIDER_CHANGE_WINDOW\n      });\n      providerChangeStream.write({\n        name: \"show_provider_change\",\n        data: {\n          network: _objectSpread({\n            host,\n            chainId,\n            networkName\n          }, rest),\n          preopenInstanceId,\n          override: false\n        }\n      });\n    });\n  }\n  showWallet(path) {\n    let params = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    const showWalletStream = this.communicationMux.getStream(\"show_wallet\");\n    const finalPath = path ? `/${path}` : \"\";\n    showWalletStream.write({\n      name: \"show_wallet\",\n      data: {\n        path: finalPath\n      }\n    });\n    const showWalletHandler = chunk => {\n      if (chunk.name === \"show_wallet_instance\") {\n        // Let the error propogate up (hence, no try catch)\n        const {\n          instanceId\n        } = chunk.data;\n        const finalUrl = new URL(`${this.torusUrl}/wallet${finalPath}`);\n        // Using URL constructor to prevent js injection and allow parameter validation.!\n        finalUrl.searchParams.append(\"integrity\", \"true\");\n        finalUrl.searchParams.append(\"instanceId\", instanceId);\n        Object.keys(params).forEach(x => {\n          finalUrl.searchParams.append(x, params[x]);\n        });\n        finalUrl.hash = `#isCustomLogin=${this.isCustomLogin}`;\n        const walletWindow = new PopupHandler({\n          url: finalUrl,\n          features: FEATURES_DEFAULT_WALLET_WINDOW\n        });\n        walletWindow.open();\n      }\n    };\n    handleStream(showWalletStream, \"data\", showWalletHandler);\n  }\n  async getPublicAddress(_ref2) {\n    let {\n      verifier,\n      verifierId,\n      isExtended = false\n    } = _ref2;\n    if (!configuration.supportedVerifierList.includes(verifier) || !WALLET_OPENLOGIN_VERIFIER_MAP[verifier]) throw new Error(\"Unsupported verifier\");\n    const walletVerifier = verifier;\n    const openloginVerifier = WALLET_OPENLOGIN_VERIFIER_MAP[verifier];\n    const url = new URL(`https://api.tor.us/lookup/torus`);\n    url.searchParams.append(\"verifier\", openloginVerifier);\n    url.searchParams.append(\"verifierId\", verifierId);\n    url.searchParams.append(\"walletVerifier\", walletVerifier);\n    url.searchParams.append(\"network\", \"mainnet\");\n    url.searchParams.append(\"isExtended\", isExtended.toString());\n    return get(url.href, {\n      headers: {\n        \"Content-Type\": \"application/json; charset=utf-8\"\n      }\n    }, {\n      useAPIKey: true\n    });\n  }\n  getUserInfo(message) {\n    return new Promise((resolve, reject) => {\n      if (this.isLoggedIn) {\n        const userInfoAccessStream = this.communicationMux.getStream(\"user_info_access\");\n        userInfoAccessStream.write({\n          name: \"user_info_access_request\"\n        });\n        const userInfoAccessHandler = chunk => {\n          const {\n            name,\n            data: {\n              approved,\n              payload,\n              rejected,\n              newRequest\n            }\n          } = chunk;\n          if (name === \"user_info_access_response\") {\n            if (approved) {\n              resolve(payload);\n            } else if (rejected) {\n              reject(new Error(\"User rejected the request\"));\n            } else if (newRequest) {\n              const userInfoStream = this.communicationMux.getStream(\"user_info\");\n              const userInfoHandler = handlerChunk => {\n                if (handlerChunk.name === \"user_info_response\") {\n                  if (handlerChunk.data.approved) {\n                    resolve(handlerChunk.data.payload);\n                  } else {\n                    reject(new Error(\"User rejected the request\"));\n                  }\n                }\n              };\n              handleStream(userInfoStream, \"data\", userInfoHandler);\n              const preopenInstanceId = getPreopenInstanceId();\n              this._handleWindow(preopenInstanceId, {\n                target: \"_blank\",\n                features: FEATURES_PROVIDER_CHANGE_WINDOW\n              });\n              userInfoStream.write({\n                name: \"user_info_request\",\n                data: {\n                  message,\n                  preopenInstanceId\n                }\n              });\n            }\n          }\n        };\n        handleStream(userInfoAccessStream, \"data\", userInfoAccessHandler);\n      } else reject(new Error(\"User has not logged in yet\"));\n    });\n  }\n  initiateTopup(provider, params) {\n    return new Promise((resolve, reject) => {\n      if (this.isInitialized) {\n        const {\n          errors,\n          isValid\n        } = validatePaymentProvider(provider, params);\n        if (!isValid) {\n          reject(new Error(JSON.stringify(errors)));\n          return;\n        }\n        const topupStream = this.communicationMux.getStream(\"topup\");\n        const topupHandler = chunk => {\n          if (chunk.name === \"topup_response\") {\n            if (chunk.data.success) {\n              resolve(chunk.data.success);\n            } else {\n              reject(new Error(chunk.data.error));\n            }\n          }\n        };\n        handleStream(topupStream, \"data\", topupHandler);\n        const preopenInstanceId = getPreopenInstanceId();\n        this._handleWindow(preopenInstanceId);\n        topupStream.write({\n          name: \"topup_request\",\n          data: {\n            provider,\n            params,\n            preopenInstanceId\n          }\n        });\n      } else reject(new Error(\"Torus is not initialized yet\"));\n    });\n  }\n  async loginWithPrivateKey(loginParams) {\n    const {\n      privateKey,\n      userInfo\n    } = loginParams;\n    return new Promise((resolve, reject) => {\n      if (this.isInitialized) {\n        if (Buffer.from(privateKey, \"hex\").length !== 32) {\n          reject(new Error(\"Invalid private key, Please provide a 32 byte valid secp25k1 private key\"));\n          return;\n        }\n        const loginPrivKeyStream = this.communicationMux.getStream(\"login_with_private_key\");\n        const loginHandler = chunk => {\n          if (chunk.name === \"login_with_private_key_response\") {\n            if (chunk.data.success) {\n              resolve(chunk.data.success);\n            } else {\n              reject(new Error(chunk.data.error));\n            }\n          }\n        };\n        handleStream(loginPrivKeyStream, \"data\", loginHandler);\n        loginPrivKeyStream.write({\n          name: \"login_with_private_key_request\",\n          data: {\n            privateKey,\n            userInfo\n          }\n        });\n      } else reject(new Error(\"Torus is not initialized yet\"));\n    });\n  }\n  async showWalletConnectScanner() {\n    if (!this.useWalletConnect) throw new Error(\"Set `useWalletConnect` as true in init function options to use wallet connect scanner\");\n    return new Promise((resolve, reject) => {\n      if (this.isLoggedIn) {\n        const walletConnectStream = this.communicationMux.getStream(\"wallet_connect_stream\");\n        const walletConnectHandler = chunk => {\n          if (chunk.name === \"wallet_connect_stream_res\") {\n            if (chunk.data.success) {\n              resolve(chunk.data.success);\n            } else {\n              reject(new Error(chunk.data.error));\n            }\n            this._displayIframe();\n          }\n        };\n        handleStream(walletConnectStream, \"data\", walletConnectHandler);\n        walletConnectStream.write({\n          name: \"wallet_connect_stream_req\"\n        });\n        this._displayIframe(true);\n      } else reject(new Error(\"User has not logged in yet\"));\n    });\n  }\n  _handleWindow(preopenInstanceId) {\n    let {\n      url,\n      target,\n      features\n    } = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    if (preopenInstanceId) {\n      const windowStream = this.communicationMux.getStream(\"window\");\n      const finalUrl = new URL(url || `${this.torusUrl}/redirect?preopenInstanceId=${preopenInstanceId}`);\n      if (finalUrl.hash) finalUrl.hash += `&isCustomLogin=${this.isCustomLogin}`;else finalUrl.hash = `#isCustomLogin=${this.isCustomLogin}`;\n      const handledWindow = new PopupHandler({\n        url: finalUrl,\n        target,\n        features\n      });\n      handledWindow.open();\n      if (!handledWindow.window) {\n        this._createPopupBlockAlert(preopenInstanceId, finalUrl.href);\n        return;\n      }\n      windowStream.write({\n        name: \"opened_window\",\n        data: {\n          preopenInstanceId\n        }\n      });\n      const closeHandler = _ref3 => {\n        let {\n          preopenInstanceId: receivedId,\n          close\n        } = _ref3;\n        if (receivedId === preopenInstanceId && close) {\n          handledWindow.close();\n          windowStream.removeListener(\"data\", closeHandler);\n        }\n      };\n      windowStream.on(\"data\", closeHandler);\n      handledWindow.once(\"close\", () => {\n        windowStream.write({\n          data: {\n            preopenInstanceId,\n            closed: true\n          }\n        });\n        windowStream.removeListener(\"data\", closeHandler);\n      });\n    }\n  }\n  _setEmbedWhiteLabel(element) {\n    // Set whitelabel\n    const {\n      theme\n    } = this.whiteLabel || {};\n    if (theme) {\n      const {\n        isDark = false,\n        colors = {}\n      } = theme;\n      if (isDark) element.classList.add(\"torus-dark\");\n      if (colors.torusBrand1) element.style.setProperty(\"--torus-brand-1\", colors.torusBrand1);\n      if (colors.torusGray2) element.style.setProperty(\"--torus-gray-2\", colors.torusGray2);\n    }\n  }\n  _getLogoUrl() {\n    let logoUrl = `${this.torusUrl}/images/torus_icon-blue.svg`;\n    if (this.whiteLabel?.theme?.isDark) {\n      logoUrl = this.whiteLabel?.logoLight || logoUrl;\n    } else {\n      logoUrl = this.whiteLabel?.logoDark || logoUrl;\n    }\n    return logoUrl;\n  }\n  _sendWidgetVisibilityStatus(status) {\n    const torusWidgetVisibilityStream = this.communicationMux.getStream(\"torus-widget-visibility\");\n    torusWidgetVisibilityStream.write({\n      data: status\n    });\n  }\n  _displayIframe() {\n    let isFull = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n    const style = {};\n    const size = this.buttonSize + 14; // 15px padding\n    // set phase\n    if (!isFull) {\n      style.display = this.torusWidgetVisibility ? \"block\" : \"none\";\n      style.height = `${size}px`;\n      style.width = `${size}px`;\n      switch (this.buttonPosition) {\n        case BUTTON_POSITION.TOP_LEFT:\n          style.top = \"0px\";\n          style.left = \"0px\";\n          style.right = \"auto\";\n          style.bottom = \"auto\";\n          break;\n        case BUTTON_POSITION.TOP_RIGHT:\n          style.top = \"0px\";\n          style.right = \"0px\";\n          style.left = \"auto\";\n          style.bottom = \"auto\";\n          break;\n        case BUTTON_POSITION.BOTTOM_RIGHT:\n          style.bottom = \"0px\";\n          style.right = \"0px\";\n          style.top = \"auto\";\n          style.left = \"auto\";\n          break;\n        case BUTTON_POSITION.BOTTOM_LEFT:\n        default:\n          style.bottom = \"0px\";\n          style.left = \"0px\";\n          style.top = \"auto\";\n          style.right = \"auto\";\n          break;\n      }\n    } else {\n      style.display = \"block\";\n      style.width = \"100%\";\n      style.height = \"100%\";\n      style.top = \"0px\";\n      style.right = \"0px\";\n      style.left = \"0px\";\n      style.bottom = \"0px\";\n    }\n    Object.assign(this.torusIframe.style, style);\n    this.isIframeFullScreen = isFull;\n  }\n  _setupWeb3() {\n    log.info(\"setupWeb3 running\");\n    // setup background connection\n    const metamaskStream = new BasePostMessageStream({\n      name: \"embed_metamask\",\n      target: \"iframe_metamask\",\n      targetWindow: this.torusIframe.contentWindow,\n      targetOrigin: new URL(this.torusUrl).origin\n    });\n    // Due to compatibility reasons, we should not set up multiplexing on window.metamaskstream\n    // because the MetamaskInpageProvider also attempts to do so.\n    // We create another LocalMessageDuplexStream for communication between dapp <> iframe\n    const communicationStream = new BasePostMessageStream({\n      name: \"embed_comm\",\n      target: \"iframe_comm\",\n      targetWindow: this.torusIframe.contentWindow,\n      targetOrigin: new URL(this.torusUrl).origin\n    });\n    // Backward compatibility with Gotchi :)\n    // window.metamaskStream = this.communicationStream\n    // compose the inpage provider\n    const inpageProvider = new TorusInpageProvider(metamaskStream);\n    // detect eth_requestAccounts and pipe to enable for now\n    const detectAccountRequestPrototypeModifier = m => {\n      const originalMethod = inpageProvider[m];\n      inpageProvider[m] = function providerFunc(method) {\n        if (method && method === \"eth_requestAccounts\") {\n          return inpageProvider.enable();\n        }\n        for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n          args[_key - 1] = arguments[_key];\n        }\n        return originalMethod.apply(this, [method, ...args]);\n      };\n    };\n    detectAccountRequestPrototypeModifier(\"send\");\n    detectAccountRequestPrototypeModifier(\"sendAsync\");\n    inpageProvider.enable = () => {\n      return new Promise((resolve, reject) => {\n        // If user is already logged in, we assume they have given access to the website\n        inpageProvider.sendAsync({\n          jsonrpc: \"2.0\",\n          id: getPreopenInstanceId(),\n          method: \"eth_requestAccounts\",\n          params: []\n        }, (err, response) => {\n          const {\n            result: res\n          } = response || {};\n          if (err) {\n            setTimeout(() => {\n              reject(err);\n            }, 50);\n          } else if (Array.isArray(res) && res.length > 0) {\n            // If user is already rehydrated, resolve this\n            // else wait for something to be written to status stream\n            const handleLoginCb = () => {\n              if (this.requestedVerifier !== \"\" && this.currentVerifier !== this.requestedVerifier) {\n                const {\n                  requestedVerifier\n                } = this;\n                // eslint-disable-next-line promise/no-promise-in-callback\n                this.logout()\n                // eslint-disable-next-line promise/always-return\n                .then(_ => {\n                  this.requestedVerifier = requestedVerifier;\n                  this._showLoginPopup(true, resolve, reject);\n                }).catch(error => reject(error));\n              } else {\n                resolve(res);\n              }\n            };\n            if (this.isLoggedIn) {\n              handleLoginCb();\n            } else {\n              this.isLoginCallback = handleLoginCb;\n            }\n          } else {\n            // set up listener for login\n            this._showLoginPopup(true, resolve, reject);\n          }\n        });\n      });\n    };\n    inpageProvider.tryPreopenHandle = (payload, cb) => {\n      const _payload = payload;\n      if (!Array.isArray(_payload) && UNSAFE_METHODS.includes(_payload.method)) {\n        const preopenInstanceId = getPreopenInstanceId();\n        this._handleWindow(preopenInstanceId, {\n          target: \"_blank\",\n          features: FEATURES_CONFIRM_WINDOW\n        });\n        _payload.preopenInstanceId = preopenInstanceId;\n      }\n      inpageProvider._rpcEngine.handle(_payload, cb);\n    };\n    // Work around for web3@1.0 deleting the bound `sendAsync` but not the unbound\n    // `sendAsync` method on the prototype, causing `this` reference issues with drizzle\n    const proxiedInpageProvider = new Proxy(inpageProvider, {\n      // straight up lie that we deleted the property so that it doesnt\n      // throw an error in strict mode\n      deleteProperty: () => true\n    });\n    this.ethereum = proxiedInpageProvider;\n    const communicationMux = setupMultiplex(communicationStream);\n    this.communicationMux = communicationMux;\n    const windowStream = communicationMux.getStream(\"window\");\n    windowStream.on(\"data\", chunk => {\n      if (chunk.name === \"create_window\") {\n        // url is the url we need to open\n        // we can pass the final url upfront so that it removes the step of redirecting to /redirect and waiting for finalUrl\n        this._createPopupBlockAlert(chunk.data.preopenInstanceId, chunk.data.url);\n      }\n    });\n    // show torus widget if button clicked\n    const widgetStream = communicationMux.getStream(\"widget\");\n    widgetStream.on(\"data\", chunk => {\n      const {\n        data\n      } = chunk;\n      this._displayIframe(data);\n    });\n    // Show torus button if wallet has been hydrated/detected\n    const statusStream = communicationMux.getStream(\"status\");\n    statusStream.on(\"data\", status => {\n      // login\n      if (status.loggedIn) {\n        this.isLoggedIn = status.loggedIn;\n        this.currentVerifier = status.verifier;\n      } // logout\n      else this._displayIframe();\n      if (this.isLoginCallback) {\n        this.isLoginCallback();\n        delete this.isLoginCallback;\n      }\n    });\n    this.provider = proxiedInpageProvider;\n    if (this.provider.shouldSendMetadata) sendSiteMetadata(this.provider._rpcEngine);\n    inpageProvider._initializeState();\n    log.debug(\"Torus - injected provider\");\n  }\n  _showLoginPopup(calledFromEmbed, resolve, reject) {\n    const loginHandler = data => {\n      const {\n        err,\n        selectedAddress\n      } = data;\n      if (err) {\n        log.error(err);\n        if (reject) reject(err);\n      }\n      // returns an array (cause accounts expects it)\n      else if (resolve) resolve([selectedAddress]);\n      if (this.isIframeFullScreen) this._displayIframe();\n    };\n    const oauthStream = this.communicationMux.getStream(\"oauth\");\n    if (!this.requestedVerifier) {\n      this._displayIframe(true);\n      handleStream(oauthStream, \"data\", loginHandler);\n      oauthStream.write({\n        name: \"oauth_modal\",\n        data: {\n          calledFromEmbed\n        }\n      });\n    } else {\n      handleStream(oauthStream, \"data\", loginHandler);\n      const preopenInstanceId = getPreopenInstanceId();\n      this._handleWindow(preopenInstanceId);\n      oauthStream.write({\n        name: \"oauth\",\n        data: {\n          calledFromEmbed,\n          verifier: this.requestedVerifier,\n          preopenInstanceId,\n          login_hint: this.loginHint\n        }\n      });\n    }\n  }\n  _createPopupBlockAlert(preopenInstanceId, url) {\n    const logoUrl = this._getLogoUrl();\n    const torusAlert = htmlToElement('<div id=\"torusAlert\" class=\"torus-alert--v2\">' + `<div id=\"torusAlert__logo\"><img src=\"${logoUrl}\" /></div>` + \"<div>\" + `<h1 id=\"torusAlert__title\">${this.embedTranslations.actionRequired}</h1>` + `<p id=\"torusAlert__desc\">${this.embedTranslations.pendingAction}</p>` + \"</div>\" + \"</div>\");\n    const successAlert = htmlToElement(`<div><a id=\"torusAlert__btn\">${this.embedTranslations.continue}</a></div>`);\n    const btnContainer = htmlToElement('<div id=\"torusAlert__btn-container\"></div>');\n    btnContainer.appendChild(successAlert);\n    torusAlert.appendChild(btnContainer);\n    const bindOnLoad = () => {\n      successAlert.addEventListener(\"click\", () => {\n        this._handleWindow(preopenInstanceId, {\n          url,\n          target: \"_blank\",\n          features: FEATURES_CONFIRM_WINDOW\n        });\n        torusAlert.remove();\n        if (this.torusAlertContainer.children.length === 0) this.torusAlertContainer.style.display = \"none\";\n      });\n    };\n    this._setEmbedWhiteLabel(torusAlert);\n    const attachOnLoad = () => {\n      this.torusAlertContainer.style.display = \"block\";\n      this.torusAlertContainer.appendChild(torusAlert);\n    };\n    runOnLoad(attachOnLoad);\n    runOnLoad(bindOnLoad);\n  }\n}\n\nexport { BUTTON_POSITION, LOGIN_PROVIDER, PAYMENT_PROVIDER, SUPPORTED_PAYMENT_NETWORK, TORUS_BUILD_ENV, TorusInpageProvider, WALLET_OPENLOGIN_VERIFIER_MAP, WALLET_VERIFIERS, Torus as default };\n//# sourceMappingURL=torus.esm.js.map\n",null,null,null,null,null,null,null,null,null,null,null,"import _defineProperty from '@babel/runtime/helpers/defineProperty';\nimport { Duplex } from 'readable-stream';\nimport { randomId } from '@toruslabs/openlogin-utils';\nimport { EventEmitter } from 'events';\nimport stringify from 'fast-safe-stringify';\nimport { serializeError } from 'eth-rpc-errors';\nimport eos from 'end-of-stream';\nimport once from 'once';\nimport pump from 'pump';\n\nfunction noop() {\n  return undefined;\n}\nconst SYN = \"SYN\";\nconst ACK = \"ACK\";\nconst BRK = \"BRK\";\nclass BasePostMessageStream extends Duplex {\n  constructor(_ref) {\n    let {\n      name,\n      target,\n      targetWindow = window,\n      targetOrigin = \"*\"\n    } = _ref;\n    super({\n      objectMode: true\n    });\n    _defineProperty(this, \"_init\", void 0);\n    _defineProperty(this, \"_haveSyn\", void 0);\n    _defineProperty(this, \"_name\", void 0);\n    _defineProperty(this, \"_target\", void 0);\n    _defineProperty(this, \"_targetWindow\", void 0);\n    _defineProperty(this, \"_targetOrigin\", void 0);\n    _defineProperty(this, \"_onMessage\", void 0);\n    _defineProperty(this, \"_synIntervalId\", void 0);\n    if (!name || !target) {\n      throw new Error(\"Invalid input.\");\n    }\n    this._init = false;\n    this._haveSyn = false;\n    this._name = name;\n    this._target = target; // target origin\n    this._targetWindow = targetWindow;\n    this._targetOrigin = targetOrigin;\n    this._onMessage = this.onMessage.bind(this);\n    this._synIntervalId = null;\n    window.addEventListener(\"message\", this._onMessage, false);\n    this._handShake();\n  }\n  _break() {\n    this.cork();\n    this._write(BRK, null, noop);\n    this._haveSyn = false;\n    this._init = false;\n  }\n  _handShake() {\n    this._write(SYN, null, noop);\n    this.cork();\n  }\n  _onData(data) {\n    if (!this._init) {\n      // listen for handshake\n      if (data === SYN) {\n        this._haveSyn = true;\n        this._write(ACK, null, noop);\n      } else if (data === ACK) {\n        this._init = true;\n        if (!this._haveSyn) {\n          this._write(ACK, null, noop);\n        }\n        this.uncork();\n      }\n    } else if (data === BRK) {\n      this._break();\n    } else {\n      // forward message\n      try {\n        this.push(data);\n      } catch (err) {\n        this.emit(\"error\", err);\n      }\n    }\n  }\n  _postMessage(data) {\n    const originConstraint = this._targetOrigin;\n    this._targetWindow.postMessage({\n      target: this._target,\n      data\n    }, originConstraint);\n  }\n  onMessage(event) {\n    const message = event.data;\n    // validate message\n    if (this._targetOrigin !== \"*\" && event.origin !== this._targetOrigin || event.source !== this._targetWindow || typeof message !== \"object\" || message.target !== this._name || !message.data) {\n      return;\n    }\n    this._onData(message.data);\n  }\n  _read() {\n    return undefined;\n  }\n  _write(data, _, cb) {\n    this._postMessage(data);\n    cb();\n  }\n  _destroy() {\n    window.removeEventListener(\"message\", this._onMessage, false);\n  }\n}\n\nfunction safeApply(handler, context, args) {\n  try {\n    Reflect.apply(handler, context, args);\n  } catch (err) {\n    // Throw error after timeout so as not to interrupt the stack\n    setTimeout(() => {\n      throw err;\n    });\n  }\n}\nfunction arrayClone(arr) {\n  const n = arr.length;\n  const copy = new Array(n);\n  for (let i = 0; i < n; i += 1) {\n    copy[i] = arr[i];\n  }\n  return copy;\n}\nclass SafeEventEmitter extends EventEmitter {\n  emit(type) {\n    let doError = type === \"error\";\n    const events = this._events;\n    if (events !== undefined) {\n      doError = doError && events.error === undefined;\n    } else if (!doError) {\n      return false;\n    }\n    // If there is no 'error' event listener then throw.\n    for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n      args[_key - 1] = arguments[_key];\n    }\n    if (doError) {\n      let er;\n      if (args.length > 0) {\n        [er] = args;\n      }\n      if (er instanceof Error) {\n        // Note: The comments on the `throw` lines are intentional, they show\n        // up in Node's output if this results in an unhandled exception.\n        throw er; // Unhandled 'error' event\n      }\n      // At least give some kind of context to the user\n      const err = new Error(`Unhandled error.${er ? ` (${er.message})` : \"\"}`);\n      err.context = er;\n      throw err; // Unhandled 'error' event\n    }\n\n    const handler = events[type];\n    if (handler === undefined) {\n      return false;\n    }\n    if (typeof handler === \"function\") {\n      safeApply(handler, this, args);\n    } else {\n      const len = handler.length;\n      const listeners = arrayClone(handler);\n      for (let i = 0; i < len; i += 1) {\n        safeApply(listeners[i], this, args);\n      }\n    }\n    return true;\n  }\n}\n\nclass SerializableError extends Error {\n  constructor(_ref) {\n    let {\n      code,\n      message,\n      data\n    } = _ref;\n    if (!Number.isInteger(code)) {\n      throw new Error(\"code must be an integer\");\n    }\n    if (!message || typeof message !== \"string\") {\n      throw new Error(\"message must be string\");\n    }\n    super(message);\n    _defineProperty(this, \"code\", void 0);\n    _defineProperty(this, \"data\", void 0);\n    this.code = code;\n    if (data !== undefined) {\n      this.data = data;\n    }\n  }\n  toString() {\n    return stringify({\n      code: this.code,\n      message: this.message,\n      data: this.data,\n      stack: this.stack\n    });\n  }\n}\n\nconst getRpcPromiseCallback = function (resolve, reject) {\n  let unwrapResult = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;\n  return (error, response) => {\n    if (error || response.error) {\n      reject(error || response.error);\n    } else if (!unwrapResult || Array.isArray(response)) {\n      resolve(response);\n    } else {\n      resolve(response.result);\n    }\n  };\n};\nfunction createErrorMiddleware(log) {\n  return (req, res, next, end) => {\n    try {\n      // json-rpc-engine will terminate the request when it notices this error\n      if (typeof req.method !== \"string\" || !req.method) {\n        res.error = new SerializableError({\n          code: -32603,\n          message: \"invalid method\"\n        });\n        end();\n        return;\n      }\n      next(done => {\n        const {\n          error\n        } = res;\n        if (!error) {\n          return done();\n        }\n        log.error(`OpenLogin - RPC Error: ${error.message}`, error);\n        return done();\n      });\n    } catch (error) {\n      log.error(`OpenLogin - RPC Error thrown: ${error.message}`, error);\n      res.error = new SerializableError({\n        code: -32603,\n        message: error.message\n      });\n      end();\n    }\n  };\n}\nfunction createStreamMiddleware() {\n  const idMap = {};\n  function readNoop() {\n    return false;\n  }\n  const events = new SafeEventEmitter();\n  function processResponse(res) {\n    const context = idMap[res.id];\n    if (!context) {\n      throw new Error(`StreamMiddleware - Unknown response id \"${res.id}\"`);\n    }\n    delete idMap[res.id];\n    // copy whole res onto original res\n    Object.assign(context.res, res);\n    // run callback on empty stack,\n    // prevent internal stream-handler from catching errors\n    setTimeout(context.end);\n  }\n  function processNotification(res) {\n    events.emit(\"notification\", res);\n  }\n  function processMessage(res, _encoding, cb) {\n    let err;\n    try {\n      const isNotification = !res.id;\n      if (isNotification) {\n        processNotification(res);\n      } else {\n        processResponse(res);\n      }\n    } catch (_err) {\n      err = _err;\n    }\n    // continue processing stream\n    cb(err);\n  }\n  const stream = new Duplex({\n    objectMode: true,\n    read: readNoop,\n    write: processMessage\n  });\n  const middleware = (req, res, next, end) => {\n    // write req to stream\n    stream.push(req);\n    // register request on id map\n    idMap[req.id] = {\n      req,\n      res,\n      next,\n      end\n    };\n  };\n  return {\n    events,\n    middleware,\n    stream\n  };\n}\nfunction createScaffoldMiddleware(handlers) {\n  return (req, res, next, end) => {\n    const handler = handlers[req.method];\n    // if no handler, return\n    if (handler === undefined) {\n      return next();\n    }\n    // if handler is fn, call as middleware\n    if (typeof handler === \"function\") {\n      return handler(req, res, next, end);\n    }\n    // if handler is some other value, use as result\n    res.result = handler;\n    return end();\n  };\n}\nfunction createIdRemapMiddleware() {\n  return (req, res, next, _end) => {\n    const originalId = req.id;\n    const newId = randomId();\n    req.id = newId;\n    res.id = newId;\n    next(done => {\n      req.id = originalId;\n      res.id = originalId;\n      done();\n    });\n  };\n}\nfunction createLoggerMiddleware(logger) {\n  return (req, res, next, _) => {\n    logger.debug(\"REQ\", req, \"RES\", res);\n    next();\n  };\n}\nfunction createAsyncMiddleware(asyncMiddleware) {\n  return async (req, res, next, end) => {\n    // nextPromise is the key to the implementation\n    // it is resolved by the return handler passed to the\n    // \"next\" function\n    let resolveNextPromise;\n    const nextPromise = new Promise(resolve => {\n      resolveNextPromise = resolve;\n    });\n    let returnHandlerCallback = null;\n    let nextWasCalled = false;\n    // This will be called by the consumer's async middleware.\n    const asyncNext = async () => {\n      nextWasCalled = true;\n      // We pass a return handler to next(). When it is called by the engine,\n      // the consumer's async middleware will resume executing.\n      next(runReturnHandlersCallback => {\n        // This callback comes from JRPCEngine._runReturnHandlers\n        returnHandlerCallback = runReturnHandlersCallback;\n        resolveNextPromise();\n      });\n      await nextPromise;\n    };\n    try {\n      await asyncMiddleware(req, res, asyncNext);\n      if (nextWasCalled) {\n        await nextPromise; // we must wait until the return handler is called\n        returnHandlerCallback(null);\n      } else {\n        end(null);\n      }\n    } catch (error) {\n      if (returnHandlerCallback) {\n        returnHandlerCallback(error);\n      } else {\n        end(error);\n      }\n    }\n  };\n}\n\nfunction ownKeys$1(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\nfunction _objectSpread$1(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys$1(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys$1(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\n/**\n * A JSON-RPC request and response processor.\n * Give it a stack of middleware, pass it requests, and get back responses.\n */\nclass JRPCEngine extends SafeEventEmitter {\n  constructor() {\n    super();\n    _defineProperty(this, \"_middleware\", void 0);\n    this._middleware = [];\n  }\n  /**\n   * Serially executes the given stack of middleware.\n   *\n   * @returns An array of any error encountered during middleware execution,\n   * a boolean indicating whether the request was completed, and an array of\n   * middleware-defined return handlers.\n   */\n  static async _runAllMiddleware(req, res, middlewareStack) {\n    const returnHandlers = [];\n    let error = null;\n    let isComplete = false;\n    // Go down stack of middleware, call and collect optional returnHandlers\n    for (const middleware of middlewareStack) {\n      [error, isComplete] = await JRPCEngine._runMiddleware(req, res, middleware, returnHandlers);\n      if (isComplete) {\n        break;\n      }\n    }\n    return [error, isComplete, returnHandlers.reverse()];\n  }\n  /**\n   * Runs an individual middleware.\n   *\n   * @returns An array of any error encountered during middleware exection,\n   * and a boolean indicating whether the request should end.\n   */\n  static _runMiddleware(req, res, middleware, returnHandlers) {\n    return new Promise(resolve => {\n      const end = err => {\n        const error = err || res.error;\n        if (error) {\n          res.error = serializeError(error);\n        }\n        // True indicates that the request should end\n        resolve([error, true]);\n      };\n      const next = returnHandler => {\n        if (res.error) {\n          end(res.error);\n        } else {\n          if (returnHandler) {\n            if (typeof returnHandler !== \"function\") {\n              end(new SerializableError({\n                code: -32603,\n                message: \"JRPCEngine: 'next' return handlers must be functions\"\n              }));\n            }\n            returnHandlers.push(returnHandler);\n          }\n          // False indicates that the request should not end\n          resolve([null, false]);\n        }\n      };\n      try {\n        middleware(req, res, next, end);\n      } catch (error) {\n        end(error);\n      }\n    });\n  }\n  /**\n   * Serially executes array of return handlers. The request and response are\n   * assumed to be in their scope.\n   */\n  static async _runReturnHandlers(handlers) {\n    for (const handler of handlers) {\n      await new Promise((resolve, reject) => {\n        handler(err => err ? reject(err) : resolve());\n      });\n    }\n  }\n  /**\n   * Throws an error if the response has neither a result nor an error, or if\n   * the \"isComplete\" flag is falsy.\n   */\n  static _checkForCompletion(req, res, isComplete) {\n    if (!(\"result\" in res) && !(\"error\" in res)) {\n      throw new SerializableError({\n        code: -32603,\n        message: \"Response has no error or result for request\"\n      });\n    }\n    if (!isComplete) {\n      throw new SerializableError({\n        code: -32603,\n        message: \"Nothing ended request\"\n      });\n    }\n  }\n  /**\n   * Add a middleware function to the engine's middleware stack.\n   *\n   * @param middleware - The middleware function to add.\n   */\n  push(middleware) {\n    this._middleware.push(middleware);\n  }\n  handle(req, cb) {\n    if (cb && typeof cb !== \"function\") {\n      throw new Error('\"callback\" must be a function if provided.');\n    }\n    if (Array.isArray(req)) {\n      if (cb) {\n        return this._handleBatch(req, cb);\n      }\n      return this._handleBatch(req);\n    }\n    if (cb) {\n      return this._handle(req, cb);\n    }\n    return this._promiseHandle(req);\n  }\n  /**\n   * Returns this engine as a middleware function that can be pushed to other\n   * engines.\n   *\n   * @returns This engine as a middleware function.\n   */\n  asMiddleware() {\n    return async (req, res, next, end) => {\n      try {\n        const [middlewareError, isComplete, returnHandlers] = await JRPCEngine._runAllMiddleware(req, res, this._middleware);\n        if (isComplete) {\n          await JRPCEngine._runReturnHandlers(returnHandlers);\n          return end(middlewareError);\n        }\n        return next(async handlerCallback => {\n          try {\n            await JRPCEngine._runReturnHandlers(returnHandlers);\n          } catch (error) {\n            return handlerCallback(error);\n          }\n          return handlerCallback();\n        });\n      } catch (error) {\n        return end(error);\n      }\n    };\n  }\n  async _handleBatch(reqs, cb) {\n    // The order here is important\n    try {\n      // 2. Wait for all requests to finish, or throw on some kind of fatal\n      // error\n      const responses = await Promise.all(\n      // 1. Begin executing each request in the order received\n      reqs.map(this._promiseHandle.bind(this)));\n      // 3. Return batch response\n      if (cb) {\n        return cb(null, responses);\n      }\n      return responses;\n    } catch (error) {\n      if (cb) {\n        return cb(error);\n      }\n      throw error;\n    }\n  }\n  /**\n   * A promise-wrapped _handle.\n   */\n  _promiseHandle(req) {\n    return new Promise(resolve => {\n      this._handle(req, (_err, res) => {\n        // There will always be a response, and it will always have any error\n        // that is caught and propagated.\n        resolve(res);\n      });\n    });\n  }\n  /**\n   * Ensures that the request object is valid, processes it, and passes any\n   * error and the response object to the given callback.\n   *\n   * Does not reject.\n   */\n  async _handle(callerReq, cb) {\n    if (!callerReq || Array.isArray(callerReq) || typeof callerReq !== \"object\") {\n      const error = new SerializableError({\n        code: -32603,\n        message: \"request must be plain object\"\n      });\n      return cb(error, {\n        id: undefined,\n        jsonrpc: \"2.0\",\n        error\n      });\n    }\n    if (typeof callerReq.method !== \"string\") {\n      const error = new SerializableError({\n        code: -32603,\n        message: \"method must be string\"\n      });\n      return cb(error, {\n        id: callerReq.id,\n        jsonrpc: \"2.0\",\n        error\n      });\n    }\n    const req = _objectSpread$1({}, callerReq);\n    const res = {\n      id: req.id,\n      jsonrpc: req.jsonrpc\n    };\n    let error = null;\n    try {\n      await this._processRequest(req, res);\n    } catch (_error) {\n      // A request handler error, a re-thrown middleware error, or something\n      // unexpected.\n      error = _error;\n    }\n    if (error) {\n      // Ensure no result is present on an errored response\n      delete res.result;\n      if (!res.error) {\n        res.error = serializeError(error);\n      }\n    }\n    return cb(error, res);\n  }\n  /**\n   * For the given request and response, runs all middleware and their return\n   * handlers, if any, and ensures that internal request processing semantics\n   * are satisfied.\n   */\n  async _processRequest(req, res) {\n    const [error, isComplete, returnHandlers] = await JRPCEngine._runAllMiddleware(req, res, this._middleware);\n    // Throw if \"end\" was not called, or if the response has neither a result\n    // nor an error.\n    JRPCEngine._checkForCompletion(req, res, isComplete);\n    // The return handlers should run even if an error was encountered during\n    // middleware processing.\n    await JRPCEngine._runReturnHandlers(returnHandlers);\n    // Now we re-throw the middleware processing error, if any, to catch it\n    // further up the call chain.\n    if (error) {\n      throw error;\n    }\n  }\n}\nfunction mergeMiddleware(middlewareStack) {\n  const engine = new JRPCEngine();\n  middlewareStack.forEach(middleware => engine.push(middleware));\n  return engine.asMiddleware();\n}\nfunction createEngineStream(opts) {\n  if (!opts || !opts.engine) {\n    throw new Error(\"Missing engine parameter!\");\n  }\n  const {\n    engine\n  } = opts;\n  // eslint-disable-next-line prefer-const\n  let stream;\n  function read() {\n    return undefined;\n  }\n  function write(req, _encoding, cb) {\n    engine.handle(req, (_err, res) => {\n      stream.push(res);\n    });\n    cb();\n  }\n  stream = new Duplex({\n    objectMode: true,\n    read,\n    write\n  });\n  // forward notifications\n  if (engine.on) {\n    engine.on(\"notification\", message => {\n      stream.push(message);\n    });\n  }\n  return stream;\n}\n\nclass Substream extends Duplex {\n  constructor(_ref) {\n    let {\n      parent,\n      name\n    } = _ref;\n    super({\n      objectMode: true\n    });\n    _defineProperty(this, \"_parent\", void 0);\n    _defineProperty(this, \"_name\", void 0);\n    this._parent = parent;\n    this._name = name;\n  }\n  /**\n   * Explicitly sets read operations to a no-op.\n   */\n  _read() {\n    return undefined;\n  }\n  /**\n   * Called when data should be written to this writable stream.\n   *\n   * @param chunk - Arbitrary object to write\n   * @param encoding - Encoding to use when writing payload\n   * @param callback - Called when writing is complete or an error occurs\n   */\n  _write(chunk, _encoding, callback) {\n    this._parent.push({\n      name: this._name,\n      data: chunk\n    });\n    callback();\n  }\n}\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\nconst IGNORE_SUBSTREAM = Symbol(\"IGNORE_SUBSTREAM\");\nclass ObjectMultiplex extends Duplex {\n  constructor() {\n    let opts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    super(_objectSpread(_objectSpread({}, opts), {}, {\n      objectMode: true\n    }));\n    _defineProperty(this, \"_substreams\", void 0);\n    _defineProperty(this, \"getStream\", void 0);\n    this._substreams = {};\n  }\n  createStream(name) {\n    // validate name\n    if (!name) {\n      throw new Error(\"ObjectMultiplex - name must not be empty\");\n    }\n    if (this._substreams[name]) {\n      throw new Error(`ObjectMultiplex - Substream for name \"${name}\" already exists`);\n    }\n    // create substream\n    const substream = new Substream({\n      parent: this,\n      name\n    });\n    this._substreams[name] = substream;\n    // listen for parent stream to end\n    // eslint-disable-next-line @typescript-eslint/no-use-before-define\n    anyStreamEnd(this, _error => substream.destroy(_error || undefined));\n    return substream;\n  }\n  // ignore streams (dont display orphaned data warning)\n  ignoreStream(name) {\n    // validate name\n    if (!name) {\n      throw new Error(\"ObjectMultiplex - name must not be empty\");\n    }\n    if (this._substreams[name]) {\n      throw new Error(`ObjectMultiplex - Substream for name \"${name}\" already exists`);\n    }\n    // set\n    this._substreams[name] = IGNORE_SUBSTREAM;\n  }\n  _read() {\n    return undefined;\n  }\n  _write(chunk, _encoding, callback) {\n    const {\n      name,\n      data\n    } = chunk;\n    if (!name) {\n      window.console.warn(`ObjectMultiplex - malformed chunk without name \"${chunk}\"`);\n      return callback();\n    }\n    // get corresponding substream\n    const substream = this._substreams[name];\n    if (!substream) {\n      window.console.warn(`ObjectMultiplex - orphaned data for stream \"${name}\"`);\n      return callback();\n    }\n    // push data into substream\n    if (substream !== IGNORE_SUBSTREAM) {\n      substream.push(data);\n    }\n    return callback();\n  }\n}\n// util\nfunction anyStreamEnd(stream, _cb) {\n  const cb = once(_cb);\n  eos(stream, {\n    readable: false\n  }, cb);\n  eos(stream, {\n    writable: false\n  }, cb);\n}\nfunction setupMultiplex(stream) {\n  const mux = new ObjectMultiplex();\n  mux.getStream = function streamHelper(name) {\n    if (this._substreams[name]) {\n      return this._substreams[name];\n    }\n    return this.createStream(name);\n  };\n  pump(stream, mux, stream, err => {\n    if (err) window.console.error(err);\n  });\n  return mux;\n}\n\nclass PostMessageStream extends BasePostMessageStream {\n  _postMessage(data) {\n    let originConstraint = this._targetOrigin;\n    if (typeof data === \"object\") {\n      const dataObj = data;\n      if (typeof dataObj.data === \"object\") {\n        const dataObjData = dataObj.data;\n        if (Array.isArray(dataObjData.params) && dataObjData.params.length > 0) {\n          const dataObjDataParam = dataObjData.params[0];\n          if (dataObjDataParam._origin) {\n            originConstraint = dataObjDataParam._origin;\n          }\n          // add a constraint for the response\n          dataObjDataParam._origin = window.location.origin;\n        }\n      }\n    }\n    this._targetWindow.postMessage({\n      target: this._target,\n      data\n    }, originConstraint);\n  }\n}\n\nexport { BasePostMessageStream, IGNORE_SUBSTREAM, JRPCEngine, ObjectMultiplex, PostMessageStream, SafeEventEmitter, SerializableError, Substream, createAsyncMiddleware, createEngineStream, createErrorMiddleware, createIdRemapMiddleware, createLoggerMiddleware, createScaffoldMiddleware, createStreamMiddleware, getRpcPromiseCallback, mergeMiddleware, setupMultiplex };\n//# sourceMappingURL=openloginJrpc.esm.js.map\n",null,null,null,null,null,null,"exports = module.exports = require('./lib/_stream_readable.js');\nexports.Stream = exports;\nexports.Readable = exports;\nexports.Writable = require('./lib/_stream_writable.js');\nexports.Duplex = require('./lib/_stream_duplex.js');\nexports.Transform = require('./lib/_stream_transform.js');\nexports.PassThrough = require('./lib/_stream_passthrough.js');\nexports.finished = require('./lib/internal/streams/end-of-stream.js');\nexports.pipeline = require('./lib/internal/streams/pipeline.js');\n","'use strict';\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\nfunction _defineProperty(obj, key, value) { key = _toPropertyKey(key); if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); Object.defineProperty(Constructor, \"prototype\", { writable: false }); return Constructor; }\nfunction _toPropertyKey(arg) { var key = _toPrimitive(arg, \"string\"); return typeof key === \"symbol\" ? key : String(key); }\nfunction _toPrimitive(input, hint) { if (typeof input !== \"object\" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || \"default\"); if (typeof res !== \"object\") return res; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (hint === \"string\" ? String : Number)(input); }\nvar _require = require('buffer'),\n  Buffer = _require.Buffer;\nvar _require2 = require('util'),\n  inspect = _require2.inspect;\nvar custom = inspect && inspect.custom || 'inspect';\nfunction copyBuffer(src, target, offset) {\n  Buffer.prototype.copy.call(src, target, offset);\n}\nmodule.exports = /*#__PURE__*/function () {\n  function BufferList() {\n    _classCallCheck(this, BufferList);\n    this.head = null;\n    this.tail = null;\n    this.length = 0;\n  }\n  _createClass(BufferList, [{\n    key: \"push\",\n    value: function push(v) {\n      var entry = {\n        data: v,\n        next: null\n      };\n      if (this.length > 0) this.tail.next = entry;else this.head = entry;\n      this.tail = entry;\n      ++this.length;\n    }\n  }, {\n    key: \"unshift\",\n    value: function unshift(v) {\n      var entry = {\n        data: v,\n        next: this.head\n      };\n      if (this.length === 0) this.tail = entry;\n      this.head = entry;\n      ++this.length;\n    }\n  }, {\n    key: \"shift\",\n    value: function shift() {\n      if (this.length === 0) return;\n      var ret = this.head.data;\n      if (this.length === 1) this.head = this.tail = null;else this.head = this.head.next;\n      --this.length;\n      return ret;\n    }\n  }, {\n    key: \"clear\",\n    value: function clear() {\n      this.head = this.tail = null;\n      this.length = 0;\n    }\n  }, {\n    key: \"join\",\n    value: function join(s) {\n      if (this.length === 0) return '';\n      var p = this.head;\n      var ret = '' + p.data;\n      while (p = p.next) ret += s + p.data;\n      return ret;\n    }\n  }, {\n    key: \"concat\",\n    value: function concat(n) {\n      if (this.length === 0) return Buffer.alloc(0);\n      var ret = Buffer.allocUnsafe(n >>> 0);\n      var p = this.head;\n      var i = 0;\n      while (p) {\n        copyBuffer(p.data, ret, i);\n        i += p.data.length;\n        p = p.next;\n      }\n      return ret;\n    }\n\n    // Consumes a specified amount of bytes or characters from the buffered data.\n  }, {\n    key: \"consume\",\n    value: function consume(n, hasStrings) {\n      var ret;\n      if (n < this.head.data.length) {\n        // `slice` is the same for buffers and strings.\n        ret = this.head.data.slice(0, n);\n        this.head.data = this.head.data.slice(n);\n      } else if (n === this.head.data.length) {\n        // First chunk is a perfect match.\n        ret = this.shift();\n      } else {\n        // Result spans more than one buffer.\n        ret = hasStrings ? this._getString(n) : this._getBuffer(n);\n      }\n      return ret;\n    }\n  }, {\n    key: \"first\",\n    value: function first() {\n      return this.head.data;\n    }\n\n    // Consumes a specified amount of characters from the buffered data.\n  }, {\n    key: \"_getString\",\n    value: function _getString(n) {\n      var p = this.head;\n      var c = 1;\n      var ret = p.data;\n      n -= ret.length;\n      while (p = p.next) {\n        var str = p.data;\n        var nb = n > str.length ? str.length : n;\n        if (nb === str.length) ret += str;else ret += str.slice(0, n);\n        n -= nb;\n        if (n === 0) {\n          if (nb === str.length) {\n            ++c;\n            if (p.next) this.head = p.next;else this.head = this.tail = null;\n          } else {\n            this.head = p;\n            p.data = str.slice(nb);\n          }\n          break;\n        }\n        ++c;\n      }\n      this.length -= c;\n      return ret;\n    }\n\n    // Consumes a specified amount of bytes from the buffered data.\n  }, {\n    key: \"_getBuffer\",\n    value: function _getBuffer(n) {\n      var ret = Buffer.allocUnsafe(n);\n      var p = this.head;\n      var c = 1;\n      p.data.copy(ret);\n      n -= p.data.length;\n      while (p = p.next) {\n        var buf = p.data;\n        var nb = n > buf.length ? buf.length : n;\n        buf.copy(ret, ret.length - n, 0, nb);\n        n -= nb;\n        if (n === 0) {\n          if (nb === buf.length) {\n            ++c;\n            if (p.next) this.head = p.next;else this.head = this.tail = null;\n          } else {\n            this.head = p;\n            p.data = buf.slice(nb);\n          }\n          break;\n        }\n        ++c;\n      }\n      this.length -= c;\n      return ret;\n    }\n\n    // Make sure the linked list only shows the minimal necessary information.\n  }, {\n    key: custom,\n    value: function value(_, options) {\n      return inspect(this, _objectSpread(_objectSpread({}, options), {}, {\n        // Only inspect one level.\n        depth: 0,\n        // It should not recurse.\n        customInspect: false\n      }));\n    }\n  }]);\n  return BufferList;\n}();","'use strict';\n\nvar _Object$setPrototypeO;\nfunction _defineProperty(obj, key, value) { key = _toPropertyKey(key); if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\nfunction _toPropertyKey(arg) { var key = _toPrimitive(arg, \"string\"); return typeof key === \"symbol\" ? key : String(key); }\nfunction _toPrimitive(input, hint) { if (typeof input !== \"object\" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || \"default\"); if (typeof res !== \"object\") return res; throw new TypeError(\"@@toPrimitive must return a primitive value.\"); } return (hint === \"string\" ? String : Number)(input); }\nvar finished = require('./end-of-stream');\nvar kLastResolve = Symbol('lastResolve');\nvar kLastReject = Symbol('lastReject');\nvar kError = Symbol('error');\nvar kEnded = Symbol('ended');\nvar kLastPromise = Symbol('lastPromise');\nvar kHandlePromise = Symbol('handlePromise');\nvar kStream = Symbol('stream');\nfunction createIterResult(value, done) {\n  return {\n    value: value,\n    done: done\n  };\n}\nfunction readAndResolve(iter) {\n  var resolve = iter[kLastResolve];\n  if (resolve !== null) {\n    var data = iter[kStream].read();\n    // we defer if data is null\n    // we can be expecting either 'end' or\n    // 'error'\n    if (data !== null) {\n      iter[kLastPromise] = null;\n      iter[kLastResolve] = null;\n      iter[kLastReject] = null;\n      resolve(createIterResult(data, false));\n    }\n  }\n}\nfunction onReadable(iter) {\n  // we wait for the next tick, because it might\n  // emit an error with process.nextTick\n  process.nextTick(readAndResolve, iter);\n}\nfunction wrapForNext(lastPromise, iter) {\n  return function (resolve, reject) {\n    lastPromise.then(function () {\n      if (iter[kEnded]) {\n        resolve(createIterResult(undefined, true));\n        return;\n      }\n      iter[kHandlePromise](resolve, reject);\n    }, reject);\n  };\n}\nvar AsyncIteratorPrototype = Object.getPrototypeOf(function () {});\nvar ReadableStreamAsyncIteratorPrototype = Object.setPrototypeOf((_Object$setPrototypeO = {\n  get stream() {\n    return this[kStream];\n  },\n  next: function next() {\n    var _this = this;\n    // if we have detected an error in the meanwhile\n    // reject straight away\n    var error = this[kError];\n    if (error !== null) {\n      return Promise.reject(error);\n    }\n    if (this[kEnded]) {\n      return Promise.resolve(createIterResult(undefined, true));\n    }\n    if (this[kStream].destroyed) {\n      // We need to defer via nextTick because if .destroy(err) is\n      // called, the error will be emitted via nextTick, and\n      // we cannot guarantee that there is no error lingering around\n      // waiting to be emitted.\n      return new Promise(function (resolve, reject) {\n        process.nextTick(function () {\n          if (_this[kError]) {\n            reject(_this[kError]);\n          } else {\n            resolve(createIterResult(undefined, true));\n          }\n        });\n      });\n    }\n\n    // if we have multiple next() calls\n    // we will wait for the previous Promise to finish\n    // this logic is optimized to support for await loops,\n    // where next() is only called once at a time\n    var lastPromise = this[kLastPromise];\n    var promise;\n    if (lastPromise) {\n      promise = new Promise(wrapForNext(lastPromise, this));\n    } else {\n      // fast path needed to support multiple this.push()\n      // without triggering the next() queue\n      var data = this[kStream].read();\n      if (data !== null) {\n        return Promise.resolve(createIterResult(data, false));\n      }\n      promise = new Promise(this[kHandlePromise]);\n    }\n    this[kLastPromise] = promise;\n    return promise;\n  }\n}, _defineProperty(_Object$setPrototypeO, Symbol.asyncIterator, function () {\n  return this;\n}), _defineProperty(_Object$setPrototypeO, \"return\", function _return() {\n  var _this2 = this;\n  // destroy(err, cb) is a private API\n  // we can guarantee we have that here, because we control the\n  // Readable class this is attached to\n  return new Promise(function (resolve, reject) {\n    _this2[kStream].destroy(null, function (err) {\n      if (err) {\n        reject(err);\n        return;\n      }\n      resolve(createIterResult(undefined, true));\n    });\n  });\n}), _Object$setPrototypeO), AsyncIteratorPrototype);\nvar createReadableStreamAsyncIterator = function createReadableStreamAsyncIterator(stream) {\n  var _Object$create;\n  var iterator = Object.create(ReadableStreamAsyncIteratorPrototype, (_Object$create = {}, _defineProperty(_Object$create, kStream, {\n    value: stream,\n    writable: true\n  }), _defineProperty(_Object$create, kLastResolve, {\n    value: null,\n    writable: true\n  }), _defineProperty(_Object$create, kLastReject, {\n    value: null,\n    writable: true\n  }), _defineProperty(_Object$create, kError, {\n    value: null,\n    writable: true\n  }), _defineProperty(_Object$create, kEnded, {\n    value: stream._readableState.endEmitted,\n    writable: true\n  }), _defineProperty(_Object$create, kHandlePromise, {\n    value: function value(resolve, reject) {\n      var data = iterator[kStream].read();\n      if (data) {\n        iterator[kLastPromise] = null;\n        iterator[kLastResolve] = null;\n        iterator[kLastReject] = null;\n        resolve(createIterResult(data, false));\n      } else {\n        iterator[kLastResolve] = resolve;\n        iterator[kLastReject] = reject;\n      }\n    },\n    writable: true\n  }), _Object$create));\n  iterator[kLastPromise] = null;\n  finished(stream, function (err) {\n    if (err && err.code !== 'ERR_STREAM_PREMATURE_CLOSE') {\n      var reject = iterator[kLastReject];\n      // reject if we are waiting for data in the Promise\n      // returned by next() and store the error\n      if (reject !== null) {\n        iterator[kLastPromise] = null;\n        iterator[kLastResolve] = null;\n        iterator[kLastReject] = null;\n        reject(err);\n      }\n      iterator[kError] = err;\n      return;\n    }\n    var resolve = iterator[kLastResolve];\n    if (resolve !== null) {\n      iterator[kLastPromise] = null;\n      iterator[kLastResolve] = null;\n      iterator[kLastReject] = null;\n      resolve(createIterResult(undefined, true));\n    }\n    iterator[kEnded] = true;\n  });\n  stream.on('readable', onReadable.bind(null, iterator));\n  return iterator;\n};\nmodule.exports = createReadableStreamAsyncIterator;","module.exports = function () {\n  throw new Error('Readable.from is not available in the browser')\n};\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n// a passthrough stream.\n// basically just the most minimal sort of Transform stream.\n// Every written chunk gets output as-is.\n\n'use strict';\n\nmodule.exports = PassThrough;\nvar Transform = require('./_stream_transform');\nrequire('inherits')(PassThrough, Transform);\nfunction PassThrough(options) {\n  if (!(this instanceof PassThrough)) return new PassThrough(options);\n  Transform.call(this, options);\n}\nPassThrough.prototype._transform = function (chunk, encoding, cb) {\n  cb(null, chunk);\n};","// Ported from https://github.com/mafintosh/pump with\n// permission from the author, Mathias Buus (@mafintosh).\n\n'use strict';\n\nvar eos;\nfunction once(callback) {\n  var called = false;\n  return function () {\n    if (called) return;\n    called = true;\n    callback.apply(void 0, arguments);\n  };\n}\nvar _require$codes = require('../../../errors').codes,\n  ERR_MISSING_ARGS = _require$codes.ERR_MISSING_ARGS,\n  ERR_STREAM_DESTROYED = _require$codes.ERR_STREAM_DESTROYED;\nfunction noop(err) {\n  // Rethrow the error if it exists to avoid swallowing it\n  if (err) throw err;\n}\nfunction isRequest(stream) {\n  return stream.setHeader && typeof stream.abort === 'function';\n}\nfunction destroyer(stream, reading, writing, callback) {\n  callback = once(callback);\n  var closed = false;\n  stream.on('close', function () {\n    closed = true;\n  });\n  if (eos === undefined) eos = require('./end-of-stream');\n  eos(stream, {\n    readable: reading,\n    writable: writing\n  }, function (err) {\n    if (err) return callback(err);\n    closed = true;\n    callback();\n  });\n  var destroyed = false;\n  return function (err) {\n    if (closed) return;\n    if (destroyed) return;\n    destroyed = true;\n\n    // request.destroy just do .end - .abort is what we want\n    if (isRequest(stream)) return stream.abort();\n    if (typeof stream.destroy === 'function') return stream.destroy();\n    callback(err || new ERR_STREAM_DESTROYED('pipe'));\n  };\n}\nfunction call(fn) {\n  fn();\n}\nfunction pipe(from, to) {\n  return from.pipe(to);\n}\nfunction popCallback(streams) {\n  if (!streams.length) return noop;\n  if (typeof streams[streams.length - 1] !== 'function') return noop;\n  return streams.pop();\n}\nfunction pipeline() {\n  for (var _len = arguments.length, streams = new Array(_len), _key = 0; _key < _len; _key++) {\n    streams[_key] = arguments[_key];\n  }\n  var callback = popCallback(streams);\n  if (Array.isArray(streams[0])) streams = streams[0];\n  if (streams.length < 2) {\n    throw new ERR_MISSING_ARGS('streams');\n  }\n  var error;\n  var destroys = streams.map(function (stream, i) {\n    var reading = i < streams.length - 1;\n    var writing = i > 0;\n    return destroyer(stream, reading, writing, function (err) {\n      if (!error) error = err;\n      if (err) destroys.forEach(call);\n      if (reading) return;\n      destroys.forEach(call);\n      callback(error);\n    });\n  });\n  return streams.reduce(pipe);\n}\nmodule.exports = pipeline;","import randombytes from 'randombytes';\nimport _defineProperty from '@babel/runtime/helpers/defineProperty';\nimport base64urlLib from 'base64url';\nimport keccakLib from 'keccak';\n\nconst randomId = () => randombytes(32).toString(\"hex\");\n\nclass URLWithHashParams extends URL {\n  constructor() {\n    super(...arguments);\n    _defineProperty(this, \"hashParams\", new URLSearchParams());\n  }\n  toString() {\n    this.hash = this.hashParams.toString();\n    return super.toString.call(this);\n  }\n}\n\nconst base64url = base64urlLib;\nfunction safebtoa(str) {\n  return base64url.encode(str);\n}\nfunction safeatob(str) {\n  // Going backwards: from bytestream, to percent-encoding, to original string.\n  return base64url.decode(str);\n}\nconst keccak = keccakLib;\nfunction base64toJSON(b64str) {\n  return JSON.parse(base64url.decode(b64str));\n}\nfunction jsonToBase64(json) {\n  return base64url.encode(JSON.stringify(json));\n}\nfunction keccak256(str) {\n  let input = str;\n  if (typeof str === \"string\" && str.slice(0, 2) === \"0x\" && str.length === 66) {\n    input = Buffer.from(str.slice(2), \"hex\");\n  }\n  const data = `0x${keccak(\"keccak256\").update(input).digest(\"hex\").padStart(64, \"0\")}`;\n  return data;\n}\n\nexport { URLWithHashParams, base64toJSON, base64url, jsonToBase64, keccak, keccak256, randomId, safeatob, safebtoa };\n//# sourceMappingURL=openloginUtils.esm.js.map\n",null,"export * from './asStream';\nexport * from './ComposedStore';\nexport * from './MergedStore';\nexport * from './ObservableStore';\nexport * from './transform';\n","import { Duplex as DuplexStream } from 'stream';\n\nimport { ObservableStore } from './ObservableStore';\n\nclass ObservableStoreStream<T> extends DuplexStream {\n  handler: (state: T) => void;\n\n  obsStore: ObservableStore<T>;\n\n  constructor(obsStore: ObservableStore<T>) {\n    super({\n      // pass values, not serializations\n      objectMode: true,\n    });\n    // dont buffer outgoing updates\n    this.resume();\n    // save handler so we can unsubscribe later\n    this.handler = (state: T) => this.push(state);\n    // subscribe to obsStore changes\n    this.obsStore = obsStore;\n    this.obsStore.subscribe(this.handler);\n  }\n\n  // emit current state on new destination\n  pipe<U extends NodeJS.WritableStream>(\n    dest: U,\n    options?: { end?: boolean },\n  ): U {\n    const result = super.pipe(dest, options);\n    dest.write(this.obsStore.getState() as any);\n    return result;\n  }\n\n  // write from incoming stream to state\n  _write(\n    chunk: any,\n    _encoding: string,\n    callback: (error?: Error | null) => void,\n  ): void {\n    this.obsStore.putState(chunk);\n    callback();\n  }\n\n  // noop - outgoing stream is asking us if we have data we arent giving it\n  _read(_size: number): void {\n    return undefined;\n  }\n\n  // unsubscribe from event emitter\n  _destroy(err: Error | null, callback: (error: Error | null) => void): void {\n    this.obsStore.unsubscribe(this.handler);\n    super._destroy(err, callback);\n  }\n}\n\nexport function storeAsStream<T>(\n  obsStore: ObservableStore<T>,\n): ObservableStoreStream<T> {\n  return new ObservableStoreStream(obsStore);\n}\n","import { ObservableStore } from './ObservableStore';\n\nexport class ComposedStore<\n  T extends Record<string, Record<string, unknown>>,\n> extends ObservableStore<T> {\n  private _children: Record<keyof T, ObservableStore<T[keyof T]>>;\n\n  constructor(children: Record<keyof T, ObservableStore<T[keyof T]>>) {\n    // Typecast: Preserve existing behavior\n    super({} as unknown as T);\n\n    // subscribe to children\n    this._children = children || {};\n    Object.keys(this._children).forEach((childKey) => {\n      const child = this._children[childKey];\n      this._addChild(childKey, child);\n    });\n  }\n\n  _addChild(childKey: keyof T, child: ObservableStore<T[keyof T]>) {\n    const updateFromChild = (childValue: T[keyof T]) => {\n      const state = this.getState();\n      state[childKey] = childValue;\n      this.putState(state);\n    };\n\n    child.subscribe(updateFromChild);\n    updateFromChild(child.getState());\n  }\n}\n","import { ObservableStore } from './ObservableStore';\n\nexport class MergedStore<\n  T extends Record<string, unknown>,\n> extends ObservableStore<T> {\n  private _children: ObservableStore<Partial<T>>[];\n\n  constructor(children = []) {\n    // Typecast: Preserve existing behavior\n    super({} as unknown as T);\n\n    this._children = children;\n    // subscribe to children\n    children.forEach((child) => this._addChild(child));\n    this._updateWholeState();\n  }\n\n  _addChild(child: ObservableStore<Partial<T>>): void {\n    child.subscribe(() => this._updateWholeState());\n  }\n\n  _updateWholeState(): void {\n    const childStates = this._children.map((child) => child.getState());\n    // apply shallow merge over states\n    const state = Object.assign({}, ...childStates);\n    this.putState(state);\n  }\n}\n","import { obj as TransformStream } from 'through2';\n\nexport function storeTransformStream<T, U>(syncTransformFn: (state: T) => U) {\n  return TransformStream((state, _encoding, cb) => {\n    try {\n      const newState = syncTransformFn(state);\n      cb(null, newState);\n      return undefined;\n    } catch (err) {\n      cb(err);\n      return undefined;\n    }\n  });\n}\n","var Transform = require('readable-stream').Transform\n  , inherits  = require('util').inherits\n  , xtend     = require('xtend')\n\nfunction DestroyableTransform(opts) {\n  Transform.call(this, opts)\n  this._destroyed = false\n}\n\ninherits(DestroyableTransform, Transform)\n\nDestroyableTransform.prototype.destroy = function(err) {\n  if (this._destroyed) return\n  this._destroyed = true\n  \n  var self = this\n  process.nextTick(function() {\n    if (err)\n      self.emit('error', err)\n    self.emit('close')\n  })\n}\n\n// a noop _transform function\nfunction noop (chunk, enc, callback) {\n  callback(null, chunk)\n}\n\n\n// create a new export function, used by both the main export and\n// the .ctor export, contains common logic for dealing with arguments\nfunction through2 (construct) {\n  return function (options, transform, flush) {\n    if (typeof options == 'function') {\n      flush     = transform\n      transform = options\n      options   = {}\n    }\n\n    if (typeof transform != 'function')\n      transform = noop\n\n    if (typeof flush != 'function')\n      flush = null\n\n    return construct(options, transform, flush)\n  }\n}\n\n\n// main export, just make me a transform stream!\nmodule.exports = through2(function (options, transform, flush) {\n  var t2 = new DestroyableTransform(options)\n\n  t2._transform = transform\n\n  if (flush)\n    t2._flush = flush\n\n  return t2\n})\n\n\n// make me a reusable prototype that I can `new`, or implicitly `new`\n// with a constructor call\nmodule.exports.ctor = through2(function (options, transform, flush) {\n  function Through2 (override) {\n    if (!(this instanceof Through2))\n      return new Through2(override)\n\n    this.options = xtend(options, override)\n\n    DestroyableTransform.call(this, this.options)\n  }\n\n  inherits(Through2, DestroyableTransform)\n\n  Through2.prototype._transform = transform\n\n  if (flush)\n    Through2.prototype._flush = flush\n\n  return Through2\n})\n\n\nmodule.exports.obj = through2(function (options, transform, flush) {\n  var t2 = new DestroyableTransform(xtend({ objectMode: true, highWaterMark: 16 }, options))\n\n  t2._transform = transform\n\n  if (flush)\n    t2._flush = flush\n\n  return t2\n})\n","import _asyncToGenerator from '@babel/runtime/helpers/asyncToGenerator';\nimport _classCallCheck from '@babel/runtime/helpers/classCallCheck';\nimport _createClass from '@babel/runtime/helpers/createClass';\nimport _assertThisInitialized from '@babel/runtime/helpers/assertThisInitialized';\nimport _get from '@babel/runtime/helpers/get';\nimport _inherits from '@babel/runtime/helpers/inherits';\nimport _possibleConstructorReturn from '@babel/runtime/helpers/possibleConstructorReturn';\nimport _getPrototypeOf from '@babel/runtime/helpers/getPrototypeOf';\nimport _defineProperty from '@babel/runtime/helpers/defineProperty';\nimport _regeneratorRuntime from '@babel/runtime/regenerator';\nimport Torus from '@toruslabs/torus-embed';\nimport { WALLET_ADAPTERS, ADAPTER_NAMESPACES, CHAIN_NAMESPACES, ADAPTER_CATEGORY, ADAPTER_STATUS, log, ADAPTER_EVENTS, getChainConfig, Web3AuthError, WalletLoginError, WalletInitializationError } from '@web3auth/base';\nimport { BaseEvmAdapter } from '@web3auth/base-evm-adapter';\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\nvar TorusWalletAdapter = /*#__PURE__*/function (_BaseEvmAdapter) {\n  _inherits(TorusWalletAdapter, _BaseEvmAdapter);\n\n  var _super = _createSuper(TorusWalletAdapter);\n\n  function TorusWalletAdapter(params) {\n    var _this;\n\n    _classCallCheck(this, TorusWalletAdapter);\n\n    _this = _super.call(this, params);\n\n    _defineProperty(_assertThisInitialized(_this), \"name\", WALLET_ADAPTERS.TORUS_EVM);\n\n    _defineProperty(_assertThisInitialized(_this), \"adapterNamespace\", ADAPTER_NAMESPACES.EIP155);\n\n    _defineProperty(_assertThisInitialized(_this), \"currentChainNamespace\", CHAIN_NAMESPACES.EIP155);\n\n    _defineProperty(_assertThisInitialized(_this), \"type\", ADAPTER_CATEGORY.EXTERNAL);\n\n    _defineProperty(_assertThisInitialized(_this), \"status\", ADAPTER_STATUS.NOT_READY);\n\n    _defineProperty(_assertThisInitialized(_this), \"torusInstance\", null);\n\n    _defineProperty(_assertThisInitialized(_this), \"torusWalletOptions\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"initParams\", void 0);\n\n    _defineProperty(_assertThisInitialized(_this), \"loginSettings\", {});\n\n    _defineProperty(_assertThisInitialized(_this), \"rehydrated\", false);\n\n    _this.torusWalletOptions = params.adapterSettings || {};\n    _this.initParams = params.initParams || {};\n    _this.loginSettings = params.loginSettings || {};\n    _this.chainConfig = params.chainConfig || null;\n    _this.sessionTime = params.sessionTime || 86400;\n    return _this;\n  }\n\n  _createClass(TorusWalletAdapter, [{\n    key: \"provider\",\n    get: function get() {\n      if (this.status === ADAPTER_STATUS.CONNECTED && this.torusInstance) {\n        return this.torusInstance.provider;\n      }\n\n      return null;\n    },\n    set: function set(_) {\n      throw new Error(\"Not implemented\");\n    }\n  }, {\n    key: \"init\",\n    value: function () {\n      var _init = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(options) {\n        var network, _this$chainConfig, blockExplorer, displayName, chainId, ticker, tickerName, _this$chainConfig2, _chainId2, _blockExplorer, _displayName, rpcTarget, _ticker, _tickerName;\n\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _get(_getPrototypeOf(TorusWalletAdapter.prototype), \"checkInitializationRequirements\", this).call(this); // set chainConfig for mainnet by default if not set\n\n\n                if (!this.chainConfig) {\n                  this.chainConfig = getChainConfig(CHAIN_NAMESPACES.EIP155, 1);\n                  _this$chainConfig = this.chainConfig, blockExplorer = _this$chainConfig.blockExplorer, displayName = _this$chainConfig.displayName, chainId = _this$chainConfig.chainId, ticker = _this$chainConfig.ticker, tickerName = _this$chainConfig.tickerName;\n                  network = {\n                    chainId: Number.parseInt(chainId, 16),\n                    host: \"mainnet\",\n                    blockExplorer: blockExplorer,\n                    networkName: displayName,\n                    ticker: ticker,\n                    tickerName: tickerName\n                  };\n                } else {\n                  _this$chainConfig2 = this.chainConfig, _chainId2 = _this$chainConfig2.chainId, _blockExplorer = _this$chainConfig2.blockExplorer, _displayName = _this$chainConfig2.displayName, rpcTarget = _this$chainConfig2.rpcTarget, _ticker = _this$chainConfig2.ticker, _tickerName = _this$chainConfig2.tickerName;\n                  network = {\n                    chainId: Number.parseInt(_chainId2, 16),\n                    host: rpcTarget,\n                    blockExplorer: _blockExplorer,\n                    networkName: _displayName,\n                    ticker: _ticker,\n                    tickerName: _tickerName\n                  };\n                }\n\n                this.torusInstance = new Torus(this.torusWalletOptions);\n                log.debug(\"initializing torus evm adapter init\");\n                _context.next = 6;\n                return this.torusInstance.init(_objectSpread(_objectSpread({\n                  showTorusButton: false\n                }, this.initParams), {}, {\n                  network: network\n                }));\n\n              case 6:\n                this.status = ADAPTER_STATUS.READY;\n                this.emit(ADAPTER_EVENTS.READY, WALLET_ADAPTERS.TORUS_EVM);\n                _context.prev = 8;\n                log.debug(\"initializing torus evm adapter\");\n\n                if (!options.autoConnect) {\n                  _context.next = 14;\n                  break;\n                }\n\n                this.rehydrated = true;\n                _context.next = 14;\n                return this.connect();\n\n              case 14:\n                _context.next = 20;\n                break;\n\n              case 16:\n                _context.prev = 16;\n                _context.t0 = _context[\"catch\"](8);\n                log.error(\"Failed to connect with torus evm provider\", _context.t0);\n                this.emit(ADAPTER_EVENTS.ERRORED, _context.t0);\n\n              case 20:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this, [[8, 16]]);\n      }));\n\n      function init(_x) {\n        return _init.apply(this, arguments);\n      }\n\n      return init;\n    }()\n  }, {\n    key: \"connect\",\n    value: function () {\n      var _connect = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n        var chainId, _this$chainConfig3, _chainId, blockExplorer, displayName, rpcTarget, ticker, tickerName, network, updatedChainID;\n\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _get(_getPrototypeOf(TorusWalletAdapter.prototype), \"checkConnectionRequirements\", this).call(this);\n\n                if (this.torusInstance) {\n                  _context2.next = 3;\n                  break;\n                }\n\n                throw WalletInitializationError.notReady(\"Torus wallet is not initialized\");\n\n              case 3:\n                this.status = ADAPTER_STATUS.CONNECTING;\n                this.emit(ADAPTER_EVENTS.CONNECTING, {\n                  adapter: WALLET_ADAPTERS.TORUS_EVM\n                });\n                _context2.prev = 5;\n                _context2.next = 8;\n                return this.torusInstance.login(this.loginSettings);\n\n              case 8:\n                chainId = this.torusInstance.provider.chainId;\n\n                if (!(chainId && parseInt(chainId) !== parseInt(this.chainConfig.chainId, 16))) {\n                  _context2.next = 19;\n                  break;\n                }\n\n                _this$chainConfig3 = this.chainConfig, _chainId = _this$chainConfig3.chainId, blockExplorer = _this$chainConfig3.blockExplorer, displayName = _this$chainConfig3.displayName, rpcTarget = _this$chainConfig3.rpcTarget, ticker = _this$chainConfig3.ticker, tickerName = _this$chainConfig3.tickerName;\n                network = {\n                  chainId: Number.parseInt(_chainId, 16),\n                  host: rpcTarget,\n                  blockExplorer: blockExplorer,\n                  networkName: displayName,\n                  tickerName: tickerName,\n                  ticker: ticker\n                }; // in some cases when user manually switches chain and relogin then adapter will not connect to initially passed\n                // chainConfig but will connect to the one that user switched to.\n                // So here trying to switch network to the one that was initially passed in chainConfig.\n\n                _context2.next = 14;\n                return this.torusInstance.setProvider(_objectSpread({}, network));\n\n              case 14:\n                _context2.next = 16;\n                return this.torusInstance.ethereum.request({\n                  method: \"eth_chainId\"\n                });\n\n              case 16:\n                updatedChainID = _context2.sent;\n\n                if (!(updatedChainID && parseInt(updatedChainID) !== parseInt(this.chainConfig.chainId, 16))) {\n                  _context2.next = 19;\n                  break;\n                }\n\n                throw WalletInitializationError.fromCode(5000, \"Not connected to correct chainId. Expected: \".concat(this.chainConfig.chainId, \", Current: \").concat(updatedChainID));\n\n              case 19:\n                this.status = ADAPTER_STATUS.CONNECTED;\n                this.torusInstance.showTorusButton();\n                this.emit(ADAPTER_STATUS.CONNECTED, {\n                  adapter: WALLET_ADAPTERS.TORUS_EVM,\n                  reconnected: this.rehydrated\n                });\n                return _context2.abrupt(\"return\", this.provider);\n\n              case 25:\n                _context2.prev = 25;\n                _context2.t0 = _context2[\"catch\"](5);\n                // ready again to be connected\n                this.status = ADAPTER_STATUS.READY;\n                this.rehydrated = false;\n                this.emit(ADAPTER_STATUS.ERRORED, _context2.t0);\n                throw _context2.t0 instanceof Web3AuthError ? _context2.t0 : WalletLoginError.connectionError(\"Failed to login with torus wallet\");\n\n              case 31:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this, [[5, 25]]);\n      }));\n\n      function connect() {\n        return _connect.apply(this, arguments);\n      }\n\n      return connect;\n    }()\n  }, {\n    key: \"disconnect\",\n    value: function () {\n      var _disconnect = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n        var options,\n            _args3 = arguments;\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                options = _args3.length > 0 && _args3[0] !== undefined ? _args3[0] : {\n                  cleanup: false\n                };\n\n                if (this.torusInstance) {\n                  _context3.next = 3;\n                  break;\n                }\n\n                throw WalletInitializationError.notReady(\"Torus wallet is not initialized\");\n\n              case 3:\n                _context3.next = 5;\n                return _get(_getPrototypeOf(TorusWalletAdapter.prototype), \"disconnect\", this).call(this);\n\n              case 5:\n                _context3.next = 7;\n                return this.torusInstance.logout();\n\n              case 7:\n                this.torusInstance.hideTorusButton();\n\n                if (options.cleanup) {\n                  this.status = ADAPTER_STATUS.NOT_READY;\n                  this.torusInstance = null;\n                } else {\n                  // ready to be connected again\n                  this.status = ADAPTER_STATUS.READY;\n                }\n\n                this.rehydrated = false;\n                this.emit(ADAPTER_EVENTS.DISCONNECTED);\n\n              case 11:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      function disconnect() {\n        return _disconnect.apply(this, arguments);\n      }\n\n      return disconnect;\n    }()\n  }, {\n    key: \"getUserInfo\",\n    value: function () {\n      var _getUserInfo = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4() {\n        var userInfo;\n        return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                if (!(this.status !== ADAPTER_STATUS.CONNECTED)) {\n                  _context4.next = 2;\n                  break;\n                }\n\n                throw WalletLoginError.notConnectedError(\"Not connected with wallet\");\n\n              case 2:\n                if (this.torusInstance) {\n                  _context4.next = 4;\n                  break;\n                }\n\n                throw WalletInitializationError.notReady(\"Torus wallet is not initialized\");\n\n              case 4:\n                _context4.next = 6;\n                return this.torusInstance.getUserInfo(\"\");\n\n              case 6:\n                userInfo = _context4.sent;\n                return _context4.abrupt(\"return\", userInfo);\n\n              case 8:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this);\n      }));\n\n      function getUserInfo() {\n        return _getUserInfo.apply(this, arguments);\n      }\n\n      return getUserInfo;\n    }()\n  }, {\n    key: \"setAdapterSettings\",\n    value: function setAdapterSettings(options) {\n      if (this.status === ADAPTER_STATUS.READY) return;\n\n      if (options !== null && options !== void 0 && options.sessionTime) {\n        this.sessionTime = options.sessionTime;\n      }\n\n      if (options !== null && options !== void 0 && options.clientId) {\n        this.clientId = options.clientId;\n      }\n    }\n  }]);\n\n  return TorusWalletAdapter;\n}(BaseEvmAdapter);\n\nexport { TorusWalletAdapter };\n//# sourceMappingURL=torusEvmAdapter.esm.js.map\n"],"sourceRoot":""}